Translate Text Between Languages with Seed-X-PPO Model on Replicate

https://n8nworkflows.xyz/workflows/translate-text-between-languages-with-seed-x-ppo-model-on-replicate-6940


# Translate Text Between Languages with Seed-X-PPO Model on Replicate

### 1. Workflow Overview

This workflow automates text translation between languages using the **lucataco/seed-x-ppo** model hosted on Replicate. It is designed for users who want to input a text and target language, then receive the translated output generated by a state-of-the-art AI model.

The workflow is logically divided into the following blocks:

- **1.1 Input Trigger and API Key Setup**: Starts the workflow manually and sets the Replicate API key.
- **1.2 Prediction Creation**: Sends a request to Replicate to create a translation prediction job.
- **1.3 Prediction Monitoring Loop**: Polls Replicate to check the status of the translation job until completion.
- **1.4 Result Processing**: Processes and formats the final translated text output.

---

### 2. Block-by-Block Analysis

#### 2.1 Input Trigger and API Key Setup

**Overview:**  
This block initiates the workflow manually and sets up the required API key to authenticate requests to Replicate.

**Nodes Involved:**  
- On clicking 'execute'  
- Set API Key

**Node Details:**

- **On clicking 'execute'**  
  - Type: Manual Trigger  
  - Role: Starts workflow execution manually on user command.  
  - Configuration: No parameters; simply listens for manual trigger.  
  - Input: None  
  - Output: Triggers "Set API Key" node  
  - Failure Cases: None (manual invocation)

- **Set API Key**  
  - Type: Set Node  
  - Role: Stores the Replicate API key as a workflow variable for reuse.  
  - Configuration: Assigns a string variable `replicate_api_key` with the value `"YOUR_REPLICATE_API_KEY"` (placeholder to be replaced).  
  - Input: Trigger from manual start  
  - Output: Provides API key data to "Create Prediction" node  
  - Failure Cases: Missing or invalid API key will cause authentication errors downstream.

---

#### 2.2 Prediction Creation

**Overview:**  
This block sends an authenticated HTTP POST request to Replicate’s API to create a new prediction job using the Seed X PPO model, passing the input text and target language.

**Nodes Involved:**  
- Create Prediction  
- Extract Prediction ID

**Node Details:**

- **Create Prediction**  
  - Type: HTTP Request  
  - Role: Sends POST request to `https://api.replicate.com/v1/predictions` to start translation.  
  - Configuration:  
    - HTTP Method: POST  
    - Timeout: 60 seconds  
    - JSON Body includes:  
      - `version`: fixed model version string  
      - `input`: JSON object with fields:  
        - `text`: placeholder `"text value"` (user must replace with actual text)  
        - `target_language`: placeholder `"target_language value"` (user must replace)  
        - `num_beams`: 4 (controls beam search for quality)  
        - `max_length`: 512 (max token length)  
    - Authentication: HTTP Header with `Authorization: Bearer <replicate_api_key>`  
    - Headers: Content-Type: application/json  
  - Input: API key from "Set API Key"  
  - Output: JSON response containing prediction ID and status to "Extract Prediction ID"  
  - Failure Cases:  
    - Authentication errors if API key invalid or missing  
    - Timeout if API slow to respond  
    - Input validation errors if required fields missing or malformed

- **Extract Prediction ID**  
  - Type: Code (JavaScript)  
  - Role: Extracts `predictionId`, initial `status`, and constructs a polling URL from the API response.  
  - Configuration:  
    - Runs once per item  
    - Extracts from input JSON:  
      - `id` → predictionId  
      - `status` → initialStatus  
    - Constructs `predictionUrl` for polling: `https://api.replicate.com/v1/predictions/${predictionId}`  
  - Input: JSON response from "Create Prediction"  
  - Output: Object with `predictionId`, `status`, and `predictionUrl` to "Wait" node  
  - Failure Cases:  
    - Missing or malformed response could cause runtime errors  
    - Defensive coding recommended to verify presence of fields

---

#### 2.3 Prediction Monitoring Loop

**Overview:**  
This block implements a polling loop to check the prediction job status every 2 seconds until the translation completes successfully.

**Nodes Involved:**  
- Wait  
- Check Prediction Status  
- Check If Complete

**Node Details:**

- **Wait**  
  - Type: Wait Node  
  - Role: Pauses workflow for 2 seconds between polling attempts.  
  - Configuration: 2 seconds delay  
  - Input: After extracting prediction info or after incomplete status check  
  - Output: Triggers "Check Prediction Status"  
  - Failure Cases: None expected unless workflow is interrupted

- **Check Prediction Status**  
  - Type: HTTP Request  
  - Role: Sends GET request to the prediction URL to retrieve the current status.  
  - Configuration:  
    - URL: dynamic from `predictionUrl` variable  
    - Headers: Authorization with Bearer token from API key  
  - Input: From "Wait" node or initial status extraction  
  - Output: Current prediction status JSON to "Check If Complete"  
  - Failure Cases:  
    - Network errors or API downtime  
    - Authorization errors if token expired  
    - Unexpected JSON fields missing

- **Check If Complete**  
  - Type: If Node  
  - Role: Evaluates if the prediction status equals `"succeeded"`.  
  - Configuration: Boolean condition test `$json.status === "succeeded"`  
  - Input: Output from "Check Prediction Status"  
  - Output:  
    - True branch: "Process Result" node  
    - False branch: loops back to "Wait" node for another poll  
  - Failure Cases: Status other than expected values may cause indefinite looping or premature exit if not handled

---

#### 2.4 Result Processing

**Overview:**  
Once the prediction is complete, this block processes the output JSON to extract relevant result data and formats it for downstream use.

**Nodes Involved:**  
- Process Result

**Node Details:**

- **Process Result**  
  - Type: Code (JavaScript)  
  - Role: Extracts prediction output, metadata, and formats a structured result object.  
  - Configuration:  
    - Extracts from input JSON:  
      - `status`  
      - `output` (translated text or URL)  
      - `metrics` (performance metrics returned by model)  
      - `created_at` and `completed_at` timestamps  
    - Adds static `model` name `"lucataco/seed-x-ppo"`  
    - Exposes `text_url` as the output link  
  - Input: Completed prediction JSON from "Check If Complete" true branch  
  - Output: Processed result object for further use or export  
  - Failure Cases: Unexpected or missing fields from API response may cause errors

---

### 3. Summary Table

| Node Name               | Node Type           | Functional Role                            | Input Node(s)            | Output Node(s)           | Sticky Note                                                                                                                      |
|-------------------------|---------------------|------------------------------------------|--------------------------|--------------------------|---------------------------------------------------------------------------------------------------------------------------------|
| On clicking 'execute'    | Manual Trigger      | Starts workflow execution manually       | None                     | Set API Key              |                                                                                                                                 |
| Set API Key             | Set Node            | Stores Replicate API key                  | On clicking 'execute'    | Create Prediction        |                                                                                                                                 |
| Create Prediction       | HTTP Request        | Sends prediction creation request to Replicate | Set API Key              | Extract Prediction ID    |                                                                                                                                 |
| Extract Prediction ID   | Code                | Extracts prediction ID and polling URL   | Create Prediction        | Wait                     |                                                                                                                                 |
| Wait                    | Wait Node           | Pauses workflow for 2 seconds             | Extract Prediction ID, Check If Complete (false branch) | Check Prediction Status |                                                                                                                                 |
| Check Prediction Status | HTTP Request        | Polls Replicate API for prediction status | Wait                     | Check If Complete        |                                                                                                                                 |
| Check If Complete       | If Node             | Checks if prediction status is 'succeeded' | Check Prediction Status  | Process Result (true), Wait (false) |                                                                                                                                 |
| Process Result          | Code                | Processes and formats the prediction output | Check If Complete (true) | None                     |                                                                                                                                 |
| Sticky Note             | Sticky Note         | Workflow description and setup instructions | None                     | None                     | ## Lucataco Seed X Ppo Text Generator  This workflow uses the **lucataco/seed-x-ppo** model from Replicate to generate text content.  Setup: 1. Add your Replicate API key 2. Configure the input parameters 3. Run the workflow  Model Details: - **Type**: Text Generation - **Provider**: lucataco - **Required Fields**: text, target_language |

---

### 4. Reproducing the Workflow from Scratch

1. **Create Manual Trigger Node:**  
   - Add a Manual Trigger node named `"On clicking 'execute'"`. No configuration needed.

2. **Create Set Node for API Key:**  
   - Add a Set node named `"Set API Key"`.  
   - Add a string variable named `replicate_api_key`.  
   - Set its value to your actual Replicate API key (replace `"YOUR_REPLICATE_API_KEY"`).  
   - Connect `"On clicking 'execute'"` output to this node.

3. **Create HTTP Request Node to Create Prediction:**  
   - Add HTTP Request node named `"Create Prediction"`.  
   - Method: POST  
   - URL: `https://api.replicate.com/v1/predictions`  
   - Timeout: 60,000 ms (60 seconds)  
   - Authentication: Set to Generic Credential with HTTP Header Auth.  
   - Headers:  
     - `Authorization`: `Bearer {{$node["Set API Key"].json["replicate_api_key"]}}`  
     - `Content-Type`: `application/json`  
   - Body Type: JSON  
   - JSON Body:  
     ```json
     {
       "version": "bd6fdc731bd97a7dc3ea84285479567a3d40165d851bc7251122defd30372e8c",
       "input": {
         "text": "text value",
         "target_language": "target_language value",
         "num_beams": 4,
         "max_length": 512
       }
     }
     ```  
   - Replace `"text value"` and `"target_language value"` with actual inputs or expressions as needed.  
   - Connect `"Set API Key"` to this node.

4. **Create Code Node to Extract Prediction ID:**  
   - Add a Code node named `"Extract Prediction ID"`.  
   - Language: JavaScript  
   - Code:
     ```javascript
     const prediction = $input.item.json;
     const predictionId = prediction.id;
     const initialStatus = prediction.status;

     return {
       predictionId: predictionId,
       status: initialStatus,
       predictionUrl: `https://api.replicate.com/v1/predictions/${predictionId}`
     };
     ```  
   - Connect `"Create Prediction"` to this node.

5. **Create Wait Node:**  
   - Add a Wait node named `"Wait"`.  
   - Set to wait 2 seconds.  
   - Connect `"Extract Prediction ID"` to this node.

6. **Create HTTP Request Node to Check Prediction Status:**  
   - Add HTTP Request node named `"Check Prediction Status"`.  
   - Method: GET (default)  
   - URL: `{{$json["predictionUrl"]}}` (dynamic from previous node output)  
   - Authentication: Generic Credential HTTP Header Auth with header:  
     - `Authorization`: `Bearer {{$node["Set API Key"].json["replicate_api_key"]}}`  
   - Connect `"Wait"` output to this node.

7. **Create If Node to Check Completion:**  
   - Add If node named `"Check If Complete"`.  
   - Condition: Boolean  
   - Expression: `{{$json["status"]}}` equals `"succeeded"`  
   - Connect `"Check Prediction Status"` output to this node.

8. **Create Code Node to Process Result:**  
   - Add Code node named `"Process Result"`.  
   - Language: JavaScript  
   - Code:
     ```javascript
     const result = $input.item.json;

     return {
       status: result.status,
       output: result.output,
       metrics: result.metrics,
       created_at: result.created_at,
       completed_at: result.completed_at,
       model: 'lucataco/seed-x-ppo',
       text_url: result.output
     };
     ```  
   - Connect the **true** branch of `"Check If Complete"` to this node.

9. **Looping Back for Polling:**  
   - Connect the **false** branch of `"Check If Complete"` back to the `"Wait"` node to continue polling.

10. **Additional Setup:**  
    - Replace placeholder values `text value` and `target_language value` in `"Create Prediction"` node with actual input data or expressions referencing other nodes or parameters as needed.  
    - Ensure the "Set API Key" node contains a valid API key with proper permissions for Replicate API.  
    - Optionally, add error handling or timeout limits on polling to avoid infinite loops.

---

### 5. General Notes & Resources

| Note Content                                                                                                                  | Context or Link                                                                                  |
|-------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------|
| This workflow uses the **lucataco/seed-x-ppo** model on Replicate, designed for text generation and translation tasks.          | Model details: https://replicate.com/lucataco/seed-x-ppo                                        |
| To run, you must obtain a Replicate API key and replace the placeholder in the Set node.                                       | https://replicate.com/docs/api-reference                                                        |
| Parameters such as `num_beams` and `max_length` control translation quality and output length; adjust as needed for your use case.|                                                                                               |
| Polling every 2 seconds is a balance between promptness and API rate limits; adjust wait time to prevent rate limiting issues. |                                                                                               |
| The workflow currently requires manual trigger; it can be adapted to receive external inputs via webhook or other triggers.   |                                                                                               |

---

_Disclaimer: The provided content originates solely from an n8n automated workflow. It complies fully with content policies and contains no illegal or protected data._