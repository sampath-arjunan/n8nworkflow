Calendly to KlickTipp Integration

https://n8nworkflows.xyz/workflows/calendly-to-klicktipp-integration-2620


# Calendly to KlickTipp Integration

### 1. Workflow Overview

This workflow automates the integration between Calendly and KlickTipp specifically for self-hosted n8n environments. It listens to Calendly booking and cancellation events, processes and transforms event and invitee data, and synchronizes subscriber records in KlickTipp accordingly. The main use case is to keep KlickTipp subscriber lists up-to-date based on Calendly scheduling activity, including handling guests, cancellations, and rescheduling events.

The workflow is logically divided into the following blocks:

- **1.1 Calendly Event Reception:** Triggered when an invitee books or cancels an event in Calendly.
- **1.2 Data Transformation:** Converts Calendly timestamps and invitee details into formats compatible with KlickTipp.
- **1.3 Booking or Cancellation Decision:** Determines if the event is a booking or cancellation.
- **1.4 Invitee Subscription Management:** Adds or removes the main invitee in KlickTipp depending on booking or cancellation.
- **1.5 Guest Subscription Management:** Processes associated guests individually for bookings and cancellations.
- **1.6 Rescheduling Handling:** Distinguishes rescheduling cancellations to avoid overwriting guest data incorrectly.
- **1.7 Error Prevention / Default Handling:** Ensures data integrity when guests are absent or guest address fields are empty.

---

### 2. Block-by-Block Analysis

#### 2.1 Calendly Event Reception

**Overview:**  
This block listens for new invitee events from Calendly, triggering the workflow on bookings and cancellations.

**Nodes Involved:**  
- New Calendly event

**Node Details:**

- **New Calendly event**  
  - Type: Calendly Trigger  
  - Role: Listens for Calendly webhook events `"invitee.created"` and `"invitee.canceled"`.  
  - Configuration: Uses Calendly API credentials; webhook ID generated by n8n.  
  - Inputs: None (trigger node).  
  - Outputs: Emits event payload containing invitee and scheduled event data.  
  - Potential Failures: Webhook connectivity issues, invalid credentials, Calendly API downtime.  
  - Notes: Only compatible with self-hosted n8n due to community node dependency.

---

#### 2.2 Data Transformation

**Overview:**  
Formats Calendly event timestamps and invitee data into KlickTipp-compatible formats (UNIX timestamps, seconds since midnight). Also extracts and standardizes names, phone numbers, and guest emails.

**Nodes Involved:**  
- Convert data for KlickTipp

**Node Details:**

- **Convert data for KlickTipp**  
  - Type: Set node  
  - Role: Creates new fields with transformed data for KlickTipp, including:  
    - `event_start_date_time` and `event_end_date_time` as UNIX timestamps (seconds)  
    - `invitee_start_date`, `invitee_end_date` as UNIX timestamps adjusted to invitee timezone  
    - `invitee_start_time_seconds`, `invitee_end_time_seconds` as seconds since midnight  
    - `invitee_first_name` and `invitee_last_name` extracted from provided names or split from full name  
    - `invitee_mobile` standardized by replacing `+` with `00` and removing spaces  
    - `guest_addresses` extracted as a list of guest emails  
  - Inputs: Output of "New Calendly event" node.  
  - Outputs: Modified JSON with additional standardized fields for downstream KlickTipp nodes.  
  - Expressions use JavaScript date manipulation and string handling.  
  - Edge Cases: Missing name fields, missing phone number, empty guest list, timezone inconsistencies.

---

#### 2.3 Booking or Cancellation Decision

**Overview:**  
Determines if the incoming Calendly event is an active booking or a cancellation to route processing appropriately.

**Nodes Involved:**  
- Check event - booking or cancellation?

**Node Details:**

- **Check event - booking or cancellation?**  
  - Type: If node  
  - Role: Checks if scheduled event status equals `"active"` (booking) or not (cancellation).  
  - Input: Data from "Convert data for KlickTipp".  
  - Outputs: Two branches:  
    - `true` for bookings  
    - `false` for cancellations  
  - Failure Points: Unexpected or missing status fields, malformed data.

---

#### 2.4 Invitee Subscription Management

**Overview:**  
Manages subscription of the main invitee in KlickTipp for both bookings and cancellations.

**Nodes Involved:**  
- Subscribe invitee booking in KlickTipp  
- Subscribe invitee cancellation in KlickTipp

**Node Details:**

- **Subscribe invitee booking in KlickTipp**  
  - Type: KlickTipp community node  
  - Role: Subscribes or updates the invitee in KlickTipp with booking tag and custom fields.  
  - Fields mapped include first/last name, event details (name, join URL, reschedule/cancel URLs), event start/end times, invitee times, timezone, guest addresses, and mobile phone.  
  - Uses KlickTipp credentials.  
  - Input: Booking branch from "Check event - booking or cancellation?".  
  - Output: Passes to guest booking check.  
  - Edge Cases: Authentication failure, API errors, empty or invalid email.

- **Subscribe invitee cancellation in KlickTipp**  
  - Type: KlickTipp community node  
  - Role: Marks invitee as cancelled in KlickTipp by applying a cancellation tag.  
  - Input: Cancellation branch from "Check event - booking or cancellation?".  
  - Output: Passes to guest cancellation check.  
  - Edge Cases: Same as booking node plus handling missing invitee data.

---

#### 2.5 Guest Subscription Management

**Overview:**  
Processes guests associated with the invitee, subscribing or unsubscribing them individually depending on the event.

**Nodes Involved:**  
- Guests booking check  
- List guests for booking  
- Split Out guest bookings  
- Subscribe guest booking in KlickTipp  
- Guests cancellation check  
- List guests for cancellation  
- Split Out guest cancellations  
- Subscribe guest cancellation in KlickTipp  

**Node Details:**

- **Guests booking check**  
  - Type: If node  
  - Role: Checks if the booking includes guests by verifying if `event_guests` array is not empty in Calendly payload.  
  - Output `true`: Passes guests to be listed and split.  
  - Output `false`: Passes to no-op node indicating no guests were added.

- **List guests for booking**  
  - Type: Set node  
  - Role: Extracts guest emails into an array of objects with `{ email }` keys for KlickTipp.  
  - Output: Sends to "Split Out guest bookings".

- **Split Out guest bookings**  
  - Type: Split Out node  
  - Role: Splits the array of guests into individual items for sequential processing.  
  - Output: Each guest processed individually.

- **Subscribe guest booking in KlickTipp**  
  - Type: KlickTipp community node  
  - Role: Subscribes each guest as a subscriber in KlickTipp with booking tag and event details.  
  - Input: From "Split Out guest bookings".  
  - Edge Cases: Invalid guest emails, API or auth failures.

- **Guests cancellation check**  
  - Type: If node  
  - Role: Checks if guest email addresses exist in the invitee record (`field214142`) to process cancellations.  
  - Output `true`: Passes to guest cancellation processing.  
  - Output `false`: Passes to a no-op node indicating no guest cancellations.

- **List guests for cancellation**  
  - Type: Set node  
  - Role: Parses stored guest email addresses from invitee record (JSON string) into an array.  
  - Output: Passes to "Split Out guest cancellations".

- **Split Out guest cancellations**  
  - Type: Split Out node  
  - Role: Splits guests into individual cancellation items.

- **Subscribe guest cancellation in KlickTipp**  
  - Type: KlickTipp community node  
  - Role: Subscribes guests with cancellation tag to reflect removal in KlickTipp.  
  - Input: From "Split Out guest cancellations".  
  - Edge Cases: Handling missing guest emails, API issues.

---

#### 2.6 Rescheduling Handling

**Overview:**  
Checks if a cancellation event is due to rescheduling to prevent overwriting guest email fields incorrectly.

**Nodes Involved:**  
- Rescheduling check  
- Event was rescheduled (NoOp)  
- Subscribe invitee to empty guest addresses field

**Node Details:**

- **Rescheduling check**  
  - Type: If node  
  - Role: Tests if the event was rescheduled (`payload.rescheduled == true`).  
  - Output `true`: Routes to "Event was rescheduled" (NoOp), skipping guest address clearing.  
  - Output `false`: Routes to "Subscribe invitee to empty guest addresses field" to clear guest email addresses field.

- **Event was rescheduled**  
  - Type: NoOp  
  - Role: Placeholder node indicating no action needed for rescheduled events.

- **Subscribe invitee to empty guest addresses field**  
  - Type: KlickTipp community node  
  - Role: Writes `null` to the guest email addresses field in the invitee record to prevent errors on rebooking.  
  - Input: From rescheduling check (false branch).  
  - Edge Cases: API failures, auth issues.

---

#### 2.7 Error Prevention / Default Handling

**Overview:**  
Handles scenarios where no guests are added or no guest email addresses are found during cancellations to avoid unnecessary processing.

**Nodes Involved:**  
- Invitee did not add guests to the booking (NoOp)  
- No guest email addresses found (NoOp)  

**Node Details:**

- **Invitee did not add guests to the booking**  
  - Type: NoOp  
  - Role: Represents the path where no guests are associated with the booking; no guest processing needed.

- **No guest email addresses found**  
  - Type: NoOp  
  - Role: Represents the path where no guest email addresses exist in the invitee record during cancellation; no guest cancellation processing needed.

---

### 3. Summary Table

| Node Name                             | Node Type                     | Functional Role                                               | Input Node(s)                  | Output Node(s)                              | Sticky Note                                                                                                   |
|-------------------------------------|-------------------------------|---------------------------------------------------------------|--------------------------------|---------------------------------------------|---------------------------------------------------------------------------------------------------------------|
| New Calendly event                   | Calendly Trigger              | Trigger workflow on Calendly bookings/cancellations          | -                              | Convert data for KlickTipp                   | This node triggers the workflow whenever an event is booked or canceled in Calendly.                          |
| Convert data for KlickTipp           | Set                          | Convert and format Calendly data for KlickTipp                | New Calendly event             | Check event - booking or cancellation?       | Formats timestamps and extracts standardized invitee and guest data for KlickTipp.                            |
| Check event - booking or cancellation? | If                           | Determines if event is booking (active) or cancellation       | Convert data for KlickTipp     | Subscribe invitee booking/cancellation nodes | Validates if an event booking or cancellation is being processed.                                            |
| Subscribe invitee booking in KlickTipp | KlickTipp                    | Adds/upserts the main invitee to KlickTipp subscriber list    | Check event (true branch)      | Guests booking check                         | Adds the invitee to KlickTipp with booking details and guest email list for tracking cancellations.          |
| Guests booking check                  | If                           | Checks presence of guests in booking                          | Subscribe invitee booking      | List guests for booking / No guests (NoOp) | Validates if there are guests to process separately.                                                         |
| List guests for booking              | Set                          | Extracts guest emails into array for KlickTipp                | Guests booking check (true)    | Split Out guest bookings                      | Prepares guest data for KlickTipp subscription during booking.                                               |
| Split Out guest bookings             | Split Out                    | Splits guest array into individual items                       | List guests for booking        | Subscribe guest booking in KlickTipp         | Splits guests for individual processing.                                                                    |
| Subscribe guest booking in KlickTipp | KlickTipp                    | Subscribes individual guests to KlickTipp                      | Split Out guest bookings       | -                                           | Adds guests to KlickTipp subscriber list for booking.                                                       |
| Invitee did not add guests to the booking | NoOp                        | Placeholder for no guests case                                 | Guests booking check (false)   | -                                           |                                                                                                               |
| Subscribe invitee cancellation in KlickTipp | KlickTipp                    | Removes invitee from KlickTipp subscriber list on cancellation | Check event (false branch)     | Guests cancellation check                    | Handles invitee cancellations by applying cancellation tag.                                                 |
| Guests cancellation check            | If                           | Checks if guest email addresses exist for cancellation       | Subscribe invitee cancellation | List guests for cancellation / No guests (NoOp) | Validates guest emails present for cancellation processing.                                                  |
| List guests for cancellation         | Set                          | Parses stored guest email addresses from invitee record       | Guests cancellation check (true) | Split Out guest cancellations               | Prepares guest data for cancellation removal in KlickTipp.                                                  |
| Split Out guest cancellations        | Split Out                    | Splits guest email list into individual items                 | List guests for cancellation   | Subscribe guest cancellation in KlickTipp    | Splits guest cancellations for individual processing.                                                       |
| Subscribe guest cancellation in KlickTipp | KlickTipp                    | Removes guests from KlickTipp subscriber list on cancellation | Split Out guest cancellations  | Rescheduling check                           | Handles guest cancellations in KlickTipp.                                                                   |
| No guest email addresses found       | NoOp                         | Placeholder for no guest email addresses found case           | Guests cancellation check (false) | -                                       | If no guest emails found, no cancellation processing required.                                              |
| Rescheduling check                   | If                           | Checks if cancellation is due to rescheduling                 | Subscribe guest cancellation   | Event was rescheduled / Subscribe invitee to empty guest addresses | Checks if cancellation is a reschedule to avoid overwriting guest data.                                      |
| Event was rescheduled                | NoOp                         | Placeholder for rescheduling event                             | Rescheduling check (true)      | -                                           |                                                                                                               |
| Subscribe invitee to empty guest addresses field | KlickTipp                | Writes null to guest email addresses field to prevent errors  | Rescheduling check (false)     | -                                           | Writes "null" to guest email field to avoid errors on rebooking.                                            |
| Split Out guest cancellations        | Split Out                    | Splits guests into individual cancellation items              | List guests for cancellation   | Subscribe guest cancellation in KlickTipp    |                                                                                                               |
| Split Out guest bookings             | Split Out                    | Splits guests into individual booking items                   | List guests for booking        | Subscribe guest booking in KlickTipp         |                                                                                                               |
| Subscribe guest cancellation in KlickTipp | KlickTipp                    | Removes guests from subscriber list on cancellation           | Split Out guest cancellations  | Rescheduling check                           |                                                                                                               |

---

### 4. Reproducing the Workflow from Scratch

1. **Create Trigger Node**  
   - Add **Calendly Trigger** node named "New Calendly event".  
   - Configure to listen for events: `"invitee.created"` and `"invitee.canceled"`.  
   - Connect Calendly API credentials.  
   - This node triggers the workflow when bookings or cancellations occur.

2. **Add Data Transformation Node**  
   - Add **Set** node named "Convert data for KlickTipp".  
   - Configure to create new fields with expressions:  
     - Convert event start/end times to UNIX timestamps (seconds).  
     - Convert invitee start/end dates adjusted for `payload.timezone` to UNIX timestamps.  
     - Calculate invitee start/end times as seconds since midnight.  
     - Extract first and last names from `first_name`, `last_name`, or parse from `name`.  
     - Format mobile phone replacing `+` with `00` and remove spaces.  
     - Extract guest email addresses into array from `scheduled_event.event_guests`.  
   - Connect output of "New Calendly event" to this node.

3. **Add Booking or Cancellation Decision**  
   - Add **If** node named "Check event - booking or cancellation?".  
   - Condition: Check if `payload.scheduled_event.status == "active"`.  
   - Connect output of "Convert data for KlickTipp" to this node.  
   - True branch: booking path; False branch: cancellation path.

4. **Invitee Booking Subscription**  
   - Add **KlickTipp** node named "Subscribe invitee booking in KlickTipp".  
   - Operation: `subscribe` on `subscriber` resource.  
   - Map email from `payload.email`.  
   - Apply booking tag ID (e.g., `12375153`).  
   - Map custom fields: first name, last name, event name, join URL, reschedule URL, cancel URL, start/end times, timezone, guest addresses, mobile phone.  
   - Use KlickTipp API credentials.  
   - Connect True output of "Check event - booking or cancellation?" to this node.

5. **Guests Booking Check**  
   - Add **If** node named "Guests booking check".  
   - Condition: Check if `payload.scheduled_event.event_guests` is not empty.  
   - Connect output of "Subscribe invitee booking in KlickTipp" to this node.

6. **List Guests for Booking**  
   - Add **Set** node named "List guests for booking".  
   - Assign `guests` field as array: map `scheduled_event.event_guests` to objects with guest emails.  
   - Connect True branch of "Guests booking check" to this node.

7. **Split Out Guest Bookings**  
   - Add **Split Out** node named "Split Out guest bookings".  
   - Configure to split items by `guests` field.  
   - Connect output of "List guests for booking" to this node.

8. **Subscribe Guest Booking**  
   - Add **KlickTipp** node named "Subscribe guest booking in KlickTipp".  
   - Operation: `subscribe` on `subscriber`.  
   - Map guest email from split item data.  
   - Use booking tag ID and map event details (event name, URLs, times, timezone).  
   - Connect output of "Split Out guest bookings" to this node.

9. **No Guests Booking Case**  
   - Add **NoOp** node named "Invitee did not add guests to the booking".  
   - Connect False branch of "Guests booking check" to this node.

10. **Invitee Cancellation Subscription**  
    - Add **KlickTipp** node named "Subscribe invitee cancellation in KlickTipp".  
    - Operation: `subscribe` on `subscriber`.  
    - Map email from `payload.email`.  
    - Use cancellation tag ID (e.g., `12506304`).  
    - Map mobile phone.  
    - Connect False output of "Check event - booking or cancellation?" to this node.

11. **Guests Cancellation Check**  
    - Add **If** node named "Guests cancellation check".  
    - Condition: Check if `field214142` contains `"@"` indicating guest emails stored.  
    - Connect output of "Subscribe invitee cancellation in KlickTipp" to this node.

12. **List Guests for Cancellation**  
    - Add **Set** node named "List guests for cancellation".  
    - Assign `invitee_guests_addresses` by parsing `field214142` JSON string.  
    - Connect True branch of "Guests cancellation check" to this node.

13. **Split Out Guest Cancellations**  
    - Add **Split Out** node named "Split Out guest cancellations".  
    - Split by `invitee_guests_addresses`.  
    - Connect output of "List guests for cancellation" to this node.

14. **Subscribe Guest Cancellation**  
    - Add **KlickTipp** node named "Subscribe guest cancellation in KlickTipp".  
    - Operation: `subscribe` on `subscriber`.  
    - Map email from split items.  
    - Use cancellation tag ID.  
    - Connect output of "Split Out guest cancellations" to this node.

15. **No Guest Emails Cancellation Case**  
    - Add **NoOp** node named "No guest email addresses found".  
    - Connect False branch of "Guests cancellation check" to this node.

16. **Rescheduling Check**  
    - Add **If** node named "Rescheduling check".  
    - Condition: Check if `payload.rescheduled == true`.  
    - Connect output of "Subscribe guest cancellation in KlickTipp" to this node.

17. **Event Was Rescheduled NoOp**  
    - Add **NoOp** node named "Event was rescheduled".  
    - Connect True branch of "Rescheduling check" to this node.

18. **Subscribe Invitee to Empty Guest Addresses Field**  
    - Add **KlickTipp** node named "Subscribe invitee to empty guest addresses field".  
    - Operation: `subscribe` on `subscriber`.  
    - Write `null` to guest addresses field (`field214142`) to clear it.  
    - Use cancellation tag ID.  
    - Connect False branch of "Rescheduling check" to this node.

---

### 5. General Notes & Resources

| Note Content                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Context or Link                                                                                             |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------|
| This workflow relies on the [KlickTipp community node](https://www.npmjs.com/package/n8n-nodes-klicktipp) and thus requires a self-hosted n8n environment.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Community node dependency link                                                                              |
| Pre-create custom fields in KlickTipp to match field IDs used in the workflow to ensure correct data mapping and avoid errors. Allow 10-15 minutes for fields to sync after creation. Reconnect KlickTipp credentials if fields do not appear.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Setup instructions in workflow description                                                                 |
| The workflow handles guest lists carefully because Calendly does not provide guest emails on cancellations. Guest emails are stored in invitee contact custom fields to allow proper cancellation handling.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Workflow design note                                                                                        |
| Timestamps are converted to UNIX timestamps (seconds) and times to seconds since midnight for KlickTipp API compliance, ensuring seamless timezone handling.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | Data transformation rationale                                                                                |
| Field mapping placeholders inside KlickTipp nodes must be customized to reflect actual field IDs and account setup in KlickTipp.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | Customization advice                                                                                        |
| ![Screenshot: KlickTipp custom field mapping](https://mail.cdndata.io/user/images/kt1073234/share_link_calendly_fields_v2.png)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | Visual guide for field mapping                                                                               |
| Testing should involve triggering actual Calendly events and verifying subscriber updates in KlickTipp.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | Deployment recommendation                                                                                   |

---

This completes the detailed technical reference document for the "Calendly to KlickTipp Integration" workflow. It enables developers and AI agents to understand the logic, dependencies, and data transformations involved, and supports full manual recreation and troubleshooting.