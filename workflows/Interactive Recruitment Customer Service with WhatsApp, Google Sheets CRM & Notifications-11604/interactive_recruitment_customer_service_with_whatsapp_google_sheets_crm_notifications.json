{"id":"Hzb71DHsvmIwoERO","meta":{"instanceId":"71cea8b8ee71ae9e4028bfd4341b5e90c7f8eec0ff038d60448762ed000aafe0","templateCredsSetupCompleted":true},"name":"List whatsapp automation response","tags":[],"nodes":[{"id":"b14f0efb-e53d-4ecf-9252-8b7ecd8943ce","name":"Webhook","type":"n8n-nodes-base.webhook","position":[-2464,576],"webhookId":"06337bdc-30f3-4526-ac76-e4563dd5e3cb","parameters":{"path":"whatsapp","options":{},"responseMode":"responseNode","multipleMethods":true},"typeVersion":1},{"id":"b447fdc6-7885-4223-a889-deda6e7630d0","name":"Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª","type":"n8n-nodes-base.code","position":[-2000,576],"parameters":{"jsCode":"// ğŸ“¥ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ÙˆØ§Ø±Ø¯Ø© Ù…Ù† WhatsApp API\nconst g = $getWorkflowStaticData('global');\ng.contacts = g.contacts || {};\n\nconst body = $json.body || $json;\nconsole.log('ğŸ“¨ Received webhook:', JSON.stringify(body, null, 2));\n\n// Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨Ù†ÙŠØ©\nconst entry = body.entry?.[0];\nif (!entry) {\n  return [{ json: { ok: false, error: 'no_entry' } }];\n}\n\nconst changes = entry.changes?.[0];\nconst value = changes?.value;\nif (!value || !value.messages) {\n  return [{ json: { ok: false, error: 'no_messages' } }];\n}\n\nconst phoneNumberId = value.metadata?.phone_number_id;\nconst businessNumber = value.metadata?.display_phone_number || '';\nconst messages = value.messages;\nconst outputs = [];\n\nfor (const msg of messages) {\n  const from = msg.from;\n  const msgId = msg.id;\n  const timestamp = parseInt(msg.timestamp);\n  const msgType = msg.type;\n  \n  // Ø§Ø³Ù… Ø§Ù„Ù…Ø±Ø³Ù„\n  const contactName = value.contacts?.[0]?.profile?.name || from || 'Ø¹Ù…ÙŠÙ„';\n  const chatKey = `${phoneNumberId}:${from}`;\n  \n  // âœ… Ø­ÙØ¸ Contact ÙÙ‚Ø· (Ø¨Ø¯ÙˆÙ† Ø±Ø³Ø§Ø¦Ù„)\n  if (!g.contacts[chatKey]) {\n    g.contacts[chatKey] = {\n      platform: 'whatsapp',\n      account: phoneNumberId,\n      phone_number_id: phoneNumberId,\n      peer: from,\n      name: contactName\n    };\n  }\n  \n  // âœ… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© (Ù…ØªÙˆØ§ÙÙ‚Ø© Ù…Ø¹ Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ù€ workflow)\n  const baseData = {\n    phone_number: from,\n    phone_number_id: phoneNumberId,\n    business_number: businessNumber,\n    contact_name: contactName,\n    is_status_update: false,\n    message_text: '',\n    interactive_reply: '',\n    interactive_title: '',\n    interactive_type: '',\n    media_type: '',\n    media_url: '',\n    media_id: '',\n    media_caption: '',\n    media_filename: '',\n    media_mime_type: ''\n  };\n  \n  // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹\n  if (msgType === 'text') {\n    baseData.message_text = msg.text?.body || '';\n    outputs.push({ json: baseData });\n  }\n  \n  // ğŸ“ Document\n  else if (msgType === 'document') {\n    const doc = msg.document || {};\n    const originalFilename = doc.filename || 'document';\n    \n    console.log('ğŸ“„ Document received:', {\n      id: doc.id,\n      filename: originalFilename,\n      mime: doc.mime_type,\n      caption: doc.caption\n    });\n    \n    baseData.media_type = 'document';\n    baseData.media_id = doc.id;\n    baseData.media_mime_type = doc.mime_type || 'application/octet-stream';\n    baseData.media_caption = doc.caption || '';\n    baseData.media_filename = originalFilename;  // âœ… Ù‡Ù†Ø§!\n    baseData.message_text = doc.caption || originalFilename;\n    \n    outputs.push({ json: baseData });\n  }\n  \n  // ğŸ–¼ï¸ Image\n  else if (msgType === 'image') {\n    const img = msg.image || {};\n    \n    baseData.media_type = 'image';\n    baseData.media_id = img.id;\n    baseData.media_mime_type = img.mime_type || 'image/jpeg';\n    baseData.media_caption = img.caption || '';\n    baseData.message_text = img.caption || 'ğŸ–¼ï¸ ØµÙˆØ±Ø©';\n    \n    outputs.push({ json: baseData });\n  }\n  \n  // ğŸ¥ Video\n  else if (msgType === 'video') {\n    const vid = msg.video || {};\n    \n    baseData.media_type = 'video';\n    baseData.media_id = vid.id;\n    baseData.media_mime_type = vid.mime_type || 'video/mp4';\n    baseData.media_caption = vid.caption || '';\n    baseData.message_text = vid.caption || 'ğŸ¥ ÙÙŠØ¯ÙŠÙˆ';\n    \n    outputs.push({ json: baseData });\n  }\n  \n  // ğŸµ Audio/Voice\n  else if (msgType === 'audio' || msgType === 'voice') {\n    const aud = msg[msgType] || {};\n    \n    baseData.media_type = msgType === 'voice' ? 'voice' : 'audio';\n    baseData.media_id = aud.id;\n    baseData.media_mime_type = aud.mime_type || 'audio/ogg';\n    baseData.message_text = msgType === 'voice' ? 'ğŸ¤ Ø±Ø³Ø§Ù„Ø© ØµÙˆØªÙŠØ©' : 'ğŸµ Ù…Ù„Ù ØµÙˆØªÙŠ';\n    \n    outputs.push({ json: baseData });\n  }\n  \n  // Interactive buttons/lists\n  else if (msgType === 'interactive') {\n    if (msg.interactive?.list_reply) {\n      baseData.interactive_reply = msg.interactive.list_reply.id || '';\n      baseData.interactive_title = msg.interactive.list_reply.title || '';\n      baseData.interactive_type = 'list_reply';\n      baseData.message_text = baseData.interactive_title;\n    } else if (msg.interactive?.button_reply) {\n      baseData.interactive_reply = msg.interactive.button_reply.id || '';\n      baseData.interactive_title = msg.interactive.button_reply.title || '';\n      baseData.interactive_type = 'button_reply';\n      baseData.message_text = baseData.interactive_title;\n    }\n    outputs.push({ json: baseData });\n  }\n  \n  // Ù†Ø³Ø® Ù‚Ø¯ÙŠÙ…Ø© (type=button)\n  else if (msgType === 'button' && msg.button) {\n    baseData.interactive_title = msg.button.text || '';\n    baseData.interactive_reply = (msg.button.payload || baseData.interactive_title || '').trim();\n    baseData.interactive_type = 'button';\n    baseData.message_text = baseData.interactive_title;\n    outputs.push({ json: baseData });\n  }\n}\n\nconsole.log(`âœ… Processed ${outputs.length} messages`);\n\nreturn outputs.length > 0 ? outputs : [{ json: { \n  ok: true, \n  no_media: true,\n  phone_number_id: phoneNumberId \n} }];"},"typeVersion":2},{"id":"91628ba1-d6ac-420b-985b-20da43beb323","name":"Ø±Ø³Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©ØŸ","type":"n8n-nodes-base.if","position":[-240,368],"parameters":{"conditions":{"string":[{"value1":"={{ $json.interactive_reply }}","operation":"isEmpty"}]}},"typeVersion":1},{"id":"8a365257-164a-4649-ba22-7d03c7c9abcb","name":"Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©","type":"n8n-nodes-base.httpRequest","position":[688,336],"parameters":{"url":"=https://graph.facebook.com/v17.0/{{ $json.phone_number_id }}/messages","method":"POST","options":{},"jsonBody":"={{ $json._outgoing.payload }}","sendBody":true,"specifyBody":"json","authentication":"genericCredentialType","genericAuthType":"httpBearerAuth"},"credentials":{"httpBearerAuth":{"id":"NOIvE5LFWAhcXfLj","name":"Bearer YOUR_TOKEN_HERE account"}},"typeVersion":4.1},{"id":"5702fbf2-eb43-4731-92d2-a60f863ce515","name":"Ø§Ù„Ø£Ø³Ø¹Ø§Ø± - Ø§Ø®ØªØ± Ø¬Ù†Ø³ÙŠØ©","type":"n8n-nodes-base.httpRequest","position":[1056,720],"parameters":{"url":"=https://graph.facebook.com/v17.0/{{ $json.phone_number_id }}/messages","method":"POST","options":{},"jsonBody":"={{ $json._outgoing.payload }}","sendBody":true,"specifyBody":"json","authentication":"genericCredentialType","genericAuthType":"httpBearerAuth"},"credentials":{"httpBearerAuth":{"id":"NOIvE5LFWAhcXfLj","name":"Bearer YOUR_TOKEN_HERE account"}},"typeVersion":4.1},{"id":"4b7f74a7-aef9-45bf-8ec2-3f51cb89d26c","name":"Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ - Ø§Ø®ØªØ± Ø¬Ù†Ø³ÙŠØ©","type":"n8n-nodes-base.httpRequest","position":[1056,864],"parameters":{"url":"=https://graph.facebook.com/v17.0/{{ $json.phone_number_id }}/messages","method":"POST","options":{},"jsonBody":"={{ $json._outgoing.payload }}","sendBody":true,"specifyBody":"json","authentication":"genericCredentialType","genericAuthType":"httpBearerAuth"},"credentials":{"httpBearerAuth":{"id":"NOIvE5LFWAhcXfLj","name":"Bearer YOUR_TOKEN_HERE account"}},"typeVersion":4.1},{"id":"374fd065-4e27-4f87-b1ff-371acf336009","name":"Ù…ØªØ§Ø¨Ø¹Ø© - Ø§Ø·Ù„Ø¨ Ø±Ù‚Ù…","type":"n8n-nodes-base.httpRequest","position":[1056,1008],"parameters":{"url":"=https://graph.facebook.com/v17.0/{{ $json.phone_number_id }}/messages","method":"POST","options":{},"jsonBody":"={{ $json._outgoing.payload }}","sendBody":true,"specifyBody":"json","authentication":"genericCredentialType","genericAuthType":"httpBearerAuth"},"credentials":{"httpBearerAuth":{"id":"NOIvE5LFWAhcXfLj","name":"Bearer YOUR_TOKEN_HERE account"}},"typeVersion":4.1},{"id":"87fbeba5-f4b6-48b7-b230-73650f4c79bc","name":"Ø§Ù„ØªØ±Ø¬Ù…Ø© - Ø±Ø§Ø¨Ø·","type":"n8n-nodes-base.httpRequest","position":[1056,1280],"parameters":{"url":"=https://graph.facebook.com/v17.0/{{ $json.phone_number_id }}/messages","method":"POST","options":{},"jsonBody":"={{ $json._outgoing.payload }}","sendBody":true,"specifyBody":"json","authentication":"genericCredentialType","genericAuthType":"httpBearerAuth"},"credentials":{"httpBearerAuth":{"id":"NOIvE5LFWAhcXfLj","name":"Bearer YOUR_TOKEN_HERE account"}},"typeVersion":4.1},{"id":"473bd547-e864-4f6b-a30b-3775aa624f61","name":"Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰ - Ø§Ø·Ù„Ø¨ ØªÙØ§ØµÙŠÙ„","type":"n8n-nodes-base.httpRequest","position":[1056,1424],"parameters":{"url":"=https://graph.facebook.com/v17.0/{{ $json.phone_number_id }}/messages","method":"POST","options":{},"jsonBody":"={{ $json._outgoing.payload }}","sendBody":true,"specifyBody":"json","authentication":"genericCredentialType","genericAuthType":"httpBearerAuth"},"credentials":{"httpBearerAuth":{"id":"NOIvE5LFWAhcXfLj","name":"Bearer YOUR_TOKEN_HERE account"}},"typeVersion":4.1},{"id":"4e754e32-b2eb-46ac-b3ac-56c24e1814d1","name":"Ø¹Ù† Ø§Ù„Ù…ÙƒØªØ¨","type":"n8n-nodes-base.httpRequest","position":[1056,1584],"parameters":{"url":"=https://graph.facebook.com/v17.0/{{ $json.phone_number_id }}/messages","method":"POST","options":{},"jsonBody":"={\n  \"messaging_product\": \"whatsapp\",\n  \"to\": \"{{ $json.phone_number }}\",\n  \"type\": \"text\",\n  \"text\": {\n    \"body\": \"ğŸ¢ Ù…ÙƒØªØ¨ ÙÙ‡Ø¯ Ù„Ù„Ø§Ø³ØªÙ‚Ø¯Ø§Ù…\\n\\nâœ… Ù…ÙƒØªØ¨ Ù…Ø¹ØªÙ…Ø¯ ÙˆÙ…Ø±Ø®Øµ Ù…Ù† Ù…Ø³Ø§Ù†Ø¯ ÙˆÙˆØ²Ø§Ø±Ø© Ø§Ù„Ø¹Ù…Ù„\\n\\nğŸŒ Ù†Ø³ØªÙ‚Ø¯Ù… Ø§Ù„Ø¹Ù…Ø§Ù„Ø© Ø§Ù„Ù…Ù†Ø²Ù„ÙŠØ© Ù…Ù† Ø§Ù„Ø¬Ù†Ø³ÙŠØ§Øª Ø§Ù„ØªØ§Ù„ÙŠØ©:\\n1- Ø§Ù„ÙÙ„Ø¨ÙŠÙ† ğŸ‡µğŸ‡­ 12,999 SAR\\n2- Ø³Ø±ÙŠÙ„Ø§Ù†ÙƒØ§ ğŸ‡±ğŸ‡° 14,700 SAR\\n3- Ø¨Ù†Ø¬Ù„Ø§Ø¯ÙŠØ´ ğŸ‡§ğŸ‡© 7,900 SAR\\n4- ÙƒÙŠÙ†ÙŠØ§ ğŸ‡°ğŸ‡ª 6,400 SAR\\n5- Ø£ÙˆØºÙ†Ø¯Ø§ ğŸ‡ºğŸ‡¬ 4,900 SAR\\n6- Ø¥Ø«ÙŠÙˆØ¨ÙŠØ§ ğŸ‡ªğŸ‡¹ 4,490 SAR\\n7- Ø¨ÙˆØ±ÙˆÙ†Ø¯ÙŠ ğŸ‡§ğŸ‡® 5,900 SAR\\n8- Ø§Ù„Ù‡Ù†Ø¯ ğŸ‡®ğŸ‡³ 3,000 SAR\\n\\nğŸ›¡ï¸ ÙŠÙˆØ¬Ø¯ ØªØ£Ù…ÙŠÙ† Ù„Ù…Ø¯Ø© Ø³Ù†ØªÙŠÙ† Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù…Ø§Ù„Ø© Ø§Ù„Ù…Ù†Ø²Ù„ÙŠØ© ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„Ù‡Ø±ÙˆØ¨ Ø£Ùˆ Ø±ÙØ¶ Ø§Ù„Ø¹Ù…Ù„.\\n\\nğŸ“ Ù„Ù„ØªÙˆØ§ØµÙ„ ÙˆØ§Ù„Ø§Ø³ØªÙØ³Ø§Ø±:\\nâ˜ï¸ 0112333325\\n\\nğŸŒ fahadrec.com\"\n  }\n}\n","sendBody":true,"specifyBody":"json","authentication":"genericCredentialType","genericAuthType":"httpBearerAuth"},"credentials":{"httpBearerAuth":{"id":"NOIvE5LFWAhcXfLj","name":"Bearer YOUR_TOKEN_HERE account"}},"typeVersion":4.1},{"id":"24d9ff16-2752-4915-9239-2ab8e4f04e98","name":"Ø§Ù„ØªØ­Ø¯Ø« Ù…Ø¹ Ù…ÙˆØ¸Ù","type":"n8n-nodes-base.httpRequest","position":[1056,1728],"parameters":{"url":"=https://graph.facebook.com/v17.0/{{ $json.phone_number_id }}/messages","method":"POST","options":{},"jsonBody":"={\n  \"messaging_product\": \"whatsapp\",\n  \"to\": \"{{ $json.phone_number }}\",\n  \"type\": \"text\",\n  \"text\": {\n    \"body\": \"ğŸ¤ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±...\\n\\nØ³ÙŠØªÙ… Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ Ù…Ù† Ø£Ø­Ø¯ Ù…ÙˆØ¸ÙÙŠ Ø®Ø¯Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ ÙÙŠ Ø£Ù‚Ø±Ø¨ ÙˆÙ‚Øª Ù…Ù…ÙƒÙ†.\\n\\nØ´ÙƒØ±Ø§Ù‹ Ù„ØªÙˆØ§ØµÙ„Ùƒ Ù…Ø¹Ù†Ø§! â¤ï¸\"\n  }\n}","sendBody":true,"specifyBody":"json","authentication":"genericCredentialType","genericAuthType":"httpBearerAuth"},"credentials":{"httpBearerAuth":{"id":"NOIvE5LFWAhcXfLj","name":"Bearer YOUR_TOKEN_HERE account"}},"typeVersion":4.1},{"id":"1aa07f2b-5e6b-4058-aa1c-7b24cca5cdff","name":"Respond to Webhook","type":"n8n-nodes-base.respondToWebhook","position":[1456,1088],"parameters":{"options":{},"respondWith":"json","responseBody":"={ \"status\": \"success\" }"},"typeVersion":1},{"id":"91ac8558-125b-46ac-a6e7-df5f9f39c425","name":"menu route","type":"n8n-nodes-base.switch","position":[272,1136],"parameters":{"rules":{"values":[{"outputKey":"Ø§Ù„Ø£Ø³Ø¹Ø§Ø±","conditions":{"options":{"version":1,"leftValue":"","caseSensitive":true,"typeValidation":"strict"},"combinator":"and","conditions":[{"id":"572679ed-98e5-4ef2-91ef-f71ee5f71d5a","operator":{"type":"string","operation":"equals"},"leftValue":"={{ $json.interactive_reply }}","rightValue":"m_prices"}]},"renameOutput":true},{"outputKey":"Ø·Ù„Ø¨_Ø¬Ø¯ÙŠØ¯","conditions":{"options":{"version":1,"leftValue":"","caseSensitive":true,"typeValidation":"strict"},"combinator":"and","conditions":[{"id":"e82c38ca-2b19-41ee-81c3-e31fbf68f11e","operator":{"type":"string","operation":"equals"},"leftValue":"={{ $json.interactive_reply }}","rightValue":"m_new_request"}]},"renameOutput":true},{"outputKey":"Ù…ØªØ§Ø¨Ø¹Ø©_Ø·Ù„Ø¨","conditions":{"options":{"version":1,"leftValue":"","caseSensitive":true,"typeValidation":"strict"},"combinator":"and","conditions":[{"id":"360450e9-4cad-447c-b4fa-634ea86b2fd4","operator":{"type":"string","operation":"equals"},"leftValue":"={{ $json.interactive_reply }}","rightValue":"m_track_request"}]},"renameOutput":true},{"outputKey":"Ù†Ù‚Ù„_Ø®Ø¯Ù…Ø§Øª","conditions":{"options":{"version":1,"leftValue":"","caseSensitive":true,"typeValidation":"strict"},"combinator":"and","conditions":[{"id":"4ec032b5-e027-4604-a7d8-df690fbda405","operator":{"type":"string","operation":"equals"},"leftValue":"={{ $json.interactive_reply }}","rightValue":"m_transfer"}]},"renameOutput":true},{"outputKey":"Ø§Ù„ØªØ±Ø¬Ù…Ø©","conditions":{"options":{"version":1,"leftValue":"","caseSensitive":true,"typeValidation":"strict"},"combinator":"and","conditions":[{"id":"300ccf24-770f-4da4-b4ba-1512a24d78bd","operator":{"type":"string","operation":"equals"},"leftValue":"={{ $json.interactive_reply }}","rightValue":"m_translation"}]},"renameOutput":true},{"outputKey":"Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰","conditions":{"options":{"version":1,"leftValue":"","caseSensitive":true,"typeValidation":"strict"},"combinator":"and","conditions":[{"id":"2d739557-df98-49d6-98af-27828c64802a","operator":{"type":"string","operation":"equals"},"leftValue":"={{ $json.interactive_reply }}","rightValue":"m_complaints"}]},"renameOutput":true},{"outputKey":"Ø¹Ù†_Ø§Ù„Ù…ÙƒØªØ¨","conditions":{"options":{"version":1,"leftValue":"","caseSensitive":true,"typeValidation":"strict"},"combinator":"and","conditions":[{"id":"494bb8e9-64b8-4423-8573-8fbd9e5ff500","operator":{"type":"string","operation":"equals"},"leftValue":"={{ $json.interactive_reply }}","rightValue":"m_about"}]},"renameOutput":true},{"outputKey":"Ù…ÙˆØ¸Ù","conditions":{"options":{"version":1,"leftValue":"","caseSensitive":true,"typeValidation":"strict"},"combinator":"and","conditions":[{"id":"55cff913-09b2-407b-983b-cfdf15ac4b28","operator":{"type":"string","operation":"equals"},"leftValue":"={{ $json.interactive_reply }}","rightValue":"m_talk_to_agent"}]},"renameOutput":true}]},"options":{}},"typeVersion":3},{"id":"85e4dcf9-fbb3-43b1-be9d-7063cf506345","name":"If","type":"n8n-nodes-base.if","position":[1648,160],"parameters":{"options":{},"conditions":{"options":{"version":2,"leftValue":"","caseSensitive":true,"typeValidation":"strict"},"combinator":"and","conditions":[{"id":"249da7be-36df-4fa6-bd36-397c8a717315","operator":{"name":"filter.operator.equals","type":"string","operation":"equals"},"leftValue":"={{ $json['Nationality'] }}","rightValue":"={{ $('sub route').item.json.interactive_reply }}"}]}},"typeVersion":2.2},{"id":"29dc3f4a-8977-473f-b767-ab12246bd5d6","name":"Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø£Ø³Ø¹Ø§Ø±","type":"n8n-nodes-base.httpRequest","position":[2192,144],"parameters":{"url":"=https://graph.facebook.com/v17.0/{{ $('sub route').item.json.phone_number_id }}/messages","method":"POST","options":{},"jsonBody":"={{ $json._outgoing.payload }}","sendBody":true,"specifyBody":"json","authentication":"genericCredentialType","genericAuthType":"httpBearerAuth"},"credentials":{"httpBearerAuth":{"id":"NOIvE5LFWAhcXfLj","name":"Bearer YOUR_TOKEN_HERE account"}},"typeVersion":4.1},{"id":"161e9e68-4bcd-4388-8ba1-e175d98a7076","name":"If1","type":"n8n-nodes-base.if","position":[1648,416],"parameters":{"options":{},"conditions":{"options":{"version":2,"leftValue":"","caseSensitive":true,"typeValidation":"strict"},"combinator":"and","conditions":[{"id":"249da7be-36df-4fa6-bd36-397c8a717315","operator":{"name":"filter.operator.equals","type":"string","operation":"equals"},"leftValue":"={{ $json['Ø§Ù„Ø¬Ù†Ø³ÙŠØ© '] }}","rightValue":"={{ $('sub route').item.json.interactive_reply }}"}]}},"typeVersion":2.2},{"id":"78ea897f-39a2-45e5-8b99-015371056971","name":"Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø³ÙŠØ±","type":"n8n-nodes-base.httpRequest","position":[2080,400],"parameters":{"url":"=https://graph.facebook.com/v17.0/{{ $('sub route').item.json.phone_number_id }}/messages","method":"POST","options":{},"jsonBody":"={\n  \"messaging_product\": \"whatsapp\",\n  \"to\": \"{{ $('sub route').item.json.phone_number }}\",\n  \"type\": \"text\",\n  \"text\": {\n    \"body\": \"âœ… ØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¬Ù†Ø³ÙŠØ©: {{ $json['Ø§Ù„Ø¨Ù„Ø¯'] }}\\n\\nğŸ“„ Ø±Ø§Ø¨Ø· Ø§Ù„Ø³ÙŠØ± Ø§Ù„Ø°Ø§ØªÙŠØ© Ù„Ù„Ø¬Ù†Ø³ÙŠØ© Ù„Ù„Ø·Ù„Ø¨ Ø§Ù„Ø¬Ø¯ÙŠØ¯: {{ $json['Ø§Ù„Ø³ÙŠØ±Ø©'] }} \\n\\nğŸ’¡ Ø³ÙŠØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø²ÙŠØ§Ø±ØªÙƒ Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù‡ØªÙ…Ø§Ù…Ùƒ\"\n  }\n}\n","sendBody":true,"specifyBody":"json","authentication":"genericCredentialType","genericAuthType":"httpBearerAuth"},"credentials":{"httpBearerAuth":{"id":"NOIvE5LFWAhcXfLj","name":"Bearer YOUR_TOKEN_HERE account"}},"typeVersion":4.1},{"id":"02a6fa83-763c-4e84-b737-e7549ca01ba4","name":"Wait","type":"n8n-nodes-base.wait","position":[2432,400],"webhookId":"b89a9669-352c-4823-8a48-f4ccd65da6ee","parameters":{},"typeVersion":1.1},{"id":"c240ad3d-9147-4d24-bad7-1810db0b1eb8","name":"Ø±Ø³Ø§Ù„Ø© ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø³ÙŠØ±Ø©","type":"n8n-nodes-base.httpRequest","position":[2880,400],"parameters":{"url":"=https://graph.facebook.com/v17.0/{{ $('sub route').item.json.phone_number_id }}/messages","method":"POST","options":{},"jsonBody":"={\n  \"messaging_product\": \"whatsapp\",\n  \"to\": \"{{ $('sub route').item.json.phone_number }}\",\n  \"type\": \"text\",\n  \"text\": {\n    \"body\": \"ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø·Ù„Ø¨ÙƒØŒ ÙˆØ³ÙŠØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ Ø§Ù„Ù…ÙˆØ¸Ù Ù‚Ø±ÙŠØ¨Ù‹Ø§\"\n  }\n}\n","sendBody":true,"specifyBody":"json","authentication":"genericCredentialType","genericAuthType":"httpBearerAuth"},"credentials":{"httpBearerAuth":{"id":"NOIvE5LFWAhcXfLj","name":"Bearer YOUR_TOKEN_HERE account"}},"typeVersion":4.1},{"id":"b21d3613-3da3-4148-95a4-89ebb6f67dea","name":"Ø¥Ø¯Ø®Ø§Ù„ Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯","type":"n8n-nodes-base.googleSheets","position":[2272,400],"parameters":{"columns":{"value":{"Ø§Ù„Ø¨Ù„Ø¯":"={{ $('If1').item.json['Ø§Ù„Ø¨Ù„Ø¯'] }}","Ø§Ù„Ø­Ø§Ù„Ø©":"Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©","Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„":"={{ $('sub route').item.json.contact_name }}","Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ ":"={{ $('sub route').item.json.phone_number }}"},"schema":[{"id":"Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ ","type":"string","display":true,"removed":false,"required":false,"displayName":"Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ ","defaultMatch":false,"canBeUsedToMatch":true},{"id":"Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„","type":"string","display":true,"required":false,"displayName":"Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„","defaultMatch":false,"canBeUsedToMatch":true},{"id":"Ø§Ù„Ø¨Ù„Ø¯","type":"string","display":true,"required":false,"displayName":"Ø§Ù„Ø¨Ù„Ø¯","defaultMatch":false,"canBeUsedToMatch":true},{"id":"Ø§Ù„Ø­Ø§Ù„Ø©","type":"string","display":true,"removed":false,"required":false,"displayName":"Ø§Ù„Ø­Ø§Ù„Ø©","defaultMatch":false,"canBeUsedToMatch":true}],"mappingMode":"defineBelow","matchingColumns":["Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ "],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{},"operation":"appendOrUpdate","sheetName":{"__rl":true,"mode":"list","value":"gid=0","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1lR0Y0r-bAvLWxVzTW8P3pex1vyxjqfNjQ8RRe0ozMyQ/edit#gid=0","cachedResultName":"Ø·Ù„Ø¨Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©"},"documentId":{"__rl":true,"mode":"list","value":"1lR0Y0r-bAvLWxVzTW8P3pex1vyxjqfNjQ8RRe0ozMyQ","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1lR0Y0r-bAvLWxVzTW8P3pex1vyxjqfNjQ8RRe0ozMyQ/edit?usp=drivesdk","cachedResultName":"Fahed"}},"credentials":{"googleSheetsOAuth2Api":{"id":"33emo87Op4gORh5N","name":"Google Sheets account"}},"executeOnce":true,"typeVersion":4.7},{"id":"e3f36a74-3c90-4392-9050-64000f5e64d8","name":"Ù…ØªØ§Ø¨Ø¹Ø©","type":"n8n-nodes-base.googleSheets","position":[1456,640],"parameters":{"options":{},"filtersUI":{"values":[{"lookupValue":"={{ $('Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª').item.json.phone_number }}","lookupColumn":"Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ "}]},"sheetName":{"__rl":true,"mode":"list","value":"gid=0","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1lR0Y0r-bAvLWxVzTW8P3pex1vyxjqfNjQ8RRe0ozMyQ/edit#gid=0","cachedResultName":"Ø·Ù„Ø¨Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©"},"documentId":{"__rl":true,"mode":"list","value":"1lR0Y0r-bAvLWxVzTW8P3pex1vyxjqfNjQ8RRe0ozMyQ","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1lR0Y0r-bAvLWxVzTW8P3pex1vyxjqfNjQ8RRe0ozMyQ/edit?usp=drivesdk","cachedResultName":"Fahed"}},"credentials":{"googleSheetsOAuth2Api":{"id":"33emo87Op4gORh5N","name":"Google Sheets account"}},"executeOnce":true,"typeVersion":4.7,"alwaysOutputData":true},{"id":"be0e5b6e-0fea-4357-a808-5a094f1c8451","name":"If2","type":"n8n-nodes-base.if","position":[1744,640],"parameters":{"options":{},"conditions":{"options":{"version":2,"leftValue":"","caseSensitive":true,"typeValidation":"strict"},"combinator":"and","conditions":[{"id":"249da7be-36df-4fa6-bd36-397c8a717315","operator":{"type":"boolean","operation":"true","singleValue":true},"leftValue":"={{ $json.found }}","rightValue":"={{ $('Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª').item.json.phone_number }}"}]}},"typeVersion":2.2},{"id":"f386d583-e97b-4ff7-9c94-e4ae6bd2cb44","name":"Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©","type":"n8n-nodes-base.httpRequest","position":[2240,624],"parameters":{"url":"=https://graph.facebook.com/v17.0/{{ $('sub route').item.json.phone_number_id }}/messages","method":"POST","options":{},"jsonBody":"={\n  \"messaging_product\": \"whatsapp\",\n  \"to\": \"{{ $('sub route').item.json.phone_number }}\",\n  \"type\": \"text\",\n  \"text\": {\n    \"body\": \" Ø­Ø§Ù„Ø© Ø·Ù„Ø¨Ùƒ: {{ $json['Ø§Ù„Ø­Ø§Ù„Ø©'] }} \"\n  }\n}\n","sendBody":true,"specifyBody":"json","authentication":"genericCredentialType","genericAuthType":"httpBearerAuth"},"credentials":{"httpBearerAuth":{"id":"NOIvE5LFWAhcXfLj","name":"Bearer YOUR_TOKEN_HERE account"}},"typeVersion":4.1},{"id":"9f99b7aa-0de0-40d6-845d-5fcb68e5ce65","name":"Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©1","type":"n8n-nodes-base.httpRequest","position":[2240,832],"parameters":{"url":"=https://graph.facebook.com/v17.0/{{ $('sub route').item.json.phone_number_id }}/messages","method":"POST","options":{},"jsonBody":"={\n  \"messaging_product\": \"whatsapp\",\n  \"to\": \"{{ $('sub route').item.json.phone_number }}\",\n  \"type\": \"text\",\n  \"text\": {\n    \"body\": \" Ø¹Ø°Ø±Ù‹Ø§ØŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø·Ù„Ø¨ Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø±Ù‚Ù… \"\n  }\n}\n","sendBody":true,"specifyBody":"json","authentication":"genericCredentialType","genericAuthType":"httpBearerAuth"},"credentials":{"httpBearerAuth":{"id":"NOIvE5LFWAhcXfLj","name":"Bearer YOUR_TOKEN_HERE account"}},"typeVersion":4.1},{"id":"47b823fe-8dfd-4911-b20f-45a63d88437b","name":"Wait1","type":"n8n-nodes-base.wait","position":[2064,1328],"webhookId":"e2aee621-7f8c-4425-a33e-689c2d8642e7","parameters":{},"typeVersion":1.1},{"id":"590e17e2-f6da-42be-b476-e904da8ae953","name":"Ø§Ù‚Ø±Ø£ Ø§Ù„Ø­Ø§Ù„Ø©","type":"n8n-nodes-base.code","position":[-448,592],"parameters":{"jsCode":"const inItem = $input.first().json;\nconst store = $getWorkflowStaticData('global');\n\nconst account = String(inItem.phone_number_id || '').trim();\nconst peer    = String(inItem.phone_number || '').trim();\nconst key = account && peer ? `${account}:${peer}` : (peer || 'unknown');\n\nconst session = (store.sessions && store.sessions[key]) || { state: 'idle', ts: 0, updatedAt: 0 };\n\nreturn [{\n  json: {\n    ...inItem,\n    session_state: session.state,\n    session_ts: session.updatedAt || session.ts || 0,\n    used_key: key,\n    session_name: session.name || inItem.contact_name || 'Ø¹Ù…ÙŠÙ„'\n  }\n}];\n"},"typeVersion":2},{"id":"5f5c2b17-c71e-4229-9f6e-9df625d74d24","name":"If5","type":"n8n-nodes-base.if","position":[-2160,592],"parameters":{"options":{},"conditions":{"options":{"version":2,"leftValue":"","caseSensitive":true,"typeValidation":"strict"},"combinator":"or","conditions":[{"id":"9221fb66-eed3-40ae-9a7f-6ebccc56c74a","operator":{"type":"string","operation":"exists","singleValue":true},"leftValue":"={{ $json.body.entry[0].changes[0].value.contacts[0].wa_id }}","rightValue":""}]}},"typeVersion":2.2},{"id":"138879c5-5ee7-431f-b3e0-5b3bbb71e0c4","name":"Ù†Ù‚Ù„ Ø®Ø§Ø¯Ù…Ø§Øª - Ø§Ø®ØªØ± Ø¬Ù†Ø³ÙŠØ©","type":"n8n-nodes-base.httpRequest","position":[1056,1152],"parameters":{"url":"=https://graph.facebook.com/v17.0/{{ $json.phone_number_id }}/messages","method":"POST","options":{},"jsonBody":"={{ $json._outgoing.payload }}","sendBody":true,"specifyBody":"json","authentication":"genericCredentialType","genericAuthType":"httpBearerAuth"},"credentials":{"httpBearerAuth":{"id":"NOIvE5LFWAhcXfLj","name":"Bearer YOUR_TOKEN_HERE account"}},"typeVersion":4.1},{"id":"701db46e-76cf-48a7-9876-4a0ecfc9418f","name":"Ù†Ù‚Ù„ Ø®Ø§Ø¯Ù…Ø§Øª Ù…Ù† Ø§Ù„Ø´ÙŠØª","type":"n8n-nodes-base.googleSheets","position":[1696,1328],"parameters":{"options":{},"sheetName":{"__rl":true,"mode":"list","value":434305240,"cachedResultUrl":"https://docs.google.com/spreadsheets/d/1lR0Y0r-bAvLWxVzTW8P3pex1vyxjqfNjQ8RRe0ozMyQ/edit#gid=434305240","cachedResultName":"Ù†Ù‚Ù„ Ø§Ù„Ø®Ø§Ø¯Ù…Ø§Øª"},"documentId":{"__rl":true,"mode":"list","value":"1lR0Y0r-bAvLWxVzTW8P3pex1vyxjqfNjQ8RRe0ozMyQ","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1lR0Y0r-bAvLWxVzTW8P3pex1vyxjqfNjQ8RRe0ozMyQ/edit?usp=drivesdk","cachedResultName":"Fahed"}},"credentials":{"googleSheetsOAuth2Api":{"id":"33emo87Op4gORh5N","name":"Google Sheets account"}},"executeOnce":true,"typeVersion":4.7},{"id":"69feed29-0596-4982-84e5-278249d9c0ac","name":"Ø¥Ø¯Ø®Ø§Ù„ Ù†Ù‚Ù„ Ø®Ø§Ø¯Ù…Ø§Øª","type":"n8n-nodes-base.googleSheets","position":[1872,1328],"parameters":{"columns":{"value":{"Ø§Ù„Ø­Ø§Ù„Ø©":"Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©","Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„":"={{ $('sub route').item.json.contact_name }}","Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ ":"={{ $('Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª').item.json.phone_number }}"},"schema":[{"id":"Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ ","type":"string","display":true,"removed":false,"required":false,"displayName":"Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ ","defaultMatch":false,"canBeUsedToMatch":true},{"id":"Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„","type":"string","display":true,"removed":false,"required":false,"displayName":"Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„","defaultMatch":false,"canBeUsedToMatch":true},{"id":"Ø§Ù„Ø­Ø§Ù„Ø©","type":"string","display":true,"removed":false,"required":false,"displayName":"Ø§Ù„Ø­Ø§Ù„Ø©","defaultMatch":false,"canBeUsedToMatch":true}],"mappingMode":"defineBelow","matchingColumns":["Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ "],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{},"operation":"appendOrUpdate","sheetName":{"__rl":true,"mode":"list","value":434305240,"cachedResultUrl":"https://docs.google.com/spreadsheets/d/1lR0Y0r-bAvLWxVzTW8P3pex1vyxjqfNjQ8RRe0ozMyQ/edit#gid=434305240","cachedResultName":"Ù†Ù‚Ù„ Ø§Ù„Ø®Ø§Ø¯Ù…Ø§Øª"},"documentId":{"__rl":true,"mode":"list","value":"1lR0Y0r-bAvLWxVzTW8P3pex1vyxjqfNjQ8RRe0ozMyQ","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1lR0Y0r-bAvLWxVzTW8P3pex1vyxjqfNjQ8RRe0ozMyQ/edit?usp=drivesdk","cachedResultName":"Fahed"}},"credentials":{"googleSheetsOAuth2Api":{"id":"33emo87Op4gORh5N","name":"Google Sheets account"}},"executeOnce":true,"typeVersion":4.7},{"id":"473acdac-00cd-4b52-ad1d-951c16451a50","name":"Ø±Ø³Ø§Ù„Ø© ØªØ£ÙƒÙŠØ¯ Ø·Ù„Ø¨ Ø§Ù„Ù†Ù‚Ù„ Ø§Ù„Ø®Ø§Ø¯Ù…Ø§Øª","type":"n8n-nodes-base.httpRequest","position":[2528,1328],"parameters":{"url":"=https://graph.facebook.com/v17.0/{{ $('sub route').item.json.phone_number_id }}/messages","method":"POST","options":{},"jsonBody":"={\n  \"messaging_product\": \"whatsapp\",\n  \"to\": \"{{ $('sub route').item.json.phone_number }}\",\n  \"type\": \"text\",\n  \"text\": {\n    \"body\": \"ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø·Ù„Ø¨ÙƒØŒ ÙˆØ³ÙŠØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ Ø§Ù„Ù…ÙˆØ¸Ù Ù‚Ø±ÙŠØ¨Ù‹Ø§\"\n  }\n}\n","sendBody":true,"specifyBody":"json","authentication":"genericCredentialType","genericAuthType":"httpBearerAuth"},"credentials":{"httpBearerAuth":{"id":"NOIvE5LFWAhcXfLj","name":"Bearer YOUR_TOKEN_HERE account"}},"typeVersion":4.1},{"id":"b595ef3b-85ae-4762-ad4e-a4a2bf421726","name":"Code in JavaScript","type":"n8n-nodes-base.code","position":[1600,640],"parameters":{"jsCode":"const items = $input.all();\n\n// Ù†Ø¹ØªØ¨Ø± Ø£Ù†Ù‡ \"ÙˆØ¬Ø¯ ØµÙ\" ÙÙ‚Ø· Ø¥Ø°Ø§:\nconst hasData =\n  items.length > 0 &&\n  items.some(it => it && it.json && Object.keys(it.json).length > 0); // Ù…Ø´ ÙØ§Ø¶ÙŠ\n\nif (hasData) {\n  // Ø±Ø¬Ù‘Ø¹ ÙƒÙ„ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ù…Ø¹ found=trueØŒ ÙˆØ§Ø­ÙØ¸ Ø§Ù„Ø§Ù‚ØªØ±Ø§Ù† Ù…Ø¹ Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„\n  return items.map((item, idx) => ({\n    json: { ...item.json, found: true },\n    pairedItem: { item: idx },   // Ù…Ù‡Ù… Ù„ØªÙØ§Ø¯ÙŠ Ø§Ù„ØªØ­Ø°ÙŠØ± ÙˆØ§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ .item\n  }));\n}\n\n// Ù…Ø§ ÙÙŠ Ù†ØªØ§Ø¦Ø¬ Ù…Ù† Ø§Ù„Ø´ÙŠØª â†’ Ø±Ø¬Ù‘Ø¹ Ø¹Ù†ØµØ± ÙˆØ§Ø­Ø¯ Ù…Ø¹ found=false (ÙˆØ¨Ø¯ÙˆÙ† ÙƒØ³Ø± Ø§Ù„Ø§Ù‚ØªØ±Ø§Ù†)\nconst base = items[0] || { json: {} };\nreturn [{\n  json: { ...base.json, found: false },\n  pairedItem: base.pairedItem ?? { item: 0 },\n}];\n"},"typeVersion":2},{"id":"75862d4d-7765-4b66-9942-10dca2bd59b8","name":"Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰ - Ø§Ø·Ù„Ø¨ ØªÙØ§ØµÙŠÙ„1","type":"n8n-nodes-base.httpRequest","position":[2000,1600],"parameters":{"url":"=https://graph.facebook.com/v17.0/{{ $json.phone_number_id }}/messages","method":"POST","options":{},"jsonBody":"={\n  \"messaging_product\": \"whatsapp\",\n  \"to\": \"{{ $json.phone_number }}\",\n  \"type\": \"text\",\n  \"text\": {\n    \"body\": \"âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø´ÙƒÙˆÙ‰ Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ Ø¨Ù†Ø¬Ø§Ø­.\\n\\nğŸ“Œ Ù†ÙˆØ¹ Ø§Ù„Ø´ÙƒÙˆÙ‰: {{ $json.interactive_title }}\\n\\nÙØ±ÙŠÙ‚ Ø§Ù„Ø¯Ø¹Ù… Ø³ÙŠØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ Ù‚Ø±ÙŠØ¨Ù‹Ø§ Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù…Ø´ÙƒÙ„Ø© ğŸ™\"\n  }\n}\n","sendBody":true,"specifyBody":"json","authentication":"genericCredentialType","genericAuthType":"httpBearerAuth"},"credentials":{"httpBearerAuth":{"id":"NOIvE5LFWAhcXfLj","name":"Bearer YOUR_TOKEN_HERE account"}},"typeVersion":4.1},{"id":"7552414b-0e87-4e32-b3f0-916580050439","name":"Ø¥Ø¯Ø®Ø§Ù„ Ù†Ù‚Ù„ Ø®Ø§Ø¯Ù…Ø§Øª1","type":"n8n-nodes-base.googleSheets","position":[2384,1600],"parameters":{"columns":{"value":{"Ø§Ù„Ø´ÙƒÙˆÙ‰":"={{ $('Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª').item.json.interactive_title }}","Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„":"={{ $('sub route').item.json.contact_name }}","Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ ":"={{ $('Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª').item.json.phone_number }}"},"schema":[{"id":"Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ ","type":"string","display":true,"removed":false,"required":false,"displayName":"Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ ","defaultMatch":false,"canBeUsedToMatch":true},{"id":"Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„","type":"string","display":true,"removed":false,"required":false,"displayName":"Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„","defaultMatch":false,"canBeUsedToMatch":true},{"id":"Ø§Ù„Ø´ÙƒÙˆÙ‰","type":"string","display":true,"removed":false,"required":false,"displayName":"Ø§Ù„Ø´ÙƒÙˆÙ‰","defaultMatch":false,"canBeUsedToMatch":true}],"mappingMode":"defineBelow","matchingColumns":["Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ "],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{},"operation":"appendOrUpdate","sheetName":{"__rl":true,"mode":"list","value":1283595730,"cachedResultUrl":"https://docs.google.com/spreadsheets/d/1lR0Y0r-bAvLWxVzTW8P3pex1vyxjqfNjQ8RRe0ozMyQ/edit#gid=1283595730","cachedResultName":"Ø´ÙƒØ§ÙˆÙŠ"},"documentId":{"__rl":true,"mode":"list","value":"1lR0Y0r-bAvLWxVzTW8P3pex1vyxjqfNjQ8RRe0ozMyQ","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1lR0Y0r-bAvLWxVzTW8P3pex1vyxjqfNjQ8RRe0ozMyQ/edit?usp=drivesdk","cachedResultName":"Fahed"}},"credentials":{"googleSheetsOAuth2Api":{"id":"33emo87Op4gORh5N","name":"Google Sheets account"}},"executeOnce":true,"typeVersion":4.7},{"id":"5bd6a30a-3b4a-4d52-aaf0-e7f5caf93583","name":"Verify Webhook2","type":"n8n-nodes-base.respondToWebhook","position":[-2160,400],"parameters":{"options":{"responseCode":200},"respondWith":"text","responseBody":"={{$json.query['hub.challenge'] || 'OK'}}"},"typeVersion":1.4},{"id":"5841027e-3f56-48d5-ba6e-2e91d4b49ed9","name":"Code in JavaScript1","type":"n8n-nodes-base.code","position":[-1200,624],"parameters":{"jsCode":"const g = $getWorkflowStaticData('global');\nconst inItem = $input.first().json;\n\n// ğŸ·ï¸ PART 1: Label Tracker - ØªØªØ¨Ø¹ Ø§Ù„ØªØ³Ù…ÙŠØ§Øª\ng.labels = g.labels || {};\n\nconst account = String(inItem.phone_number_id || '').trim();\nconst peer = String(inItem.phone_number || '').trim();\nconst interactiveReply = String(inItem.interactive_reply || '').trim();\n\nif (account && peer) {\n  const key = `${account}:${peer}`;\n  let label = g.labels[key] || ''; // âœ… Ø§Ø­ØªÙØ¸ Ø¨Ø§Ù„Ù€ label Ø§Ù„Ø³Ø§Ø¨Ù‚ Ø¥Ø°Ø§ Ù„Ù… ÙŠØªØºÙŠØ±\n\n  // Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©\n  if (interactiveReply === 'm_prices') {\n    label = 'Ø§Ù„Ø£Ø³Ø¹Ø§Ø±';\n  } else if (interactiveReply === 'm_new_request') {\n    label = 'Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯';\n  } else if (interactiveReply === 'm_track_request') {\n    label = 'Ù…ØªØ§Ø¨Ø¹Ø© Ø·Ù„Ø¨';\n  } else if (interactiveReply === 'm_transfer') {\n    label = 'Ù†Ù‚Ù„ Ø§Ù„Ø®Ø§Ø¯Ù…Ø§Øª';\n  } else if (interactiveReply === 'm_translation') {\n    label = 'Ø§Ù„ØªØ±Ø¬Ù…Ø©';\n  } else if (interactiveReply === 'm_talk_to_agent') {\n    label = 'Ø§Ù„ØªØ­Ø¯Ø« Ù…Ø¹ Ù…ÙˆØ¸Ù';\n  }\n  // Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰ ÙˆØ§Ù„Ø¯Ø¹Ù…\n  else if (interactiveReply === 'complaint_worker') {\n    label = 'Ù…Ø´ÙƒÙ„Ø© Ù…Ø¹ Ø§Ù„Ø¹Ø§Ù…Ù„Ø©';\n  } else if (interactiveReply === 'complaint_service') {\n    label = 'Ù…Ø´ÙƒÙ„Ø© ÙÙŠ Ø§Ù„Ø®Ø¯Ù…Ø©';\n  } else if (interactiveReply === 'complaint_delay') {\n    label = 'ØªØ£Ø®ÙŠØ± ÙÙŠ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª';\n  } else if (interactiveReply === 'complaint_financial') {\n    label = 'Ù…Ø´Ø§ÙƒÙ„ Ù…Ø§Ù„ÙŠØ©';\n  } else if (interactiveReply === 'complaint_other') {\n    label = 'Ø´ÙƒÙˆÙ‰ Ø£Ø®Ø±Ù‰';\n  }\n  // Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„ÙØ±Ø¹ÙŠØ©\n  else if (interactiveReply && interactiveReply.startsWith('price_')) {\n    label = 'Ø§Ù„Ø£Ø³Ø¹Ø§Ø±';\n  } else if (interactiveReply && interactiveReply.startsWith('req_')) {\n    label = 'Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯';\n  }\n\n  // âœ… Ø­ÙØ¸ Ø§Ù„ØªØ³Ù…ÙŠØ© (Ø­ØªÙ‰ Ù„Ùˆ ÙƒØ§Ù†Øª ÙØ§Ø±ØºØ© Ù„Ù†Ø­ØªÙØ¸ Ø¨Ø¢Ø®Ø± label)\n  g.labels[key] = label;\n}\n\n// ğŸ¤– PART 2: Bot Enable Check - ÙØ­Øµ ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¨ÙˆØª\ng.botEnabled = g.botEnabled || {};\nif (g.botMasterOn === undefined) {\n  g.botMasterOn = true;\n}\n\nlet botEnabled = g.botMasterOn;\n\nif (account && peer) {\n  const exactKey = `${account}:${peer}`;\n  const defaultKey = `default:${peer}`;\n  \n  if (g.botEnabled.hasOwnProperty(exactKey)) {\n    botEnabled = g.botEnabled[exactKey] === true;\n  }\n  else if (g.botEnabled.hasOwnProperty(defaultKey)) {\n    botEnabled = g.botEnabled[defaultKey] === true;\n  }\n}\n\nreturn [{\n  json: {\n    ...inItem,\n    bot_enabled: botEnabled\n  }\n}];"},"typeVersion":2},{"id":"d178569c-ed71-4098-9398-ec7fc801ffef","name":"bot on?","type":"n8n-nodes-base.if","position":[-672,624],"parameters":{"options":{},"conditions":{"options":{"version":2,"leftValue":"","caseSensitive":true,"typeValidation":"strict"},"combinator":"and","conditions":[{"id":"4988fbae-65bb-4a17-afb8-3e3f26082c42","operator":{"type":"boolean","operation":"true","singleValue":true},"leftValue":"={{ $json.bot_enabled }}","rightValue":"true"}]}},"typeVersion":2.2},{"id":"8dc49fde-2ca7-42dc-8478-d60ea7ff6a49","name":"Ø³Ø¬Ù„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„","type":"n8n-nodes-base.code","position":[-1024,624],"parameters":{"jsCode":"const g = $getWorkflowStaticData('global');\ng.messages = g.messages || [];\ng.contacts = g.contacts || {};\n\nconst inItem = $input.first().json;\nconst account = String(inItem.phone_number_id || '').trim();\nconst peer = String(inItem.phone_number || '').trim();\nconst key = account && peer ? `${account}:${peer}` : null;\n\nif (!account || !peer) {\n  return [{ json: inItem }];\n}\n\nlet text = (inItem.message_text || '').trim();\nlet meta;\n// ===== Helper functions =====\nfunction inferExtFromMime(mime) {\n  if (!mime) return null;\n  const map = {\n    'application/pdf': 'pdf',\n    'application/msword': 'doc',\n    'application/vnd.openxmlformats-officedocument.wordprocessingml.document': 'docx',\n    'application/vnd.ms-excel': 'xls',\n    'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet': 'xlsx',\n    'application/vnd.ms-powerpoint': 'ppt',\n    'application/vnd.openxmlformats-officedocument.presentationml.presentation': 'pptx',\n    'text/plain': 'txt',\n    'text/csv': 'csv',\n    'application/zip': 'zip',\n    'application/json': 'json'\n  };\n  return map[mime] || null;\n}\n\nfunction safeFilename(name) {\n  // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø§Ø³Ù… Ù…Ù† Ø§Ù„Ø±Ù…ÙˆØ² ØºÙŠØ± Ø§Ù„Ù…Ø³Ù…ÙˆØ­ Ø¨Ù‡Ø§\n  return String(name || '')\n    .replace(/[\\\\/:*?\"<>|]+/g, '_')\n    .replace(/\\s+/g, ' ')\n    .trim()\n    .slice(0, 120);\n}\n\nfunction ensureExt(name, extFallback) {\n  const hasExt = /\\.[a-z0-9]{1,6}$/i.test(name || '');\n  if (hasExt) return name;\n  const ext = extFallback ? `.${extFallback}` : '';\n  return `${name || 'document'}${ext}`;\n}\n// =============================\n\n// âœ… ÙˆØ³Ø§Ø¦Ø· - Ù†Ø­ÙØ¸ media_id ÙÙ‚Ø· (Ø§Ù„Ù…Ù„Ù ÙÙŠ Data Table)\nif (inItem.media_type && inItem.media_id) {\n  const mediaType = inItem.media_type;\n  \n  if (mediaType === 'image') {\n    text = 'ğŸ–¼ï¸ ØµÙˆØ±Ø©' + (inItem.media_caption ? ': ' + inItem.media_caption : '');\n    meta = { \n      kind: 'media', \n      type: 'image',\n      media_id: inItem.media_id,  // âœ… Ø§Ù„Ù…ÙØªØ§Ø­ ÙÙ‚Ø·\n      // âŒ Ø¨Ø¯ÙˆÙ† base64 - Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Data Table\n      caption: inItem.media_caption\n    };\n  } \n  else if (mediaType === 'video') {\n    text = 'ğŸ¥ ÙÙŠØ¯ÙŠÙˆ' + (inItem.media_caption ? ': ' + inItem.media_caption : '');\n    meta = { \n      kind: 'media', \n      type: 'video',\n      media_id: inItem.media_id,\n      caption: inItem.media_caption\n    };\n  }\n  else if (mediaType === 'audio') {\n    text = 'ğŸµ Ù…Ù„Ù ØµÙˆØªÙŠ';\n    meta = { \n      kind: 'media', \n      type: 'audio',\n      media_id: inItem.media_id\n    };\n  }\n  else if (mediaType === 'voice') {\n    text = 'ğŸ¤ Ø±Ø³Ø§Ù„Ø© ØµÙˆØªÙŠØ©';\n    meta = { \n      kind: 'media', \n      type: 'voice',\n      media_id: inItem.media_id\n    };\n  }\nelse if (mediaType === 'document') {\n  const mime = inItem.media_mime || inItem.media_mime_type; // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ØªØ§Ø­Ø© Ù…Ù† Ø§Ù„Ù…ØµØ¯Ø±\n  const extFromMime = inferExtFromMime(mime);\n  const baseName = safeFilename(inItem.media_filename || 'Ù…Ø³ØªÙ†Ø¯');\n  const finalName = ensureExt(baseName, extFromMime || 'bin');\n\n  text = 'ğŸ“„ ' + baseName;\n  meta = { \n    kind: 'media', \n    type: 'document',\n    media_id: inItem.media_id,\n    caption: inItem.media_caption,\n    filename: finalName,\n    mime_type: mime || null\n  };\n}\n}\n\n// Interactive\nif (inItem.interactive_reply && inItem.interactive_title) {\n  meta = { \n    kind: 'interactive', \n    title: inItem.interactive_title,\n    id: inItem.interactive_reply,\n    type: inItem.interactive_type\n  };\n  text = inItem.interactive_title || text;\n}\n\nconst msg = {\n  account, peer,\n  name: inItem.contact_name || peer,\n  dir: 'in',\n  text: text,\n  ts: Math.floor(Date.now()/1000),\n  business_phone: inItem.business_number || ''\n};\n\nif (meta) msg.meta = meta;\n\ng.messages.push(msg);\n\n// ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ù‚Ø¯ÙŠÙ… (Ø§Ù„Ø¢Ù† Ø¢Ù…Ù† - Ù…Ø§ ÙÙŠ Ù…Ù„ÙØ§Øª Ø«Ù‚ÙŠÙ„Ø©)\nif (g.messages.length > 5000) {\n  g.messages.splice(0, g.messages.length - 5000);\n}\n\n// Ø­ÙØ¸ Ø¬Ù‡Ø© Ø§Ù„Ø§ØªØµØ§Ù„\nif (!g.contacts[key]) {\n  g.contacts[key] = {\n    platform: 'whatsapp',\n    account,\n    peer,\n    name: inItem.contact_name || peer\n  };\n} else {\n  const gotName = inItem.contact_name;\n  if (gotName && (!g.contacts[key].name || g.contacts[key].name === peer)) {\n    g.contacts[key].name = gotName;\n  }\n}\n\nreturn [{ json: inItem }];"},"typeVersion":2},{"id":"98dc55ab-1a39-4c18-9c92-c848423f13ec","name":"Code in JavaScript2","type":"n8n-nodes-base.code","position":[-848,624],"parameters":{"jsCode":"// Ø§Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø© Ø¹Ù†Ø¯ ÙƒÙ„ Ø±Ø³Ø§Ù„Ø©/ÙƒØ¨Ø³Ø© Ø²Ø±\nconst inItem = $input.first().json;\nconst g = $getWorkflowStaticData('global');\n\n// Ù…ÙØªØ§Ø­ Ø§Ù„Ø¬Ù„Ø³Ø© = Ø§Ù„Ø­Ø³Ø§Ø¨:Ø§Ù„Ø±Ù‚Ù… (Ø£Ùˆ Ø§Ù„Ø±Ù‚Ù… Ø¥Ø°Ø§ Ù…Ø§ ØªÙˆÙØ± Ø§Ù„Ø­Ø³Ø§Ø¨)\nconst account = String(inItem.phone_number_id || '').trim();\nconst peer    = String(inItem.phone_number || '').trim();\nconst key = account && peer ? `${account}:${peer}` : (peer || 'unknown');\n\n// Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„ØªØ§Ù„ÙŠØ© = id Ø§Ù„Ø²Ø± Ø¥Ù† ÙˆÙØ¬Ø¯ØŒ ÙˆØ¥Ù„Ø§ \"typed_text\" Ø¥Ù† ÙÙŠÙ‡ Ù†Øµ\nconst nextState = inItem.interactive_reply\n  ? String(inItem.interactive_reply)\n  : (inItem.message_text ? 'typed_text' : 'unknown');\n\ng.sessions = g.sessions || {};\ng.sessions[key] = {\n  state: nextState,\n  name:  inItem.contact_name || 'Ø¹Ù…ÙŠÙ„',\n  phone: inItem.phone_number || '',\n  account,\n  updatedAt: Date.now()\n};\n\nreturn [{ json: { ...inItem, session_state: nextState, session_key: key } }];\n"},"typeVersion":2},{"id":"a345c961-8fc9-4880-a06b-bc78ba0726d5","name":"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø© (Ø¹Ø§Ù…)","type":"n8n-nodes-base.code","position":[528,336],"parameters":{"jsCode":"const g = $getWorkflowStaticData('global');\ng.messages = g.messages || [];\ng.contacts = g.contacts || {};\n\nconst it = $input.first().json;\nconst account = String(it.phone_number_id || '').trim();\nconst peer = String(it.phone_number || '').trim();\nconst out = it._outgoing || {};\n\nif (!account || !peer || !out.type) {\n  return [{ json: { logged:false, reason:'missing account/peer/_outgoing', ...it } }];\n}\n\nconst key = `${account}:${peer}`;\nconst name = it.contact_name || g.contacts[key]?.name || peer;\nif (!g.contacts[key]) g.contacts[key] = { platform:'whatsapp', peer, account, name };\nelse g.contacts[key].name = name || g.contacts[key].name;\n\n// ğŸ”¥ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ: Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ Ø§Ù„ÙØ¹Ù„ÙŠ Ù…Ù† payload\nlet displayText = '';\n\nif (out.type === 'text' && out.payload?.text?.body) {\n  // Ø±Ø³Ø§Ù„Ø© Ù†ØµÙŠØ© Ø¹Ø§Ø¯ÙŠØ©\n  displayText = out.payload.text.body;\n  \n} else if (out.type === 'interactive' && out.payload?.interactive) {\n  // Ø±Ø³Ø§Ù„Ø© Ù‚Ø§Ø¦Ù…Ø© ØªÙØ§Ø¹Ù„ÙŠØ©\n  const inter = out.payload.interactive;\n  \n  if (inter.body?.text) {\n    displayText = inter.body.text;\n  }\n  \n  // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ÙˆØ¬ÙˆØ¯Ø©\n  if (inter.action?.sections) {\n    displayText += '\\n\\nğŸ“‹ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©:';\n    inter.action.sections.forEach(section => {\n      if (section.rows) {\n        section.rows.forEach(row => {\n          displayText += `\\nâ€¢ ${row.title || row.id}`;\n        });\n      }\n    });\n  }\n  \n} else {\n  // Fallback Ù„Ù„Ù€ preview Ø¥Ø°Ø§ Ù„Ù… Ù†Ø³ØªØ·Ø¹ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ\n  displayText = out.preview || 'ğŸ“¤ ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø©';\n}\n\nconst msg = {\n  account, peer, name,\n  dir: 'out',\n  text: displayText,\n  ts: Math.floor(Date.now()/1000),\n  meta: { kind:'sent', type: out.type },\n  business_phone: it.business_number || ''\n};\n\ng.messages.push(msg);\nif (g.messages.length > 5000) g.messages.splice(0, g.messages.length - 5000);\n\nreturn [{ json: { logged:true, ...it } }];"},"typeVersion":2},{"id":"a7a5e592-dd4e-4bdf-b959-49a4ddbd81fc","name":"Ø­Ø¶Ù‘Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ â€“ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©","type":"n8n-nodes-base.code","position":[352,336],"parameters":{"jsCode":"// Ø­Ø¶Ù‘Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ â€“ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©\nconst j = $json;\n\nconst payload = {\n  messaging_product: \"whatsapp\",\n  to: j.phone_number,\n  type: \"interactive\",\n  interactive: {\n    type: \"list\",\n    body: {\n      text: \"Ù…Ø±Ø­Ø¨Ù‹Ø§ Ø¨Ùƒ ğŸ‘‹\\nØ£Ù†Ø§ Ø§Ù„Ø¨ÙˆØª Ø§Ù„Ø°ÙƒÙŠ Ù„Ù…ÙƒØªØ¨ ÙÙ‡Ø¯ Ù„Ù„Ø§Ø³ØªÙ‚Ø¯Ø§Ù… ğŸ¤–\\nØ³Ø£ÙƒÙˆÙ† Ù…Ø¹Ùƒ Ø®Ø·ÙˆØ© Ø¨Ø®Ø·ÙˆØ© Ù„Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ ÙÙŠ Ø£ÙŠ Ø§Ø³ØªÙØ³Ø§Ø± â¤ï¸â€ğŸ”¥\\n\\nğŸ“Œ ÙŠÙ…ÙƒÙ†Ùƒ Ø£ÙŠØ¶Ù‹Ø§ Ø²ÙŠØ§Ø±Ø© Ù…ÙˆÙ‚Ø¹Ù†Ø§ Ù„Ù„Ø§Ø³ØªÙØ§Ø¯Ø© Ù…Ù† Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„Ø­ØµØ±ÙŠØ©:\\nğŸŒ https://fahadrec.com\\n\\nØ§Ø®ØªØ± Ø§Ù„Ø®Ø¯Ù…Ø© Ø§Ù„ØªÙŠ ØªÙ†Ø§Ø³Ø¨Ùƒ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©:\"\n    },\n    footer: { text: \"Ù…ÙƒØªØ¨ ÙÙ‡Ø¯ Ù„Ù„Ø§Ø³ØªÙ‚Ø¯Ø§Ù…\" },\n    action: {\n      button: \"Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©\",\n      sections: [\n        {\n          title: \"Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©\",\n          rows: [\n            { id: \"m_prices\",         title: \"ğŸ’² Ø§Ù„Ø£Ø³Ø¹Ø§Ø±\",           description: \"Ø§Ù„Ø§Ø·Ù„Ø§Ø¹ Ø¹Ù„Ù‰ Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø§Ø³ØªÙ‚Ø¯Ø§Ù…\" },\n            { id: \"m_new_request\",    title: \"ğŸ“ ØªÙ‚Ø¯ÙŠÙ… Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯\",    description: \"ØªÙ‚Ø¯ÙŠÙ… Ø·Ù„Ø¨ Ø§Ø³ØªÙ‚Ø¯Ø§Ù… Ø¬Ø¯ÙŠØ¯\" },\n            { id: \"m_track_request\",  title: \"ğŸ” Ù…ØªØ§Ø¨Ø¹Ø© Ø·Ù„Ø¨ Ø³Ø§Ø¨Ù‚\",   description: \"Ù…ØªØ§Ø¨Ø¹Ø© Ø­Ø§Ù„Ø© Ø·Ù„Ø¨Ùƒ\" },\n            { id: \"m_transfer\",       title: \"ğŸ”„ Ù†Ù‚Ù„ Ø§Ù„Ø®Ø§Ø¯Ù…Ø§Øª\",      description: \"Ø·Ù„Ø¨ Ù†Ù‚Ù„ Ø®Ø§Ø¯Ù…Ø§Øª\" },\n            { id: \"m_translation\",    title: \"ğŸŒ Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø§Ù„ÙÙˆØ±ÙŠØ©\",   description: \"Ø®Ø¯Ù…Ø© Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø§Ù„ÙÙˆØ±ÙŠØ©\" },\n            { id: \"m_complaints\",     title: \"ğŸ› ï¸ Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰ ÙˆØ§Ù„Ø¯Ø¹Ù…\",    description: \"ØªÙ‚Ø¯ÙŠÙ… Ø´ÙƒÙˆÙ‰ Ø£Ùˆ Ø·Ù„Ø¨ Ø¯Ø¹Ù…\" },\n            { id: \"m_about\",          title: \"ğŸ¢ Ø¹Ù† Ø§Ù„Ù…ÙƒØªØ¨\",         description: \"Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¹Ù† Ø§Ù„Ù…ÙƒØªØ¨\" },\n            { id: \"m_talk_to_agent\",  title: \"ğŸ¤ Ø§Ù„ØªØ­Ø¯Ø« Ù…Ø¹ Ù…ÙˆØ¸Ù\",    description: \"Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø®Ø¯Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡\" }\n          ]\n        }\n      ]\n    }\n  }\n};\n\n// Ù†Ø¶ÙŠÙ ÙˆØµÙ Ù…Ø®ØªØµØ± Ù„Ù„Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯\nreturn [{\n  json: {\n    ...j,\n    _outgoing: {\n      type: \"interactive\",\n      preview: \"ğŸ“¤ ØªÙ… Ø¥Ø±Ø³Ø§Ù„: Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© (8 Ø®ÙŠØ§Ø±Ø§Øª)\",\n      payload\n    }\n  }\n}];\n"},"typeVersion":2},{"id":"a21a63b5-d408-4661-b4dc-100ab1cc9180","name":"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø©1","type":"n8n-nodes-base.code","position":[880,848],"parameters":{"jsCode":"const g = $getWorkflowStaticData('global');\ng.messages = g.messages || [];\ng.contacts = g.contacts || {};\n\nconst it = $input.first().json;\nconst account = String(it.phone_number_id || '').trim();\nconst peer = String(it.phone_number || '').trim();\nconst out = it._outgoing || {};\n\nif (!account || !peer || !out.type) {\n  return [{ json: { logged:false, reason:'missing account/peer/_outgoing', ...it } }];\n}\n\nconst key = `${account}:${peer}`;\nconst name = it.contact_name || g.contacts[key]?.name || peer;\nif (!g.contacts[key]) g.contacts[key] = { platform:'whatsapp', peer, account, name };\nelse g.contacts[key].name = name || g.contacts[key].name;\n\n// ğŸ”¥ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ: Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ Ø§Ù„ÙØ¹Ù„ÙŠ Ù…Ù† payload\nlet displayText = '';\n\nif (out.type === 'text' && out.payload?.text?.body) {\n  // Ø±Ø³Ø§Ù„Ø© Ù†ØµÙŠØ© Ø¹Ø§Ø¯ÙŠØ©\n  displayText = out.payload.text.body;\n  \n} else if (out.type === 'interactive' && out.payload?.interactive) {\n  // Ø±Ø³Ø§Ù„Ø© Ù‚Ø§Ø¦Ù…Ø© ØªÙØ§Ø¹Ù„ÙŠØ©\n  const inter = out.payload.interactive;\n  \n  if (inter.body?.text) {\n    displayText = inter.body.text;\n  }\n  \n  // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ÙˆØ¬ÙˆØ¯Ø©\n  if (inter.action?.sections) {\n    displayText += '\\n\\nğŸ“‹ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©:';\n    inter.action.sections.forEach(section => {\n      if (section.rows) {\n        section.rows.forEach(row => {\n          displayText += `\\nâ€¢ ${row.title || row.id}`;\n        });\n      }\n    });\n  }\n  \n} else {\n  // Fallback Ù„Ù„Ù€ preview Ø¥Ø°Ø§ Ù„Ù… Ù†Ø³ØªØ·Ø¹ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ\n  displayText = out.preview || 'ğŸ“¤ ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø©';\n}\n\nconst msg = {\n  account, peer, name,\n  dir: 'out',\n  text: displayText,\n  ts: Math.floor(Date.now()/1000),\n  meta: { kind:'sent', type: out.type },\n  business_phone: it.business_number || ''\n};\n\ng.messages.push(msg);\nif (g.messages.length > 5000) g.messages.splice(0, g.messages.length - 5000);\n\nreturn [{ json: { logged:true, ...it } }];"},"typeVersion":2},{"id":"a1b7350b-e9a6-4923-92f1-f2365884fa26","name":"Ø­Ø¶Ù‘Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ â€“ Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯","type":"n8n-nodes-base.code","position":[736,848],"parameters":{"jsCode":"const j = $json;\n\nconst payload = {\n  messaging_product: \"whatsapp\",\n  to: j.phone_number,\n  type: \"interactive\",\n  interactive: {\n    type: \"list\",\n    body: { text: \"ğŸ“ ØªÙ‚Ø¯ÙŠÙ… Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯\\nğŸŒ Ø§Ø®ØªØ± Ø§Ù„Ø¬Ù†Ø³ÙŠØ©:\" },\n    action: {\n      button: \"Ø§Ø®ØªØ± Ø§Ù„Ø¬Ù†Ø³ÙŠØ©\",\n      sections: [\n        {\n          title: \"Ø§Ù„Ø¬Ù†Ø³ÙŠØ§Øª\",\n          rows: [\n            { id: \"req_uganda\",      title: \"ğŸ‡ºğŸ‡¬ Ø£ÙˆØºÙ†Ø¯Ø§\" },\n            { id: \"req_ethiopia\",    title: \"ğŸ‡ªğŸ‡¹ Ø¥Ø«ÙŠÙˆØ¨ÙŠØ§\" },\n            { id: \"req_philippines\", title: \"ğŸ‡µğŸ‡­ Ø§Ù„ÙÙ„Ø¨ÙŠÙ†\" },\n            { id: \"req_burundi\",     title: \"ğŸ‡§ğŸ‡® Ø¨ÙˆØ±ÙˆÙ†Ø¯ÙŠ\" },\n            { id: \"req_bangladesh\",  title: \"ğŸ‡§ğŸ‡© Ø¨Ù†ØºÙ„Ø§Ø¯ÙŠØ´\" },\n            { id: \"req_kenya\",       title: \"ğŸ‡°ğŸ‡ª ÙƒÙŠÙ†ÙŠØ§\" }\n          ]\n        }\n      ]\n    }\n  }\n};\n\nreturn [{\n  json: {\n    ...j,\n    _outgoing: {\n      type: \"interactive\",\n      preview: \"ğŸ“¤ ØªÙ… Ø¥Ø±Ø³Ø§Ù„: Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ (Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ù†Ø³ÙŠØ§Øª)\",\n      payload\n    }\n  }\n}];\n"},"typeVersion":2},{"id":"d3d5c8e1-2a53-45c1-8df4-8f31a39d40c2","name":"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø©2","type":"n8n-nodes-base.code","position":[880,1488],"parameters":{"jsCode":"const g = $getWorkflowStaticData('global');\ng.messages = g.messages || [];\ng.contacts = g.contacts || {};\n\nconst it = $input.first().json;\nconst account = String(it.phone_number_id || '').trim();\nconst peer = String(it.phone_number || '').trim();\nconst out = it._outgoing || {};\n\nif (!account || !peer || !out.type) {\n  return [{ json: { logged:false, reason:'missing account/peer/_outgoing', ...it } }];\n}\n\nconst key = `${account}:${peer}`;\nconst name = it.contact_name || g.contacts[key]?.name || peer;\nif (!g.contacts[key]) g.contacts[key] = { platform:'whatsapp', peer, account, name };\nelse g.contacts[key].name = name || g.contacts[key].name;\n\n// ğŸ”¥ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ: Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ Ø§Ù„ÙØ¹Ù„ÙŠ Ù…Ù† payload\nlet displayText = '';\n\nif (out.type === 'text' && out.payload?.text?.body) {\n  // Ø±Ø³Ø§Ù„Ø© Ù†ØµÙŠØ© Ø¹Ø§Ø¯ÙŠØ©\n  displayText = out.payload.text.body;\n  \n} else if (out.type === 'interactive' && out.payload?.interactive) {\n  // Ø±Ø³Ø§Ù„Ø© Ù‚Ø§Ø¦Ù…Ø© ØªÙØ§Ø¹Ù„ÙŠØ©\n  const inter = out.payload.interactive;\n  \n  if (inter.body?.text) {\n    displayText = inter.body.text;\n  }\n  \n  // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ÙˆØ¬ÙˆØ¯Ø©\n  if (inter.action?.sections) {\n    displayText += '\\n\\nğŸ“‹ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©:';\n    inter.action.sections.forEach(section => {\n      if (section.rows) {\n        section.rows.forEach(row => {\n          displayText += `\\nâ€¢ ${row.title || row.id}`;\n        });\n      }\n    });\n  }\n  \n} else {\n  // Fallback Ù„Ù„Ù€ preview Ø¥Ø°Ø§ Ù„Ù… Ù†Ø³ØªØ·Ø¹ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ\n  displayText = out.preview || 'ğŸ“¤ ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø©';\n}\n\nconst msg = {\n  account, peer, name,\n  dir: 'out',\n  text: displayText,\n  ts: Math.floor(Date.now()/1000),\n  meta: { kind:'sent', type: out.type },\n  business_phone: it.business_number || ''\n};\n\ng.messages.push(msg);\nif (g.messages.length > 5000) g.messages.splice(0, g.messages.length - 5000);\n\nreturn [{ json: { logged:true, ...it } }];"},"typeVersion":2},{"id":"e36bd2d1-d61f-46a2-a11e-9842305a7b9f","name":"Ø­Ø¶Ù‘Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ â€“ Ø´ÙƒÙˆÙ‰","type":"n8n-nodes-base.code","position":[704,1488],"parameters":{"jsCode":"const j = $json;\n\nconst payload = {\n  messaging_product: \"whatsapp\",\n  to: j.phone_number,\n  type: \"interactive\",\n  interactive: {\n    type: \"list\",\n    body: { text: \"ğŸ› ï¸ Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰ ÙˆØ§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ\\n\\nØ§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø´ÙƒÙˆÙ‰:\" },\n    action: {\n      button: \"Ø§Ø®ØªØ± Ø§Ù„Ù†ÙˆØ¹\",\n      sections: [\n        {\n          title: \"Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰\",\n          rows: [\n            { id: \"complaint_worker\",    title: \"ğŸ  Ù…Ø´ÙƒÙ„Ø© Ù…Ø¹ Ø§Ù„Ø¹Ø§Ù…Ù„Ø©\" },\n            { id: \"complaint_service\",   title: \"ğŸ“‹ Ù…Ø´ÙƒÙ„Ø© ÙÙŠ Ø§Ù„Ø®Ø¯Ù…Ø©\" },\n            { id: \"complaint_delay\",     title: \"â° ØªØ£Ø®ÙŠØ± ÙÙŠ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª\" },\n            { id: \"complaint_financial\", title: \"ğŸ’° Ù…Ø´ÙƒÙ„Ø© Ù…Ø§Ù„ÙŠØ©\" },\n            { id: \"complaint_other\",     title: \"ğŸ“ Ø´ÙƒÙˆÙ‰ Ø£Ø®Ø±Ù‰\" }\n          ]\n        }\n      ]\n    }\n  }\n};\n\nreturn [{\n  json: {\n    ...j,\n    _outgoing: {\n      type: \"interactive\",\n      preview: \"ğŸ“¤ ØªÙ… Ø¥Ø±Ø³Ø§Ù„: Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰ (Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ù†ÙˆØ§Ø¹)\",\n      payload\n    }\n  }\n}];\n"},"typeVersion":2},{"id":"17dc3370-372c-419e-ba0c-f0e6ca9fc72c","name":"Ø­Ø¶Ù‘Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ â€“ Ø·Ù„Ø¨ Ù…ØªØ§Ø¨Ø¹Ø©","type":"n8n-nodes-base.code","position":[736,992],"parameters":{"jsCode":"// Ø­Ø¶Ù‘Ø± Ø±Ø³Ø§Ù„Ø© Ù†ØµÙ‘ÙŠØ© Ø­Ù‚ÙŠÙ‚ÙŠØ© (Ù…Ø´ Ø¨Ø³ preview)\nconst main = ($('sub route').item.json || {});\nif (!main.phone_number_id || !main.phone_number) {\n  throw new Error('missing phone_number_id/phone_number');\n}\n\nconst body = 'Ø§Ù†ØªØ¸Ø± Ù‚Ù„ÙŠÙ„Ø§Ù‹ Ø³ÙŠØªÙ… Ø§Ù„Ø±Ø¯ Ø¨Ø­Ø§Ù„Ø© Ø·Ù„Ø¨Ùƒ';\n\nreturn [{\n  json: {\n    ...$json,\n    phone_number: main.phone_number,\n    phone_number_id: main.phone_number_id,\n    _outgoing: {\n      type: \"text\",\n      preview: \"ğŸ“¤ ØªÙ… Ø¥Ø±Ø³Ø§Ù„: Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø·Ù„Ø¨ (Ø·Ù„Ø¨ Ø±Ù‚Ù…/Ø¹Ø±Ø¶ Ø­Ø§Ù„Ø©)\", // Ù„Ù„Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ ÙÙ‚Ø·\n      payload: {\n        messaging_product: \"whatsapp\",\n        to: main.phone_number,\n        type: \"text\",\n        text: { body }\n      }\n    }\n  }\n}];\n"},"typeVersion":2},{"id":"dc20acb5-d64e-4782-8a8c-760d11150704","name":"Ø­Ø¶Ù‘Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ â€“ Ø§Ù„ØªØ±Ø¬Ù…Ø©","type":"n8n-nodes-base.code","position":[720,1344],"parameters":{"jsCode":"const main = $('sub route').item.json;\n\nconst bodyText = `ğŸŒ Ø®Ø¯Ù…Ø© Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø§Ù„ÙÙˆØ±ÙŠØ©\n\nğŸ—£ï¸ Ø®Ø¯Ù…Ø© ØªØ±Ø¬Ù…Ø© Ù‡Ø§ØªÙÙŠØ© Ù…Ø¹ Ø¹Ø§Ù…Ù„ØªÙƒ Ø§Ù„Ù…Ù†Ø²Ù„ÙŠØ©:\n* Ø§ØªØµÙ„ Ø¨Ù†Ø§ ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø§Ù…Ù„Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù‡Ø§ØªÙ\n* Ù…ØªØ±Ø¬Ù…ÙˆÙ†Ø§ ÙŠØªØ±Ø¬Ù…ÙˆÙ† ÙƒÙ„Ø§Ù… Ø§Ù„Ø¹Ø§Ù…Ù„Ø© ÙÙˆØ±Ø§Ù‹\n* Ù†Ø´Ø±Ø­ Ù„Ùƒ Ù…Ø§ ØªØ±ÙŠØ¯Ù‡ Ø§Ù„Ø¹Ø§Ù…Ù„Ø©\n* Ù†ÙˆØ¶Ø­ Ù„Ù‡Ø§ ØªØ¹Ù„ÙŠÙ…Ø§ØªÙƒ ÙˆÙ…ØªØ·Ù„Ø¨Ø§ØªÙƒ\n* Ø­Ù„ Ø³Ø±ÙŠØ¹ Ù„Ù„Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„Ù„ØºÙˆÙŠØ©\n\nğŸŒ Ù…ØªÙˆÙØ± Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¬Ù†Ø³ÙŠØ§Øª:\nğŸ‡µğŸ‡­ Ø§Ù„ÙÙ„Ø¨ÙŠÙ† â€¢ ğŸ‡±ğŸ‡° Ø³Ø±ÙŠÙ„Ø§Ù†ÙƒØ§ â€¢ ğŸ‡§ğŸ‡© Ø¨Ù†Ø¬Ù„Ø§Ø¯ÙŠØ´ â€¢ ğŸ‡°ğŸ‡ª ÙƒÙŠÙ†ÙŠØ§\nğŸ‡ºğŸ‡¬ Ø£ÙˆØºÙ†Ø¯Ø§ â€¢ ğŸ‡ªğŸ‡¹ Ø¥Ø«ÙŠÙˆØ¨ÙŠØ§ â€¢ ğŸ‡§ğŸ‡® Ø¨ÙˆØ±ÙˆÙ†Ø¯ÙŠ â€¢ ğŸ‡®ğŸ‡³ Ø§Ù„Ù‡Ù†Ø¯\n\nğŸ“ Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø¯Ù…Ø©:\nhttps://wa.me/966501417950\n\nğŸ• Ù…ØªØ§Ø­ Ø·ÙˆØ§Ù„ Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¹Ù…Ù„\nØ§Ù„Ø³Ø¨Øª - Ø§Ù„Ø®Ù…ÙŠØ³: 8Øµ - 10Ù…`;\n\nconst payload = {\n  messaging_product: \"whatsapp\",\n  to: main.phone_number,\n  type: \"text\",\n  text: { body: bodyText }\n};\n\nreturn [{\n  json: {\n    ...$json,\n    phone_number: main.phone_number,\n    phone_number_id: main.phone_number_id,\n    contact_name: main.contact_name,\n    _outgoing: {\n      type: \"text\",\n      preview: \"ğŸ“¤ ØªÙ… Ø¥Ø±Ø³Ø§Ù„: Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø§Ù„ÙÙˆØ±ÙŠØ©\",\n      payload\n    }\n  }\n}];"},"typeVersion":2},{"id":"5bc9a8cb-b889-40bf-a72e-32c4ecb4e5e9","name":"Ø­Ø¶Ù‘Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ â€“ Ù„Ø§Ù„Ù…ÙƒØªØ¨","type":"n8n-nodes-base.code","position":[736,1648],"parameters":{"jsCode":"const main = $('sub route').item.json;\n\nconst bodyText = `ğŸ¢ Ù…ÙƒØªØ¨ ÙÙ‡Ø¯ Ù„Ù„Ø§Ø³ØªÙ‚Ø¯Ø§Ù…\n\nâœ… Ù…ÙƒØªØ¨ Ù…Ø¹ØªÙ…Ø¯ ÙˆÙ…Ø±Ø®Øµ Ù…Ù† Ù…Ø³Ø§Ù†Ø¯ ÙˆÙˆØ²Ø§Ø±Ø© Ø§Ù„Ø¹Ù…Ù„\n\nğŸŒ Ù†Ø³ØªÙ‚Ø¯Ù… Ø§Ù„Ø¹Ù…Ø§Ù„Ø© Ø§Ù„Ù…Ù†Ø²Ù„ÙŠØ© Ù…Ù† Ø§Ù„Ø¬Ù†Ø³ÙŠØ§Øª Ø§Ù„ØªØ§Ù„ÙŠØ©:\n1- Ø§Ù„ÙÙ„Ø¨ÙŠÙ† ğŸ‡µğŸ‡­ 12,999 SAR\n2- Ø³Ø±ÙŠÙ„Ø§Ù†ÙƒØ§ ğŸ‡±ğŸ‡° 14,700 SAR\n3- Ø¨Ù†Ø¬Ù„Ø§Ø¯ÙŠØ´ ğŸ‡§ğŸ‡© 7,900 SAR\n4- ÙƒÙŠÙ†ÙŠØ§ ğŸ‡°ğŸ‡ª 6,400 SAR\n5- Ø£ÙˆØºÙ†Ø¯Ø§ ğŸ‡ºğŸ‡¬ 4,900 SAR\n6- Ø¥Ø«ÙŠÙˆØ¨ÙŠØ§ ğŸ‡ªğŸ‡¹ 4,490 SAR\n7- Ø¨ÙˆØ±ÙˆÙ†Ø¯ÙŠ ğŸ‡§ğŸ‡® 5,900 SAR\n8- Ø§Ù„Ù‡Ù†Ø¯ ğŸ‡®ğŸ‡³ 3,000 SAR\n\nğŸ›¡ï¸ ÙŠÙˆØ¬Ø¯ ØªØ£Ù…ÙŠÙ† Ù„Ù…Ø¯Ø© Ø³Ù†ØªÙŠÙ† Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù…Ø§Ù„Ø© Ø§Ù„Ù…Ù†Ø²Ù„ÙŠØ© ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„Ù‡Ø±ÙˆØ¨ Ø£Ùˆ Ø±ÙØ¶ Ø§Ù„Ø¹Ù…Ù„.\n\nğŸ“ Ù„Ù„ØªÙˆØ§ØµÙ„ ÙˆØ§Ù„Ø§Ø³ØªÙØ³Ø§Ø±:\nâ˜ï¸ 0112333325\n\nğŸŒ fahadrec.com`;\n\nconst payload = {\n  messaging_product: \"whatsapp\",\n  to: main.phone_number,\n  type: \"text\",\n  text: { body: bodyText }\n};\n\nreturn [{\n  json: {\n    ...$json,\n    phone_number: main.phone_number,\n    phone_number_id: main.phone_number_id,\n    contact_name: main.contact_name,\n    _outgoing: {\n      type: \"text\",\n      preview: \"ğŸ“¤ ØªÙ… Ø¥Ø±Ø³Ø§Ù„: Ø¹Ù† Ø§Ù„Ù…ÙƒØªØ¨\",\n      payload\n    }\n  }\n}];"},"typeVersion":2},{"id":"c8332661-0e78-4d23-b4e0-574734618044","name":"Ø­Ø¶Ù‘Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ â€“ Ù†Ù‚Ù„ Ø§Ù„Ø®Ø§Ø¯Ù…Ø§Øª","type":"n8n-nodes-base.code","position":[720,1168],"parameters":{"jsCode":"const main = $('sub route').item.json;\n\nconst bodyText = `ğŸ”— Ø±Ø§Ø¨Ø· Ù†Ù‚Ù„ Ø§Ù„Ø®Ø§Ø¯Ù…Ø§Øª:\nhttps://fahadrec.com/workers/filter/tax/service-type:transfer-services/\n\nğŸ’¡ Ø³ÙŠØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø²ÙŠØ§Ø±ØªÙƒ Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù‡ØªÙ…Ø§Ù…Ùƒ`;\n\nconst payload = {\n  messaging_product: \"whatsapp\",\n  to: main.phone_number,\n  type: \"text\",\n  text: { body: bodyText }\n};\n\nreturn [{\n  json: {\n    ...$json,\n    phone_number: main.phone_number,\n    phone_number_id: main.phone_number_id,\n    contact_name: main.contact_name,\n    _outgoing: {\n      type: \"text\",\n      preview: \"ğŸ“¤ ØªÙ… Ø¥Ø±Ø³Ø§Ù„: Ø±Ø§Ø¨Ø· Ù†Ù‚Ù„ Ø§Ù„Ø®Ø§Ø¯Ù…Ø§Øª\",\n      payload\n    }\n  }\n}];"},"typeVersion":2},{"id":"e269c4f8-3cde-4a43-b816-df79dcd3b703","name":"Ø­Ø¶Ù‘Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ â€“ Ø´ÙƒÙˆÙ‰ ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„","type":"n8n-nodes-base.code","position":[1696,1600],"parameters":{"jsCode":"const main = $('sub route').item.json;\nconst data = $('Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª').item.json;\n\nconst bodyText = `âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø´ÙƒÙˆÙ‰ Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ Ø¨Ù†Ø¬Ø§Ø­.\n\nğŸ“Œ Ù†ÙˆØ¹ Ø§Ù„Ø´ÙƒÙˆÙ‰: ${data.interactive_title}\n\nÙØ±ÙŠÙ‚ Ø§Ù„Ø¯Ø¹Ù… Ø³ÙŠØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ Ù‚Ø±ÙŠØ¨Ù‹Ø§ Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù…Ø´ÙƒÙ„Ø© ğŸ™`;\n\nconst payload = {\n  messaging_product: \"whatsapp\",\n  to: data.phone_number,\n  type: \"text\",\n  text: { body: bodyText }\n};\n\nreturn [{\n  json: {\n    ...$json,\n    phone_number: data.phone_number,\n    phone_number_id: data.phone_number_id,\n    contact_name: data.contact_name,\n    interactive_title: data.interactive_title,\n    _outgoing: {\n      type: \"text\",\n      preview: `ğŸ“¤ ØªÙ… Ø¥Ø±Ø³Ø§Ù„: ØªØ£ÙƒÙŠØ¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø´ÙƒÙˆÙ‰ (${data.interactive_title || ''})`,\n      payload\n    }\n  }\n}];"},"typeVersion":2},{"id":"1f886e08-97d3-4cb1-b9dd-c6a7e1ebc784","name":"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø©3","type":"n8n-nodes-base.code","position":[1856,1600],"parameters":{"jsCode":"const g = $getWorkflowStaticData('global');\ng.messages = g.messages || [];\ng.contacts = g.contacts || {};\n\nconst it = $input.first().json;\nconst account = String(it.phone_number_id || '').trim();\nconst peer = String(it.phone_number || '').trim();\nconst out = it._outgoing || {};\n\nif (!account || !peer || !out.type) {\n  return [{ json: { logged:false, reason:'missing account/peer/_outgoing', ...it } }];\n}\n\nconst key = `${account}:${peer}`;\nconst name = it.contact_name || g.contacts[key]?.name || peer;\nif (!g.contacts[key]) g.contacts[key] = { platform:'whatsapp', peer, account, name };\nelse g.contacts[key].name = name || g.contacts[key].name;\n\n// ğŸ”¥ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ: Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ Ø§Ù„ÙØ¹Ù„ÙŠ Ù…Ù† payload\nlet displayText = '';\n\nif (out.type === 'text' && out.payload?.text?.body) {\n  // Ø±Ø³Ø§Ù„Ø© Ù†ØµÙŠØ© Ø¹Ø§Ø¯ÙŠØ©\n  displayText = out.payload.text.body;\n  \n} else if (out.type === 'interactive' && out.payload?.interactive) {\n  // Ø±Ø³Ø§Ù„Ø© Ù‚Ø§Ø¦Ù…Ø© ØªÙØ§Ø¹Ù„ÙŠØ©\n  const inter = out.payload.interactive;\n  \n  if (inter.body?.text) {\n    displayText = inter.body.text;\n  }\n  \n  // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ÙˆØ¬ÙˆØ¯Ø©\n  if (inter.action?.sections) {\n    displayText += '\\n\\nğŸ“‹ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©:';\n    inter.action.sections.forEach(section => {\n      if (section.rows) {\n        section.rows.forEach(row => {\n          displayText += `\\nâ€¢ ${row.title || row.id}`;\n        });\n      }\n    });\n  }\n  \n} else {\n  // Fallback Ù„Ù„Ù€ preview Ø¥Ø°Ø§ Ù„Ù… Ù†Ø³ØªØ·Ø¹ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ\n  displayText = out.preview || 'ğŸ“¤ ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø©';\n}\n\nconst msg = {\n  account, peer, name,\n  dir: 'out',\n  text: displayText,\n  ts: Math.floor(Date.now()/1000),\n  meta: { kind:'sent', type: out.type },\n  business_phone: it.business_number || ''\n};\n\ng.messages.push(msg);\nif (g.messages.length > 5000) g.messages.splice(0, g.messages.length - 5000);\n\nreturn [{ json: { logged:true, ...it } }];"},"typeVersion":2},{"id":"0964c928-ad49-4765-a37a-c882d517c44e","name":"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø©4","type":"n8n-nodes-base.code","position":[2032,144],"parameters":{"jsCode":"const g = $getWorkflowStaticData('global');\ng.messages = g.messages || [];\ng.contacts = g.contacts || {};\n\nconst it = $input.first().json;\nconst account = String(it.phone_number_id || '').trim();\nconst peer = String(it.phone_number || '').trim();\nconst out = it._outgoing || {};\n\nif (!account || !peer || !out.type) {\n  return [{ json: { logged:false, reason:'missing account/peer/_outgoing', ...it } }];\n}\n\nconst key = `${account}:${peer}`;\nconst name = it.contact_name || g.contacts[key]?.name || peer;\nif (!g.contacts[key]) g.contacts[key] = { platform:'whatsapp', peer, account, name };\nelse g.contacts[key].name = name || g.contacts[key].name;\n\n// ğŸ”¥ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ: Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ Ø§Ù„ÙØ¹Ù„ÙŠ Ù…Ù† payload\nlet displayText = '';\n\nif (out.type === 'text' && out.payload?.text?.body) {\n  // Ø±Ø³Ø§Ù„Ø© Ù†ØµÙŠØ© Ø¹Ø§Ø¯ÙŠØ©\n  displayText = out.payload.text.body;\n  \n} else if (out.type === 'interactive' && out.payload?.interactive) {\n  // Ø±Ø³Ø§Ù„Ø© Ù‚Ø§Ø¦Ù…Ø© ØªÙØ§Ø¹Ù„ÙŠØ©\n  const inter = out.payload.interactive;\n  \n  if (inter.body?.text) {\n    displayText = inter.body.text;\n  }\n  \n  // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ÙˆØ¬ÙˆØ¯Ø©\n  if (inter.action?.sections) {\n    displayText += '\\n\\nğŸ“‹ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©:';\n    inter.action.sections.forEach(section => {\n      if (section.rows) {\n        section.rows.forEach(row => {\n          displayText += `\\nâ€¢ ${row.title || row.id}`;\n        });\n      }\n    });\n  }\n  \n} else {\n  // Fallback Ù„Ù„Ù€ preview Ø¥Ø°Ø§ Ù„Ù… Ù†Ø³ØªØ·Ø¹ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ\n  displayText = out.preview || 'ğŸ“¤ ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø©';\n}\n\nconst msg = {\n  account, peer, name,\n  dir: 'out',\n  text: displayText,\n  ts: Math.floor(Date.now()/1000),\n  meta: { kind:'sent', type: out.type },\n  business_phone: it.business_number || ''\n};\n\ng.messages.push(msg);\nif (g.messages.length > 5000) g.messages.splice(0, g.messages.length - 5000);\n\nreturn [{ json: { logged:true, ...it } }];"},"typeVersion":2},{"id":"98db7671-98f3-4c69-b1e4-fcc362e87d5e","name":"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø©5","type":"n8n-nodes-base.code","position":[880,992],"parameters":{"jsCode":"const g = $getWorkflowStaticData('global');\ng.messages = g.messages || [];\ng.contacts = g.contacts || {};\n\nconst it = $input.first().json;\nconst account = String(it.phone_number_id || '').trim();\nconst peer = String(it.phone_number || '').trim();\nconst out = it._outgoing || {};\n\nif (!account || !peer || !out.type) {\n  return [{ json: { logged:false, reason:'missing account/peer/_outgoing', ...it } }];\n}\n\nconst key = `${account}:${peer}`;\nconst name = it.contact_name || g.contacts[key]?.name || peer;\nif (!g.contacts[key]) g.contacts[key] = { platform:'whatsapp', peer, account, name };\nelse g.contacts[key].name = name || g.contacts[key].name;\n\n// ğŸ”¥ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ: Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ Ø§Ù„ÙØ¹Ù„ÙŠ Ù…Ù† payload\nlet displayText = '';\n\nif (out.type === 'text' && out.payload?.text?.body) {\n  // Ø±Ø³Ø§Ù„Ø© Ù†ØµÙŠØ© Ø¹Ø§Ø¯ÙŠØ©\n  displayText = out.payload.text.body;\n  \n} else if (out.type === 'interactive' && out.payload?.interactive) {\n  // Ø±Ø³Ø§Ù„Ø© Ù‚Ø§Ø¦Ù…Ø© ØªÙØ§Ø¹Ù„ÙŠØ©\n  const inter = out.payload.interactive;\n  \n  if (inter.body?.text) {\n    displayText = inter.body.text;\n  }\n  \n  // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ÙˆØ¬ÙˆØ¯Ø©\n  if (inter.action?.sections) {\n    displayText += '\\n\\nğŸ“‹ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©:';\n    inter.action.sections.forEach(section => {\n      if (section.rows) {\n        section.rows.forEach(row => {\n          displayText += `\\nâ€¢ ${row.title || row.id}`;\n        });\n      }\n    });\n  }\n  \n} else {\n  // Fallback Ù„Ù„Ù€ preview Ø¥Ø°Ø§ Ù„Ù… Ù†Ø³ØªØ·Ø¹ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ\n  displayText = out.preview || 'ğŸ“¤ ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø©';\n}\n\nconst msg = {\n  account, peer, name,\n  dir: 'out',\n  text: displayText,\n  ts: Math.floor(Date.now()/1000),\n  meta: { kind:'sent', type: out.type },\n  business_phone: it.business_number || ''\n};\n\ng.messages.push(msg);\nif (g.messages.length > 5000) g.messages.splice(0, g.messages.length - 5000);\n\nreturn [{ json: { logged:true, ...it } }];"},"typeVersion":2},{"id":"aec8b2a9-0dab-4557-8c94-aabc38b8227c","name":"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø©6","type":"n8n-nodes-base.code","position":[880,1168],"parameters":{"jsCode":"const g = $getWorkflowStaticData('global');\ng.messages = g.messages || [];\ng.contacts = g.contacts || {};\n\nconst it = $input.first().json;\nconst account = String(it.phone_number_id || '').trim();\nconst peer = String(it.phone_number || '').trim();\nconst out = it._outgoing || {};\n\nif (!account || !peer || !out.type) {\n  return [{ json: { logged:false, reason:'missing account/peer/_outgoing', ...it } }];\n}\n\nconst key = `${account}:${peer}`;\nconst name = it.contact_name || g.contacts[key]?.name || peer;\nif (!g.contacts[key]) g.contacts[key] = { platform:'whatsapp', peer, account, name };\nelse g.contacts[key].name = name || g.contacts[key].name;\n\n// ğŸ”¥ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ: Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ Ø§Ù„ÙØ¹Ù„ÙŠ Ù…Ù† payload\nlet displayText = '';\n\nif (out.type === 'text' && out.payload?.text?.body) {\n  // Ø±Ø³Ø§Ù„Ø© Ù†ØµÙŠØ© Ø¹Ø§Ø¯ÙŠØ©\n  displayText = out.payload.text.body;\n  \n} else if (out.type === 'interactive' && out.payload?.interactive) {\n  // Ø±Ø³Ø§Ù„Ø© Ù‚Ø§Ø¦Ù…Ø© ØªÙØ§Ø¹Ù„ÙŠØ©\n  const inter = out.payload.interactive;\n  \n  if (inter.body?.text) {\n    displayText = inter.body.text;\n  }\n  \n  // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ÙˆØ¬ÙˆØ¯Ø©\n  if (inter.action?.sections) {\n    displayText += '\\n\\nğŸ“‹ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©:';\n    inter.action.sections.forEach(section => {\n      if (section.rows) {\n        section.rows.forEach(row => {\n          displayText += `\\nâ€¢ ${row.title || row.id}`;\n        });\n      }\n    });\n  }\n  \n} else {\n  // Fallback Ù„Ù„Ù€ preview Ø¥Ø°Ø§ Ù„Ù… Ù†Ø³ØªØ·Ø¹ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ\n  displayText = out.preview || 'ğŸ“¤ ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø©';\n}\n\nconst msg = {\n  account, peer, name,\n  dir: 'out',\n  text: displayText,\n  ts: Math.floor(Date.now()/1000),\n  meta: { kind:'sent', type: out.type },\n  business_phone: it.business_number || ''\n};\n\ng.messages.push(msg);\nif (g.messages.length > 5000) g.messages.splice(0, g.messages.length - 5000);\n\nreturn [{ json: { logged:true, ...it } }];"},"typeVersion":2},{"id":"25716894-6cf2-4e1f-9510-4066b5c9c2a7","name":"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø©7","type":"n8n-nodes-base.code","position":[880,1344],"parameters":{"jsCode":"const g = $getWorkflowStaticData('global');\ng.messages = g.messages || [];\ng.contacts = g.contacts || {};\n\nconst it = $input.first().json;\nconst account = String(it.phone_number_id || '').trim();\nconst peer = String(it.phone_number || '').trim();\nconst out = it._outgoing || {};\n\nif (!account || !peer || !out.type) {\n  return [{ json: { logged:false, reason:'missing account/peer/_outgoing', ...it } }];\n}\n\nconst key = `${account}:${peer}`;\nconst name = it.contact_name || g.contacts[key]?.name || peer;\nif (!g.contacts[key]) g.contacts[key] = { platform:'whatsapp', peer, account, name };\nelse g.contacts[key].name = name || g.contacts[key].name;\n\n// ğŸ”¥ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ: Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ Ø§Ù„ÙØ¹Ù„ÙŠ Ù…Ù† payload\nlet displayText = '';\n\nif (out.type === 'text' && out.payload?.text?.body) {\n  // Ø±Ø³Ø§Ù„Ø© Ù†ØµÙŠØ© Ø¹Ø§Ø¯ÙŠØ©\n  displayText = out.payload.text.body;\n  \n} else if (out.type === 'interactive' && out.payload?.interactive) {\n  // Ø±Ø³Ø§Ù„Ø© Ù‚Ø§Ø¦Ù…Ø© ØªÙØ§Ø¹Ù„ÙŠØ©\n  const inter = out.payload.interactive;\n  \n  if (inter.body?.text) {\n    displayText = inter.body.text;\n  }\n  \n  // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ÙˆØ¬ÙˆØ¯Ø©\n  if (inter.action?.sections) {\n    displayText += '\\n\\nğŸ“‹ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©:';\n    inter.action.sections.forEach(section => {\n      if (section.rows) {\n        section.rows.forEach(row => {\n          displayText += `\\nâ€¢ ${row.title || row.id}`;\n        });\n      }\n    });\n  }\n  \n} else {\n  // Fallback Ù„Ù„Ù€ preview Ø¥Ø°Ø§ Ù„Ù… Ù†Ø³ØªØ·Ø¹ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ\n  displayText = out.preview || 'ğŸ“¤ ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø©';\n}\n\nconst msg = {\n  account, peer, name,\n  dir: 'out',\n  text: displayText,\n  ts: Math.floor(Date.now()/1000),\n  meta: { kind:'sent', type: out.type },\n  business_phone: it.business_number || ''\n};\n\ng.messages.push(msg);\nif (g.messages.length > 5000) g.messages.splice(0, g.messages.length - 5000);\n\nreturn [{ json: { logged:true, ...it } }];"},"typeVersion":2},{"id":"1f839807-5524-4f66-a527-5e385df64687","name":"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø©8","type":"n8n-nodes-base.code","position":[880,1648],"parameters":{"jsCode":"const g = $getWorkflowStaticData('global');\ng.messages = g.messages || [];\ng.contacts = g.contacts || {};\n\nconst it = $input.first().json;\nconst account = String(it.phone_number_id || '').trim();\nconst peer = String(it.phone_number || '').trim();\nconst out = it._outgoing || {};\n\nif (!account || !peer || !out.type) {\n  return [{ json: { logged:false, reason:'missing account/peer/_outgoing', ...it } }];\n}\n\nconst key = `${account}:${peer}`;\nconst name = it.contact_name || g.contacts[key]?.name || peer;\nif (!g.contacts[key]) g.contacts[key] = { platform:'whatsapp', peer, account, name };\nelse g.contacts[key].name = name || g.contacts[key].name;\n\n// ğŸ”¥ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ: Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ Ø§Ù„ÙØ¹Ù„ÙŠ Ù…Ù† payload\nlet displayText = '';\n\nif (out.type === 'text' && out.payload?.text?.body) {\n  // Ø±Ø³Ø§Ù„Ø© Ù†ØµÙŠØ© Ø¹Ø§Ø¯ÙŠØ©\n  displayText = out.payload.text.body;\n  \n} else if (out.type === 'interactive' && out.payload?.interactive) {\n  // Ø±Ø³Ø§Ù„Ø© Ù‚Ø§Ø¦Ù…Ø© ØªÙØ§Ø¹Ù„ÙŠØ©\n  const inter = out.payload.interactive;\n  \n  if (inter.body?.text) {\n    displayText = inter.body.text;\n  }\n  \n  // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ÙˆØ¬ÙˆØ¯Ø©\n  if (inter.action?.sections) {\n    displayText += '\\n\\nğŸ“‹ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©:';\n    inter.action.sections.forEach(section => {\n      if (section.rows) {\n        section.rows.forEach(row => {\n          displayText += `\\nâ€¢ ${row.title || row.id}`;\n        });\n      }\n    });\n  }\n  \n} else {\n  // Fallback Ù„Ù„Ù€ preview Ø¥Ø°Ø§ Ù„Ù… Ù†Ø³ØªØ·Ø¹ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ\n  displayText = out.preview || 'ğŸ“¤ ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø©';\n}\n\nconst msg = {\n  account, peer, name,\n  dir: 'out',\n  text: displayText,\n  ts: Math.floor(Date.now()/1000),\n  meta: { kind:'sent', type: out.type },\n  business_phone: it.business_number || ''\n};\n\ng.messages.push(msg);\nif (g.messages.length > 5000) g.messages.splice(0, g.messages.length - 5000);\n\nreturn [{ json: { logged:true, ...it } }];"},"typeVersion":2},{"id":"cd04a734-ec52-48a5-bde7-41645b0c5898","name":"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø©9","type":"n8n-nodes-base.code","position":[880,1792],"parameters":{"jsCode":"const g = $getWorkflowStaticData('global');\ng.messages = g.messages || [];\ng.contacts = g.contacts || {};\n\nconst it = $input.first().json;\nconst account = String(it.phone_number_id || '').trim();\nconst peer = String(it.phone_number || '').trim();\nconst out = it._outgoing || {};\n\nif (!account || !peer || !out.type) {\n  return [{ json: { logged:false, reason:'missing account/peer/_outgoing', ...it } }];\n}\n\nconst key = `${account}:${peer}`;\nconst name = it.contact_name || g.contacts[key]?.name || peer;\nif (!g.contacts[key]) g.contacts[key] = { platform:'whatsapp', peer, account, name };\nelse g.contacts[key].name = name || g.contacts[key].name;\n\n// ğŸ”¥ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ: Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ Ø§Ù„ÙØ¹Ù„ÙŠ Ù…Ù† payload\nlet displayText = '';\n\nif (out.type === 'text' && out.payload?.text?.body) {\n  // Ø±Ø³Ø§Ù„Ø© Ù†ØµÙŠØ© Ø¹Ø§Ø¯ÙŠØ©\n  displayText = out.payload.text.body;\n  \n} else if (out.type === 'interactive' && out.payload?.interactive) {\n  // Ø±Ø³Ø§Ù„Ø© Ù‚Ø§Ø¦Ù…Ø© ØªÙØ§Ø¹Ù„ÙŠØ©\n  const inter = out.payload.interactive;\n  \n  if (inter.body?.text) {\n    displayText = inter.body.text;\n  }\n  \n  // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ÙˆØ¬ÙˆØ¯Ø©\n  if (inter.action?.sections) {\n    displayText += '\\n\\nğŸ“‹ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©:';\n    inter.action.sections.forEach(section => {\n      if (section.rows) {\n        section.rows.forEach(row => {\n          displayText += `\\nâ€¢ ${row.title || row.id}`;\n        });\n      }\n    });\n  }\n  \n} else {\n  // Fallback Ù„Ù„Ù€ preview Ø¥Ø°Ø§ Ù„Ù… Ù†Ø³ØªØ·Ø¹ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ\n  displayText = out.preview || 'ğŸ“¤ ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø©';\n}\n\nconst msg = {\n  account, peer, name,\n  dir: 'out',\n  text: displayText,\n  ts: Math.floor(Date.now()/1000),\n  meta: { kind:'sent', type: out.type },\n  business_phone: it.business_number || ''\n};\n\ng.messages.push(msg);\nif (g.messages.length > 5000) g.messages.splice(0, g.messages.length - 5000);\n\nreturn [{ json: { logged:true, ...it } }];"},"typeVersion":2},{"id":"c93b47e9-21dd-4c47-8543-7aacedac7e5f","name":"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø©10","type":"n8n-nodes-base.code","position":[2736,400],"parameters":{"jsCode":"const g = $getWorkflowStaticData('global');\ng.messages = g.messages || [];\ng.contacts = g.contacts || {};\n\nconst it = $input.first().json;\nconst account = String(it.phone_number_id || '').trim();\nconst peer = String(it.phone_number || '').trim();\nconst out = it._outgoing || {};\n\nif (!account || !peer || !out.type) {\n  return [{ json: { logged:false, reason:'missing account/peer/_outgoing', ...it } }];\n}\n\nconst key = `${account}:${peer}`;\nconst name = it.contact_name || g.contacts[key]?.name || peer;\nif (!g.contacts[key]) g.contacts[key] = { platform:'whatsapp', peer, account, name };\nelse g.contacts[key].name = name || g.contacts[key].name;\n\n// ğŸ”¥ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ: Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ Ø§Ù„ÙØ¹Ù„ÙŠ Ù…Ù† payload\nlet displayText = '';\n\nif (out.type === 'text' && out.payload?.text?.body) {\n  // Ø±Ø³Ø§Ù„Ø© Ù†ØµÙŠØ© Ø¹Ø§Ø¯ÙŠØ©\n  displayText = out.payload.text.body;\n  \n} else if (out.type === 'interactive' && out.payload?.interactive) {\n  // Ø±Ø³Ø§Ù„Ø© Ù‚Ø§Ø¦Ù…Ø© ØªÙØ§Ø¹Ù„ÙŠØ©\n  const inter = out.payload.interactive;\n  \n  if (inter.body?.text) {\n    displayText = inter.body.text;\n  }\n  \n  // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ÙˆØ¬ÙˆØ¯Ø©\n  if (inter.action?.sections) {\n    displayText += '\\n\\nğŸ“‹ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©:';\n    inter.action.sections.forEach(section => {\n      if (section.rows) {\n        section.rows.forEach(row => {\n          displayText += `\\nâ€¢ ${row.title || row.id}`;\n        });\n      }\n    });\n  }\n  \n} else {\n  // Fallback Ù„Ù„Ù€ preview Ø¥Ø°Ø§ Ù„Ù… Ù†Ø³ØªØ·Ø¹ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ\n  displayText = out.preview || 'ğŸ“¤ ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø©';\n}\n\nconst msg = {\n  account, peer, name,\n  dir: 'out',\n  text: displayText,\n  ts: Math.floor(Date.now()/1000),\n  meta: { kind:'sent', type: out.type },\n  business_phone: it.business_number || ''\n};\n\ng.messages.push(msg);\nif (g.messages.length > 5000) g.messages.splice(0, g.messages.length - 5000);\n\nreturn [{ json: { logged:true, ...it } }];"},"typeVersion":2},{"id":"53bfdbe1-1e6f-4f33-a78d-cb68b635bd39","name":"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø©13","type":"n8n-nodes-base.code","position":[2368,1328],"parameters":{"jsCode":"const g = $getWorkflowStaticData('global');\ng.messages = g.messages || [];\ng.contacts = g.contacts || {};\n\nconst it = $input.first().json;\nconst account = String(it.phone_number_id || '').trim();\nconst peer = String(it.phone_number || '').trim();\nconst out = it._outgoing || {};\n\nif (!account || !peer || !out.type) {\n  return [{ json: { logged:false, reason:'missing account/peer/_outgoing', ...it } }];\n}\n\nconst key = `${account}:${peer}`;\nconst name = it.contact_name || g.contacts[key]?.name || peer;\nif (!g.contacts[key]) g.contacts[key] = { platform:'whatsapp', peer, account, name };\nelse g.contacts[key].name = name || g.contacts[key].name;\n\n// ğŸ”¥ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ: Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ Ø§Ù„ÙØ¹Ù„ÙŠ Ù…Ù† payload\nlet displayText = '';\n\nif (out.type === 'text' && out.payload?.text?.body) {\n  // Ø±Ø³Ø§Ù„Ø© Ù†ØµÙŠØ© Ø¹Ø§Ø¯ÙŠØ©\n  displayText = out.payload.text.body;\n  \n} else if (out.type === 'interactive' && out.payload?.interactive) {\n  // Ø±Ø³Ø§Ù„Ø© Ù‚Ø§Ø¦Ù…Ø© ØªÙØ§Ø¹Ù„ÙŠØ©\n  const inter = out.payload.interactive;\n  \n  if (inter.body?.text) {\n    displayText = inter.body.text;\n  }\n  \n  // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ÙˆØ¬ÙˆØ¯Ø©\n  if (inter.action?.sections) {\n    displayText += '\\n\\nğŸ“‹ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©:';\n    inter.action.sections.forEach(section => {\n      if (section.rows) {\n        section.rows.forEach(row => {\n          displayText += `\\nâ€¢ ${row.title || row.id}`;\n        });\n      }\n    });\n  }\n  \n} else {\n  // Fallback Ù„Ù„Ù€ preview Ø¥Ø°Ø§ Ù„Ù… Ù†Ø³ØªØ·Ø¹ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ\n  displayText = out.preview || 'ğŸ“¤ ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø©';\n}\n\nconst msg = {\n  account, peer, name,\n  dir: 'out',\n  text: displayText,\n  ts: Math.floor(Date.now()/1000),\n  meta: { kind:'sent', type: out.type },\n  business_phone: it.business_number || ''\n};\n\ng.messages.push(msg);\nif (g.messages.length > 5000) g.messages.splice(0, g.messages.length - 5000);\n\nreturn [{ json: { logged:true, ...it } }];"},"typeVersion":2},{"id":"1ee89d43-f92b-4e04-9d01-396f58a94f4d","name":"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø©14","type":"n8n-nodes-base.code","position":[1936,400],"parameters":{"jsCode":"const g = $getWorkflowStaticData('global');\ng.messages = g.messages || [];\ng.contacts = g.contacts || {};\n\nconst it = $input.first().json;\nconst account = String(it.phone_number_id || '').trim();\nconst peer = String(it.phone_number || '').trim();\nconst out = it._outgoing || {};\n\nif (!account || !peer || !out.type) {\n  return [{ json: { logged:false, reason:'missing account/peer/_outgoing', ...it } }];\n}\n\nconst key = `${account}:${peer}`;\nconst name = it.contact_name || g.contacts[key]?.name || peer;\nif (!g.contacts[key]) g.contacts[key] = { platform:'whatsapp', peer, account, name };\nelse g.contacts[key].name = name || g.contacts[key].name;\n\n// ğŸ”¥ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ: Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ Ø§Ù„ÙØ¹Ù„ÙŠ Ù…Ù† payload\nlet displayText = '';\n\nif (out.type === 'text' && out.payload?.text?.body) {\n  // Ø±Ø³Ø§Ù„Ø© Ù†ØµÙŠØ© Ø¹Ø§Ø¯ÙŠØ©\n  displayText = out.payload.text.body;\n  \n} else if (out.type === 'interactive' && out.payload?.interactive) {\n  // Ø±Ø³Ø§Ù„Ø© Ù‚Ø§Ø¦Ù…Ø© ØªÙØ§Ø¹Ù„ÙŠØ©\n  const inter = out.payload.interactive;\n  \n  if (inter.body?.text) {\n    displayText = inter.body.text;\n  }\n  \n  // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ÙˆØ¬ÙˆØ¯Ø©\n  if (inter.action?.sections) {\n    displayText += '\\n\\nğŸ“‹ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©:';\n    inter.action.sections.forEach(section => {\n      if (section.rows) {\n        section.rows.forEach(row => {\n          displayText += `\\nâ€¢ ${row.title || row.id}`;\n        });\n      }\n    });\n  }\n  \n} else {\n  // Fallback Ù„Ù„Ù€ preview Ø¥Ø°Ø§ Ù„Ù… Ù†Ø³ØªØ·Ø¹ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ\n  displayText = out.preview || 'ğŸ“¤ ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø©';\n}\n\nconst msg = {\n  account, peer, name,\n  dir: 'out',\n  text: displayText,\n  ts: Math.floor(Date.now()/1000),\n  meta: { kind:'sent', type: out.type },\n  business_phone: it.business_number || ''\n};\n\ng.messages.push(msg);\nif (g.messages.length > 5000) g.messages.splice(0, g.messages.length - 5000);\n\nreturn [{ json: { logged:true, ...it } }];"},"typeVersion":2},{"id":"e67345b5-d125-4ae5-849f-16155de93d7b","name":"ØªØ­Ø¶ÙŠØ± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ - Ø§Ù„Ø£Ø³Ø¹Ø§Ø±","type":"n8n-nodes-base.code","position":[1872,144],"parameters":{"jsCode":"const textPayload = (to, body) => ({\n  messaging_product: \"whatsapp\",\n  to, type: \"text\", text: { body }\n});\nconst main = ($('sub route').item.json || {});\nif (!main.phone_number_id || !main.phone_number) throw new Error('missing phone');\nconst body = `Ø³Ø¹Ø± Ø§Ù„Ø§Ø³ØªÙ‚Ø¯Ø§Ù… Ù…Ù† ${$json['country']} Ù‡Ùˆ: ${$json['price']}.`;\n\nreturn [{\n  json: {\n    ...$json,\n    phone_number: main.phone_number,\n    phone_number_id: main.phone_number_id,\n    _outgoing: {\n      type:'text',\n      preview:'ğŸ“¤ ØªÙ… Ø¥Ø±Ø³Ø§Ù„: Ø³Ø¹Ø± Ø§Ù„Ø§Ø³ØªÙ‚Ø¯Ø§Ù… (Ø­Ø³Ø¨ Ø§Ù„Ø¬Ù†Ø³ÙŠØ©)',\n      payload: textPayload(main.phone_number, body)\n    }\n  }\n}];\n"},"typeVersion":2},{"id":"a24990c0-5db1-4870-9009-ed9082c24f6a","name":"ØªØ­Ø¶ÙŠØ± Ø¥Ø±Ø³Ø§Ù„ - Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø³ÙŠØ± Ø§Ù„Ø°Ø§ØªÙŠØ©","type":"n8n-nodes-base.code","position":[1792,400],"parameters":{"jsCode":"const main = $('sub route').item.json;\nconst curr = $json;\n\nconst bodyText = `âœ… ØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¬Ù†Ø³ÙŠØ©: ${curr['Ø§Ù„Ø¨Ù„Ø¯']}\n\nğŸ“„ Ø±Ø§Ø¨Ø· Ø§Ù„Ø³ÙŠØ± Ø§Ù„Ø°Ø§ØªÙŠØ© Ù„Ù„Ø¬Ù†Ø³ÙŠØ© Ù„Ù„Ø·Ù„Ø¨ Ø§Ù„Ø¬Ø¯ÙŠØ¯: ${curr['Ø§Ù„Ø³ÙŠØ±Ø©']} \n\nğŸ’¡ Ø³ÙŠØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø²ÙŠØ§Ø±ØªÙƒ Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù‡ØªÙ…Ø§Ù…Ùƒ`;\n\nconst payload = {\n  messaging_product: \"whatsapp\",\n  to: main.phone_number,\n  type: \"text\",\n  text: { body: bodyText }\n};\n\nreturn [{\n  json: {\n    ...curr,\n    phone_number: main.phone_number,\n    phone_number_id: main.phone_number_id,\n    contact_name: main.contact_name,\n    _outgoing: {\n      type: \"text\",\n      preview: \"ğŸ“¤ ØªÙ… Ø¥Ø±Ø³Ø§Ù„: Ø±Ø§Ø¨Ø· Ø§Ù„Ø³ÙŠØ± Ø§Ù„Ø°Ø§ØªÙŠØ©\",\n      payload\n    }\n  }\n}];"},"typeVersion":2},{"id":"f68d898f-4fb1-4f8c-9c16-7dd1681963ce","name":"ØªØ­Ø¶ÙŠØ± Ø¥Ø±Ø³Ø§Ù„ - Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø³ÙŠØ± Ø§Ù„Ø°Ø§ØªÙŠØ©1","type":"n8n-nodes-base.code","position":[2576,400],"parameters":{"jsCode":"const main = $('sub route').item.json;\n\nconst bodyText = \"ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø·Ù„Ø¨ÙƒØŒ ÙˆØ³ÙŠØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ Ø§Ù„Ù…ÙˆØ¸Ù Ù‚Ø±ÙŠØ¨Ù‹Ø§\";\n\nconst payload = {\n  messaging_product: \"whatsapp\",\n  to: main.phone_number,\n  type: \"text\",\n  text: { body: bodyText }\n};\n\nreturn [{\n  json: {\n    ...$json,\n    phone_number: main.phone_number,\n    phone_number_id: main.phone_number_id,\n    contact_name: main.contact_name,\n    _outgoing: {\n      type: \"text\",\n      preview: \"ğŸ“¤ ØªÙ… Ø¥Ø±Ø³Ø§Ù„: ØªØ£ÙƒÙŠØ¯ Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„Ø·Ù„Ø¨\",\n      payload\n    }\n  }\n}];"},"typeVersion":2},{"id":"e4da64dd-da3a-405c-b295-2d0781341f04","name":"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø©11","type":"n8n-nodes-base.code","position":[2112,624],"parameters":{"jsCode":"const g = $getWorkflowStaticData('global');\ng.messages = g.messages || [];\ng.contacts = g.contacts || {};\n\nconst it = $input.first().json;\nconst account = String(it.phone_number_id || '').trim();\nconst peer = String(it.phone_number || '').trim();\nconst out = it._outgoing || {};\n\nif (!account || !peer || !out.type) {\n  return [{ json: { logged:false, reason:'missing account/peer/_outgoing', ...it } }];\n}\n\nconst key = `${account}:${peer}`;\nconst name = it.contact_name || g.contacts[key]?.name || peer;\nif (!g.contacts[key]) g.contacts[key] = { platform:'whatsapp', peer, account, name };\nelse g.contacts[key].name = name || g.contacts[key].name;\n\n// ğŸ”¥ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ: Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ Ø§Ù„ÙØ¹Ù„ÙŠ Ù…Ù† payload\nlet displayText = '';\n\nif (out.type === 'text' && out.payload?.text?.body) {\n  // Ø±Ø³Ø§Ù„Ø© Ù†ØµÙŠØ© Ø¹Ø§Ø¯ÙŠØ©\n  displayText = out.payload.text.body;\n  \n} else if (out.type === 'interactive' && out.payload?.interactive) {\n  // Ø±Ø³Ø§Ù„Ø© Ù‚Ø§Ø¦Ù…Ø© ØªÙØ§Ø¹Ù„ÙŠØ©\n  const inter = out.payload.interactive;\n  \n  if (inter.body?.text) {\n    displayText = inter.body.text;\n  }\n  \n  // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ÙˆØ¬ÙˆØ¯Ø©\n  if (inter.action?.sections) {\n    displayText += '\\n\\nğŸ“‹ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©:';\n    inter.action.sections.forEach(section => {\n      if (section.rows) {\n        section.rows.forEach(row => {\n          displayText += `\\nâ€¢ ${row.title || row.id}`;\n        });\n      }\n    });\n  }\n  \n} else {\n  // Fallback Ù„Ù„Ù€ preview Ø¥Ø°Ø§ Ù„Ù… Ù†Ø³ØªØ·Ø¹ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ\n  displayText = out.preview || 'ğŸ“¤ ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø©';\n}\n\nconst msg = {\n  account, peer, name,\n  dir: 'out',\n  text: displayText,\n  ts: Math.floor(Date.now()/1000),\n  meta: { kind:'sent', type: out.type },\n  business_phone: it.business_number || ''\n};\n\ng.messages.push(msg);\nif (g.messages.length > 5000) g.messages.splice(0, g.messages.length - 5000);\n\nreturn [{ json: { logged:true, ...it } }];"},"typeVersion":2},{"id":"4ea07fbc-0fd0-4e94-b7c7-0c32876a1531","name":"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø©12","type":"n8n-nodes-base.code","position":[2112,832],"parameters":{"jsCode":"const g = $getWorkflowStaticData('global');\ng.messages = g.messages || [];\ng.contacts = g.contacts || {};\n\nconst it = $input.first().json;\nconst account = String(it.phone_number_id || '').trim();\nconst peer = String(it.phone_number || '').trim();\nconst out = it._outgoing || {};\n\nif (!account || !peer || !out.type) {\n  return [{ json: { logged:false, reason:'missing account/peer/_outgoing', ...it } }];\n}\n\nconst key = `${account}:${peer}`;\nconst name = it.contact_name || g.contacts[key]?.name || peer;\nif (!g.contacts[key]) g.contacts[key] = { platform:'whatsapp', peer, account, name };\nelse g.contacts[key].name = name || g.contacts[key].name;\n\n// ğŸ”¥ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ: Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ Ø§Ù„ÙØ¹Ù„ÙŠ Ù…Ù† payload\nlet displayText = '';\n\nif (out.type === 'text' && out.payload?.text?.body) {\n  // Ø±Ø³Ø§Ù„Ø© Ù†ØµÙŠØ© Ø¹Ø§Ø¯ÙŠØ©\n  displayText = out.payload.text.body;\n  \n} else if (out.type === 'interactive' && out.payload?.interactive) {\n  // Ø±Ø³Ø§Ù„Ø© Ù‚Ø§Ø¦Ù…Ø© ØªÙØ§Ø¹Ù„ÙŠØ©\n  const inter = out.payload.interactive;\n  \n  if (inter.body?.text) {\n    displayText = inter.body.text;\n  }\n  \n  // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ÙˆØ¬ÙˆØ¯Ø©\n  if (inter.action?.sections) {\n    displayText += '\\n\\nğŸ“‹ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©:';\n    inter.action.sections.forEach(section => {\n      if (section.rows) {\n        section.rows.forEach(row => {\n          displayText += `\\nâ€¢ ${row.title || row.id}`;\n        });\n      }\n    });\n  }\n  \n} else {\n  // Fallback Ù„Ù„Ù€ preview Ø¥Ø°Ø§ Ù„Ù… Ù†Ø³ØªØ·Ø¹ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ\n  displayText = out.preview || 'ğŸ“¤ ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø©';\n}\n\nconst msg = {\n  account, peer, name,\n  dir: 'out',\n  text: displayText,\n  ts: Math.floor(Date.now()/1000),\n  meta: { kind:'sent', type: out.type },\n  business_phone: it.business_number || ''\n};\n\ng.messages.push(msg);\nif (g.messages.length > 5000) g.messages.splice(0, g.messages.length - 5000);\n\nreturn [{ json: { logged:true, ...it } }];"},"typeVersion":2},{"id":"1d0c3cc6-8093-4fa5-86cb-799c6abe4ab4","name":"ØªØ­Ø¶ÙŠØ± Ø¥Ø±Ø³Ø§Ù„ - Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©","type":"n8n-nodes-base.code","position":[1952,624],"parameters":{"jsCode":"const main = $('sub route').item.json;\nconst curr = $json;\n\nconst bodyText = ` Ø­Ø§Ù„Ø© Ø·Ù„Ø¨Ùƒ: ${curr['Ø§Ù„Ø­Ø§Ù„Ø©']} `;\n\nconst payload = {\n  messaging_product: \"whatsapp\",\n  to: main.phone_number,\n  type: \"text\",\n  text: { body: bodyText }\n};\n\nreturn [{\n  json: {\n    ...curr,\n    phone_number: main.phone_number,\n    phone_number_id: main.phone_number_id,\n    contact_name: main.contact_name,\n    _outgoing: {\n      type: \"text\",\n      preview: `ğŸ“¤ ØªÙ… Ø¥Ø±Ø³Ø§Ù„: Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨ (${curr['Ø§Ù„Ø­Ø§Ù„Ø©'] || ''})`,\n      payload\n    }\n  }\n}];"},"typeVersion":2},{"id":"a9d1d9e2-fa33-4059-b5ad-43d7f2e7bc1f","name":"ØªØ­Ø¶ÙŠØ± Ø¥Ø±Ø³Ø§Ù„ - Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ù„Ø§ ÙŠÙˆØ¬Ø¯","type":"n8n-nodes-base.code","position":[1936,832],"parameters":{"jsCode":"const main = $('sub route').item.json;\n\nconst bodyText = \" Ø¹Ø°Ø±Ù‹Ø§ØŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø·Ù„Ø¨ Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø±Ù‚Ù… \";\n\nconst payload = {\n  messaging_product: \"whatsapp\",\n  to: main.phone_number,\n  type: \"text\",\n  text: { body: bodyText }\n};\n\nreturn [{\n  json: {\n    ...$json,\n    phone_number: main.phone_number,\n    phone_number_id: main.phone_number_id,\n    contact_name: main.contact_name,\n    _outgoing: {\n      type: \"text\",\n      preview: \"ğŸ“¤ ØªÙ… Ø¥Ø±Ø³Ø§Ù„: Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø·Ù„Ø¨\",\n      payload\n    }\n  }\n}];"},"typeVersion":2},{"id":"99c0e52d-a0a9-4833-b18c-e608c49f64da","name":"Ø­Ø¶Ø± Ø§Ù„Ø§Ø±Ø³Ø§Ù„ - Ù†Ù‚Ù„ Ø§Ù„Ø®Ø§Ø¯Ù…Ø§Øª","type":"n8n-nodes-base.code","position":[2224,1328],"parameters":{"jsCode":"const main = $('sub route').item.json;\n\nconst bodyText = \"ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø·Ù„Ø¨ÙƒØŒ ÙˆØ³ÙŠØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ Ø§Ù„Ù…ÙˆØ¸Ù Ù‚Ø±ÙŠØ¨Ù‹Ø§\";\n\nconst payload = {\n  messaging_product: \"whatsapp\",\n  to: main.phone_number,\n  type: \"text\",\n  text: { body: bodyText }\n};\n\nreturn [{\n  json: {\n    ...$json,\n    phone_number: main.phone_number,\n    phone_number_id: main.phone_number_id,\n    contact_name: main.contact_name,\n    _outgoing: {\n      type: \"text\",\n      preview: \"ğŸ“¤ ØªÙ… Ø¥Ø±Ø³Ø§Ù„: ØªØ£ÙƒÙŠØ¯ Ø·Ù„Ø¨ Ù†Ù‚Ù„ Ø§Ù„Ø®Ø§Ø¯Ù…Ø§Øª\",\n      payload\n    }\n  }\n}];"},"typeVersion":2},{"id":"4fcf6f9a-8226-4e44-a4bb-dd11e9746fc2","name":"Ø­Ø¶Ù‘Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ â€“ Ø§Ù„Ù…ÙˆØ¸Ù","type":"n8n-nodes-base.code","position":[736,1792],"parameters":{"jsCode":"const main = $('sub route').item.json;\n\nconst bodyText = `ğŸ¤ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±...\n\nØ³ÙŠØªÙ… Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ Ù…Ù† Ø£Ø­Ø¯ Ù…ÙˆØ¸ÙÙŠ Ø®Ø¯Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ ÙÙŠ Ø£Ù‚Ø±Ø¨ ÙˆÙ‚Øª Ù…Ù…ÙƒÙ†.\n\nØ´ÙƒØ±Ø§Ù‹ Ù„ØªÙˆØ§ØµÙ„Ùƒ Ù…Ø¹Ù†Ø§! â¤ï¸`;\n\nconst payload = {\n  messaging_product: \"whatsapp\",\n  to: main.phone_number,\n  type: \"text\",\n  text: { body: bodyText }\n};\n\nreturn [{\n  json: {\n    ...$json,\n    phone_number: main.phone_number,\n    phone_number_id: main.phone_number_id,\n    contact_name: main.contact_name,\n    _outgoing: {\n      type: \"text\",\n      preview: \"ğŸ“¤ ØªÙ… Ø¥Ø±Ø³Ø§Ù„: Ø§Ù„ØªØ­Ø¯Ø« Ù…Ø¹ Ù…ÙˆØ¸Ù\",\n      payload\n    }\n  }\n}];"},"typeVersion":2},{"id":"0142688c-0abb-4227-b779-2061140766ad","name":"Sticky Note3","type":"n8n-nodes-base.stickyNote","position":[-2768,32],"parameters":{"color":5,"width":560,"height":736,"content":"## WhatsApp Webhook Entry Points\n\nThree webhook endpoints receive messages from WhatsApp Business API:\n- Main webhook\n- Backup webhook 2\n- Backup webhook 3\n\nHandles:\nâœ“ Text messages\nâœ“ Interactive button/list replies\nâœ“ Images, videos, audio, voice notes\nâœ“ Documents (PDF, Excel, etc.)\nâœ“ Webhook verification (hub.challenge)\n\nRoutes to data extraction"},"typeVersion":1},{"id":"e77cfc6b-31b3-4658-96d8-a11e66a00b6c","name":"Ø­Ø¶Ù‘Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ â€“ Ø§Ù„Ø£Ø³Ø¹Ø§Ø±","type":"n8n-nodes-base.code","position":[720,672],"parameters":{"jsCode":"// Ø­Ø¶Ù‘Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ â€“ \"Ø§Ù„Ø£Ø³Ø¹Ø§Ø± (Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ù†Ø³ÙŠØ§Øª)\"\nconst j = $json;\n\nconst payload = {\n  messaging_product: \"whatsapp\",\n  to: j.phone_number,\n  type: \"interactive\",\n  interactive: {\n    type: \"list\",\n    body: { text: \"ğŸ’² Ø§Ø®ØªØ± Ø§Ù„Ø¬Ù†Ø³ÙŠØ© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù…Ø¹Ø±ÙØ© Ø§Ù„Ø³Ø¹Ø±:\" },\n    action: {\n      button: \"Ø§Ø®ØªØ± Ø§Ù„Ø¬Ù†Ø³ÙŠØ©\",\n      sections: [\n        {\n          title: \"Ø§Ù„Ø¬Ù†Ø³ÙŠØ§Øª\",\n          rows: [\n            { id: \"price_uganda\",     title: \"ğŸ‡ºğŸ‡¬ Ø£ÙˆØºÙ†Ø¯Ø§\" },\n            { id: \"price_ethiopia\",   title: \"ğŸ‡ªğŸ‡¹ Ø¥Ø«ÙŠÙˆØ¨ÙŠØ§\" },\n            { id: \"price_philippines\",title: \"ğŸ‡µğŸ‡­ Ø§Ù„ÙÙ„Ø¨ÙŠÙ†\" },\n            { id: \"price_burundi\",    title: \"ğŸ‡§ğŸ‡® Ø¨ÙˆØ±ÙˆÙ†Ø¯ÙŠ\" },\n            { id: \"price_bangladesh\", title: \"ğŸ‡§ğŸ‡© Ø¨Ù†ØºÙ„Ø§Ø¯ÙŠØ´\" },\n            { id: \"price_kenya\",      title: \"ğŸ‡°ğŸ‡ª ÙƒÙŠÙ†ÙŠØ§\" }\n          ]\n        }\n      ]\n    }\n  }\n};\n\nreturn [{\n  json: {\n    ...j,\n    _outgoing: {\n      type: \"interactive\",\n      preview: \"ğŸ“¤ ØªÙ… Ø¥Ø±Ø³Ø§Ù„: Ø§Ù„Ø£Ø³Ø¹Ø§Ø± (Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ù†Ø³ÙŠØ§Øª)\",\n      payload\n    }\n  }\n}];\n"},"typeVersion":2},{"id":"6fe35754-decc-40db-93e2-bc1a38c1a576","name":"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø© (Ø¹Ø§Ù…)1","type":"n8n-nodes-base.code","position":[880,672],"parameters":{"jsCode":"const g = $getWorkflowStaticData('global');\ng.messages = g.messages || [];\ng.contacts = g.contacts || {};\n\nconst it = $input.first().json;\nconst account = String(it.phone_number_id || '').trim();\nconst peer = String(it.phone_number || '').trim();\nconst out = it._outgoing || {};\n\nif (!account || !peer || !out.type) {\n  return [{ json: { logged:false, reason:'missing account/peer/_outgoing', ...it } }];\n}\n\nconst key = `${account}:${peer}`;\nconst name = it.contact_name || g.contacts[key]?.name || peer;\nif (!g.contacts[key]) g.contacts[key] = { platform:'whatsapp', peer, account, name };\nelse g.contacts[key].name = name || g.contacts[key].name;\n\n// ğŸ”¥ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ: Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ Ø§Ù„ÙØ¹Ù„ÙŠ Ù…Ù† payload\nlet displayText = '';\n\nif (out.type === 'text' && out.payload?.text?.body) {\n  // Ø±Ø³Ø§Ù„Ø© Ù†ØµÙŠØ© Ø¹Ø§Ø¯ÙŠØ©\n  displayText = out.payload.text.body;\n  \n} else if (out.type === 'interactive' && out.payload?.interactive) {\n  // Ø±Ø³Ø§Ù„Ø© Ù‚Ø§Ø¦Ù…Ø© ØªÙØ§Ø¹Ù„ÙŠØ©\n  const inter = out.payload.interactive;\n  \n  if (inter.body?.text) {\n    displayText = inter.body.text;\n  }\n  \n  // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ÙˆØ¬ÙˆØ¯Ø©\n  if (inter.action?.sections) {\n    displayText += '\\n\\nğŸ“‹ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©:';\n    inter.action.sections.forEach(section => {\n      if (section.rows) {\n        section.rows.forEach(row => {\n          displayText += `\\nâ€¢ ${row.title || row.id}`;\n        });\n      }\n    });\n  }\n  \n} else {\n  // Fallback Ù„Ù„Ù€ preview Ø¥Ø°Ø§ Ù„Ù… Ù†Ø³ØªØ·Ø¹ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ\n  displayText = out.preview || 'ğŸ“¤ ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø©';\n}\n\nconst msg = {\n  account, peer, name,\n  dir: 'out',\n  text: displayText,\n  ts: Math.floor(Date.now()/1000),\n  meta: { kind:'sent', type: out.type },\n  business_phone: it.business_number || ''\n};\n\ng.messages.push(msg);\nif (g.messages.length > 5000) g.messages.splice(0, g.messages.length - 5000);\n\nreturn [{ json: { logged:true, ...it } }];"},"typeVersion":2},{"id":"3a3ecde4-1f67-46f1-aea7-9120996ddf71","name":"Ø§Ù„Ø³ÙŠØ±","type":"n8n-nodes-base.code","position":[1456,416],"parameters":{"jsCode":"// Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³ÙŠØ± Ø§Ù„Ø°Ø§ØªÙŠØ© Ø§Ù„Ø«Ø§Ø¨ØªØ©\nconst cvs = [\n  { 'Ø§Ù„Ø¨Ù„Ø¯': 'Ø£ÙˆØºÙ†Ø¯Ø§ ğŸ‡ºğŸ‡¬',    'Ø§Ù„Ø¬Ù†Ø³ÙŠØ© ': 'req_uganda',     'Ø§Ù„Ø³ÙŠØ±Ø©': 'https://fahadrec.com/workers/filter/tax/country:uganda;service-type:recruitment/' },\n  { 'Ø§Ù„Ø¨Ù„Ø¯': 'Ø¥Ø«ÙŠÙˆØ¨ÙŠØ§ ğŸ‡ªğŸ‡¹',   'Ø§Ù„Ø¬Ù†Ø³ÙŠØ© ': 'req_ethiopia',   'Ø§Ù„Ø³ÙŠØ±Ø©': 'https://fahadrec.com/workers/filter/tax/country:ethiopia;service-type:recruitment/' },\n  { 'Ø§Ù„Ø¨Ù„Ø¯': 'Ø§Ù„ÙÙ„Ø¨ÙŠÙ† ğŸ‡µğŸ‡­',   'Ø§Ù„Ø¬Ù†Ø³ÙŠØ© ': 'req_philippines','Ø§Ù„Ø³ÙŠØ±Ø©': 'https://fahadrec.com/workers/filter/tax/country:philippines;service-type:recruitment/' },\n  { 'Ø§Ù„Ø¨Ù„Ø¯': 'Ø¨ÙˆØ±ÙˆÙ†Ø¯ÙŠ ğŸ‡§ğŸ‡®',   'Ø§Ù„Ø¬Ù†Ø³ÙŠØ© ': 'req_burundi',    'Ø§Ù„Ø³ÙŠØ±Ø©': 'https://fahadrec.com/workers/filter/tax/country:burundi;service-type:recruitment/' },\n  { 'Ø§Ù„Ø¨Ù„Ø¯': 'Ø¨Ù†ØºÙ„Ø§Ø¯ÙŠØ´ ğŸ‡§ğŸ‡©', 'Ø§Ù„Ø¬Ù†Ø³ÙŠØ© ': 'req_bangladesh', 'Ø§Ù„Ø³ÙŠØ±Ø©': 'https://fahadrec.com/workers/filter/tax/country:bangladesh;service-type:recruitment/' },\n  { 'Ø§Ù„Ø¨Ù„Ø¯': 'ÙƒÙŠÙ†ÙŠØ§ ğŸ‡°ğŸ‡ª',     'Ø§Ù„Ø¬Ù†Ø³ÙŠØ© ': 'req_kenya',      'Ø§Ù„Ø³ÙŠØ±Ø©': 'https://fahadrec.com/workers/filter/tax/country:kenya;service-type:recruitment/' }\n];\n\n// Ø¥Ø±Ø¬Ø§Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙƒØµÙÙˆÙ JSON\nreturn cvs.map(cv => ({ json: cv }));\n"},"typeVersion":2},{"id":"aa700b36-377b-4ed7-90dd-f3daa31e70ad","name":"Send a message","type":"n8n-nodes-base.gmail","position":[2496,192],"webhookId":"3911d413-0c8a-47e3-8203-00adcb46d4f4","parameters":{"sendTo":"fahadrecr@gmail.com","message":"=ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯:  \n\nØ§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„: {{ $json['Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„']}} \n\nØ±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ: {{ $json['Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ '] }} \n\nØ¨Ù„Ø¯ Ø§Ù„Ø·Ù„Ø¨: {{ $json['Ø§Ù„Ø¨Ù„Ø¯'] }}","options":{},"subject":" ØªØ³Ø¬ÙŠÙ„ Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯"},"credentials":{"gmailOAuth2":{"id":"VToQTCEvxsEgbSzi","name":"Gmail account"}},"typeVersion":2.1},{"id":"c956c796-989c-437f-a25f-1ed87d54b600","name":"Send a message1","type":"n8n-nodes-base.gmail","position":[2464,1104],"webhookId":"b78fd81b-d27b-4abd-822b-94b7c667d34c","parameters":{"sendTo":"fahadrecr@gmail.com","message":"=ØªÙ… Ø·Ù„Ø¨ Ù†Ù‚Ù„ Ø®Ø§Ø¯Ù…Ø§Øª: \n\nØ§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„: {{ $json['Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„']}}\n\nØ±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ: {{ $json['Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ '] }}\n\nØ¨Ù„Ø¯ Ø§Ù„Ø·Ù„Ø¨: {{ $json['Ø§Ù„Ø¨Ù„Ø¯'] }}","options":{},"subject":"ØªÙ… Ø·Ù„Ø¨ Ù†Ù‚Ù„ Ø®Ø§Ø¯Ù…Ø§Øª"},"credentials":{"gmailOAuth2":{"id":"VToQTCEvxsEgbSzi","name":"Gmail account"}},"typeVersion":2.1},{"id":"b2c02bc6-0137-4f47-acfc-70a80665d3e9","name":"Send a message2","type":"n8n-nodes-base.gmail","position":[2176,1600],"webhookId":"c07c4be7-0bda-4d88-bc63-f3ce236f9856","parameters":{"sendTo":"fahadrecr@gmail.com","message":"=Ù‡Ù†Ø§Ùƒ Ø¹Ù…ÙŠÙ„ Ø£Ø±Ø³Ù„ Ø´ÙƒÙˆÙ‰: \n\nØ§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„: {{ $('Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª').item.json.contact_name }}\nØ±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ: {{ $('Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª').item.json.phone_number }}\n\nÙ†ÙˆØ¹ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©: {{ $('Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª').item.json.interactive_title }}","options":{},"subject":"Ù‡Ù†Ø§Ùƒ Ø¹Ù…ÙŠÙ„ Ø£Ø±Ø³Ù„ Ø´ÙƒÙˆÙ‰"},"credentials":{"gmailOAuth2":{"id":"VToQTCEvxsEgbSzi","name":"Gmail account"}},"typeVersion":2.1},{"id":"a267104e-cc91-433a-b56d-e0b0b5aa86a4","name":"Send a message3","type":"n8n-nodes-base.gmail","position":[1232,1728],"webhookId":"9d33e85b-1360-4b6c-8d97-3093001b42ea","parameters":{"sendTo":"fahadrecr@gmail.com","message":"=Ù‡Ù†Ø§Ùƒ Ø¹Ù…ÙŠÙ„ ÙŠØ±ÙŠØ¯ Ù…ÙˆØ¸Ù Ø¨Ø´Ø±ÙŠ: \n\nØ§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„: {{ $('Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª').item.json.contact_name }}\nØ±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ: {{ $('Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª').item.json.phone_number }}\n","options":{},"subject":"Ù‡Ù†Ø§Ùƒ Ø¹Ù…ÙŠÙ„ Ø£Ø±Ø³Ù„ Ø´ÙƒÙˆÙ‰"},"credentials":{"gmailOAuth2":{"id":"VToQTCEvxsEgbSzi","name":"Gmail account"}},"typeVersion":2.1},{"id":"5accd48a-9e99-4bf6-93a5-eca1bc712a87","name":"sub route","type":"n8n-nodes-base.switch","position":[1040,320],"parameters":{"rules":{"values":[{"conditions":{"options":{"version":2,"leftValue":"","caseSensitive":true,"typeValidation":"strict"},"combinator":"and","conditions":[{"id":"7f3051a7-ca03-43aa-8b82-0bdbed3f0411","operator":{"type":"string","operation":"startsWith"},"leftValue":"={{ $json.interactive_reply }}","rightValue":"price_"}]}},{"conditions":{"options":{"version":2,"leftValue":"","caseSensitive":true,"typeValidation":"strict"},"combinator":"and","conditions":[{"id":"64b87b23-5d12-4144-a40c-258eab65e688","operator":{"type":"string","operation":"startsWith"},"leftValue":"={{ $json.interactive_reply }}","rightValue":"req_"}]}},{"conditions":{"options":{"version":2,"leftValue":"","caseSensitive":true,"typeValidation":"strict"},"combinator":"and","conditions":[{"id":"33a7614c-275d-476c-a860-df16c485ef2b","operator":{"type":"string","operation":"startsWith"},"leftValue":"={{ $json.interactive_reply }}","rightValue":"complaint_"}]}},{"conditions":{"options":{"version":2,"leftValue":"","caseSensitive":true,"typeValidation":"strict"},"combinator":"and","conditions":[{"id":"9d8346bb-d23a-4bdd-a6c7-25bfa43981da","operator":{"type":"string","operation":"startsWith"},"leftValue":"={{ $json.interactive_reply }}","rightValue":"m_"}]}}]},"options":{}},"typeVersion":3.2},{"id":"012deae1-ab2a-4e29-a2a3-155531884405","name":"Get row(s)","type":"n8n-nodes-base.dataTable","position":[1488,160],"parameters":{"operation":"get","returnAll":true,"dataTableId":{"__rl":true,"mode":"list","value":"yiQeA2dW0zlIPPQR","cachedResultUrl":"/projects/sJVutLQokgMvGHKk/datatables/yiQeA2dW0zlIPPQR","cachedResultName":"fahad whatsapp"}},"typeVersion":1},{"id":"6df2de89-4cb1-401b-a88b-e79daa0e341e","name":"ÙÙŠ ÙˆØ³Ø§Ø¦Ø·ØŸ","type":"n8n-nodes-base.if","position":[-1808,576],"parameters":{"options":{},"conditions":{"options":{"version":2,"leftValue":"","caseSensitive":true,"typeValidation":"strict"},"combinator":"and","conditions":[{"id":"f9464b07-98f8-4207-8824-25efc046ea73","operator":{"type":"string","operation":"notEmpty","singleValue":true},"leftValue":"={{ $json.media_id }}","rightValue":""}]}},"typeVersion":2.2},{"id":"c7cc7e00-024b-455b-a197-7a05001bbe8e","name":"Action in an app","type":"n8n-nodes-base.httpRequest","position":[-1616,416],"parameters":{"url":"=https://graph.facebook.com/v17.0/{{ $json.media_id }}?fields=url,mime_type","options":{},"authentication":"genericCredentialType","genericAuthType":"httpBearerAuth"},"credentials":{"httpBearerAuth":{"id":"NOIvE5LFWAhcXfLj","name":"Bearer YOUR_TOKEN_HERE account"}},"typeVersion":4.2},{"id":"3e8c16e2-08d2-41d2-b5f8-58c840b4b440","name":"HTTP Request","type":"n8n-nodes-base.httpRequest","position":[-1440,416],"parameters":{"url":"={{ $json.url }}","options":{"response":{"response":{"responseFormat":"file"}}},"authentication":"genericCredentialType","genericAuthType":"httpBearerAuth"},"credentials":{"httpBearerAuth":{"id":"NOIvE5LFWAhcXfLj","name":"Bearer YOUR_TOKEN_HERE account"}},"typeVersion":4.2},{"id":"5b81c228-c38c-4c7a-983a-90fa5e285d5d","name":"Ø­ÙØ¸ Ø§Ù„Ù…ÙŠØ¯ÙŠØ§","type":"n8n-nodes-base.code","position":[-1296,416],"parameters":{"jsCode":"// ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ù…Ù„Ù ÙÙŠ Data Table\nconst original = $('Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª').first().json;\nconst binaryData = $input.first().binary?.data;\n\nif (!binaryData || !binaryData.data) {\n  console.error('âŒ No binary data');\n  return [{ json: original }];\n}\n\nconst base64 = binaryData.data.toString('base64');\nconst mime = binaryData.mimeType || 'application/octet-stream';\n\nconsole.log(`âœ… Saving: ${original.media_type} - ${mime} - ${(base64.length * 0.75 / 1024).toFixed(2)} KB`);\n\nreturn [{\n  json: {\n    // Ù„Ù„Ù€ Data Table\n    media_id: original.media_id,\n    account: original.phone_number_id,\n    peer: original.phone_number,\n    media_type: original.media_type,\n    media_base64: base64,\n    media_mime_type: mime,  // âœ… Ù‡Ø°Ø§ Ù…Ù‡Ù… Ø¬Ø¯Ø§Ù‹\n    caption: original.media_caption || '',\n    filename: original.media_filename || '',\n    created_at: Math.floor(Date.now() / 1000),\n    \n    // Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£ØµÙ„ÙŠØ©\n    phone_number_id: original.phone_number_id,\n    phone_number: original.phone_number,\n    business_number: original.business_number,\n    message_text: original.message_text,\n    interactive_reply: original.interactive_reply,\n    interactive_title: original.interactive_title,\n    interactive_type: original.interactive_type,\n    contact_name: original.contact_name,\n    is_status_update: original.is_status_update,\n    media_downloaded: true,\n    media_filename: original.media_filename,  // âœ… Ø£Ø¶ÙÙ‡Ø§ Ù‡Ù†Ø§\n\n  }\n}];"},"typeVersion":2},{"id":"e95e9578-9dae-4f9f-8597-b7944227ee36","name":"ØªÙ†Ø²ÙŠÙ„ Ø§Ù„ÙˆØ³Ø§Ø¦Ø·","type":"n8n-nodes-base.code","position":[-1488,624],"parameters":{"jsCode":"// ğŸ“¥ ØªÙ†Ø²ÙŠÙ„ Ø§Ù„ÙˆØ³Ø§Ø¦Ø· Ù…Ù† WhatsApp\n\nconst g = $getWorkflowStaticData('global');\nconst item = $input.first().json;\n\n// Ø¥Ø°Ø§ Ù…Ø§ ÙÙŠ media_idØŒ ØªØ¬Ø§ÙˆØ²\nif (!item.media_id) {\n  return [{ json: item }];\n}\n\ntry {\n  // 1ï¸âƒ£ Ø¬Ù„Ø¨ Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ù„Ù Ù…Ù† WhatsApp API\n  const mediaInfoUrl = `https://graph.facebook.com/v17.0/${item.media_id}`;\n  const mediaInfoResponse = await fetch(mediaInfoUrl, {\n    headers: {\n      'Authorization': 'Bearer YOUR_TOKEN_HERE' // âš ï¸ Ø¶Ø¹ Ø§Ù„ØªÙˆÙƒÙ† Ù‡Ù†Ø§\n    }\n  });\n  \n  const mediaInfo = await mediaInfoResponse.json();\n  const mediaUrl = mediaInfo.url;\n  \n  // 2ï¸âƒ£ ØªÙ†Ø²ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ù†ÙØ³Ù‡\n  const mediaResponse = await fetch(mediaUrl, {\n    headers: {\n      'Authorization': 'Bearer YOUR_TOKEN_HERE' // âš ï¸ Ø¶Ø¹ Ø§Ù„ØªÙˆÙƒÙ† Ù‡Ù†Ø§\n    }\n  });\n  \n  const mediaBuffer = await mediaResponse.arrayBuffer();\n  const mediaBase64 = Buffer.from(mediaBuffer).toString('base64');\n  \n  console.log(`âœ… ØªÙ… ØªÙ†Ø²ÙŠÙ„ Ø§Ù„ÙˆØ³Ø§Ø¦Ø·: ${item.media_type} - ${(mediaBase64.length * 0.75 / 1024).toFixed(2)} KB`);\n  \n  // 3ï¸âƒ£ Ø­ÙØ¸ Ø§Ù„Ù…Ù„Ù Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª\n  return [{\n    json: {\n      ...item,\n      media_url: mediaUrl,\n      media_base64: mediaBase64, // Ø§Ù„Ù…Ù„Ù ÙƒÙ€ base64\n      media_mime_type: mediaInfo.mime_type\n    }\n  }];\n  \n} catch (error) {\n  console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªÙ†Ø²ÙŠÙ„ Ø§Ù„ÙˆØ³Ø§Ø¦Ø·:', error);\n  return [{ json: item }]; // Ø£Ø±Ø¬Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£ØµÙ„ÙŠØ©\n}"},"typeVersion":2},{"id":"ac832353-6645-47e0-80c7-caa369fe13fa","name":"Code in JavaScript4","type":"n8n-nodes-base.code","position":[-880,416],"parameters":{"jsCode":"// Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£ØµÙ„ÙŠØ© Ø¨Ø¹Ø¯ Data Table\nconst original = $('Ø­ÙØ¸ Ø§Ù„Ù…ÙŠØ¯ÙŠØ§').first().json;\n\nreturn [{\n  json: {\n    phone_number_id: original.phone_number_id,\n    phone_number: original.phone_number,\n    business_number: original.business_number,\n    message_text: original.message_text,\n    interactive_reply: original.interactive_reply,\n    interactive_title: original.interactive_title,\n    interactive_type: original.interactive_type,\n    contact_name: original.contact_name,\n    is_status_update: original.is_status_update,\n    media_type: original.media_type,\n    media_id: original.media_id,\n    media_caption: original.media_caption,\n    media_filename: original.media_filename,\n    media_downloaded: true\n  }\n}];"},"typeVersion":2},{"id":"e629dc03-b2b3-4e48-8524-ae2e732f6104","name":"Menu Cooldown Check","type":"n8n-nodes-base.code","position":[-32,352],"parameters":{"jsCode":"// ğŸ• Ø¥Ø¶Ø§ÙØ© Ù†Ø¸Ø§Ù… Cooldown Ù„Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© (5 Ø¯Ù‚Ø§Ø¦Ù‚)\nconst g = $getWorkflowStaticData('global');\nconst inItem = $input.first().json;\n\n// ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ®Ø²ÙŠÙ†\ng.lastMenuSent = g.lastMenuSent || {};\n\nconst account = String(inItem.phone_number_id || '').trim();\nconst peer = String(inItem.phone_number || '').trim();\nconst key = `${account}:${peer}`;\n\n// Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ø§Ù„ÙŠ\nconst now = Date.now();\n\n// Ø¢Ø®Ø± ÙˆÙ‚Øª ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© ÙÙŠÙ‡ Ù„Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…\nconst lastSent = g.lastMenuSent[key] || 0;\n\n// Ø§Ù„ÙØ±Ù‚ Ø¨Ø§Ù„Ø¯Ù‚Ø§Ø¦Ù‚\nconst minutesPassed = (now - lastSent) / (1000 * 60);\n\n// âœ… Ø¥Ø°Ø§ Ù…Ø± Ø£ÙƒØ«Ø± Ù…Ù† 5 Ø¯Ù‚Ø§Ø¦Ù‚ØŒ Ø£Ø±Ø³Ù„ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©\nif (minutesPassed >= 5) {\n  console.log(`âœ… Sending menu to ${key} (${minutesPassed.toFixed(1)} minutes since last)`);\n  \n  // ØªØ­Ø¯ÙŠØ« ÙˆÙ‚Øª Ø§Ù„Ø¥Ø±Ø³Ø§Ù„\n  g.lastMenuSent[key] = now;\n  \n  // Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©\n  return [{ \n    json: { \n      ...inItem,\n      send_menu: true,\n      cooldown_passed: true\n    } \n  }];\n}\n\n// âŒ Ø¥Ø°Ø§ Ù„Ù… ÙŠÙ…Ø± 5 Ø¯Ù‚Ø§Ø¦Ù‚ Ø¨Ø¹Ø¯\nconst remainingMinutes = (5 - minutesPassed).toFixed(1);\nconsole.log(`â³ Menu cooldown active for ${key}. ${remainingMinutes} minutes remaining.`);\n\nreturn [{ \n  json: { \n    ...inItem,\n    send_menu: false,\n    cooldown_active: true,\n    remaining_minutes: remainingMinutes\n  } \n}];"},"typeVersion":2},{"id":"d232d149-cd4a-48b2-a667-cb9f72b3441c","name":"If3","type":"n8n-nodes-base.if","position":[128,352],"parameters":{"options":{},"conditions":{"options":{"version":2,"leftValue":"","caseSensitive":true,"typeValidation":"strict"},"combinator":"and","conditions":[{"id":"64b6cae2-2752-4d38-aee0-faa58f736f2e","operator":{"type":"boolean","operation":"true","singleValue":true},"leftValue":"={{ $json.send_menu }}","rightValue":""}]}},"typeVersion":2.2},{"id":"fbaa136b-5e42-4d48-99a0-259368ebbe9e","name":"Upsert row(s)","type":"n8n-nodes-base.dataTable","position":[-1088,416],"parameters":{"columns":{"value":{"peer":"={{ $json.phone_number }}","account":"= {{ $json.phone_number_id }}","caption":"={{ $json.caption }}","filename":"={{ $json.filename }}","media_id":"={{ $json.media_id }}","mime_type":"={{ $json.media_mime_type }}","created_at":"={{ $json.created_at }}","media_type":"={{ $json.media_type }}","media_base64":"={{ $json.media_base64 }}"},"schema":[{"id":"media_id","type":"string","display":true,"removed":false,"readOnly":false,"required":false,"displayName":"media_id","defaultMatch":false},{"id":"media_type","type":"string","display":true,"removed":false,"readOnly":false,"required":false,"displayName":"media_type","defaultMatch":false},{"id":"media_base64","type":"string","display":true,"removed":false,"readOnly":false,"required":false,"displayName":"media_base64","defaultMatch":false},{"id":"mime_type","type":"string","display":true,"removed":false,"readOnly":false,"required":false,"displayName":"mime_type","defaultMatch":false},{"id":"caption","type":"string","display":true,"removed":false,"readOnly":false,"required":false,"displayName":"caption","defaultMatch":false},{"id":"filename","type":"string","display":true,"removed":false,"readOnly":false,"required":false,"displayName":"filename","defaultMatch":false},{"id":"account","type":"string","display":true,"removed":false,"readOnly":false,"required":false,"displayName":"account","defaultMatch":false},{"id":"peer","type":"string","display":true,"removed":false,"readOnly":false,"required":false,"displayName":"peer","defaultMatch":false},{"id":"created_at","type":"number","display":true,"removed":false,"readOnly":false,"required":false,"displayName":"created_at","defaultMatch":false}],"mappingMode":"defineBelow","matchingColumns":[],"attemptToConvertTypes":false,"convertFieldsToString":false},"filters":{"conditions":[{"keyName":"media_id","keyValue":"={{ $json.media_id }}"}]},"options":{},"operation":"upsert","dataTableId":{"__rl":true,"mode":"list","value":"ycdU6FSuoQmH7x5X","cachedResultUrl":"/projects/bgGgFi3gyzS51ECL/datatables/ycdU6FSuoQmH7x5X","cachedResultName":"media"}},"typeVersion":1},{"id":"a9b166db-62e0-4c96-9fc8-71ba80be420a","name":"Sticky Note","type":"n8n-nodes-base.stickyNote","position":[-2096,-80],"parameters":{"color":6,"width":496,"height":864,"content":"## Message Data Extraction\n\nParses incoming WhatsApp webhooks and extracts:\n- Phone numbers (sender & business)\n- Contact names\n- Message content (text/media)\n- Interactive replies (button/list selections)\n- Media metadata (type, ID, mime, caption, filename)\n\nStructures data for downstream processing\nHandles all WhatsApp message types uniformly"},"typeVersion":1},{"id":"4fea1da5-07f8-4a97-a973-b48ef3e219da","name":"Sticky Note1","type":"n8n-nodes-base.stickyNote","position":[-1584,-80],"parameters":{"width":496,"height":864,"content":"## Media File Management\n\nProcess:\n1. Detect media presence (image/video/audio/document)\n2. Fetch media URL from WhatsApp API\n3. Download file as binary\n4. Convert to base64\n5. Store in Data Table with metadata\n\nSupports:\nğŸ–¼ï¸ Images â€¢ ğŸ¥ Videos â€¢ ğŸµ Audio\nğŸ¤ Voice notes â€¢ ğŸ“„ Documents\n\nKeeps original filenames and mime types"},"typeVersion":1},{"id":"fe2e7d3c-52d6-4d84-bd15-51f5108cd46c","name":"Sticky Note2","type":"n8n-nodes-base.stickyNote","position":[-1056,-80],"parameters":{"color":7,"width":512,"height":864,"content":"## Bot Enable Check & Session Tracking\n\nLabel Tracker:\n- Tracks which menu section user is in\n- Maintains context across messages\n- Identifies main menu vs sub-menu interactions\n\nBot Master Switch:\n- Global on/off control\n- Per-user override capability\n- Prevents bot from responding when disabled\n\nSession State:\n- Tracks conversation flow state\n- Records last interaction timestamp\n- Manages user journey through menu system"},"typeVersion":1},{"id":"6492fda2-c659-4d20-954d-44662839a490","name":"Sticky Note5","type":"n8n-nodes-base.stickyNote","position":[-528,-80],"parameters":{"color":3,"width":496,"height":864,"content":"## Conversation History Logger\n\nLogs every message (incoming & outgoing):\n- Stores in global workflow memory\n- Tracks: text, timestamp, direction, type\n- Maintains last 5000 messages\n- Links messages to contacts\n- Preserves media metadata (no heavy files)\n\nUsed for:\nâ†’ Conversation review\nâ†’ Analytics\nâ†’ Customer history\nâ†’ Debugging"},"typeVersion":1},{"id":"79a3cc82-a492-4cd3-96dc-4941de967c89","name":"Sticky Note6","type":"n8n-nodes-base.stickyNote","position":[288,-80],"parameters":{"color":4,"width":496,"height":400,"content":"## Main Menu Display\n\nCooldown System (5 minutes):\n- Prevents menu spam\n- Tracks last menu send time per user\n- Only shows menu if cooldown passed\n\nInteractive Menu Options:\nğŸ’² Prices\nğŸ“ New Request  \nğŸ” Track Request\nğŸ”„ Worker Transfer\nğŸŒ Translation\nğŸ› ï¸ Complaints\nğŸ¢ About Office\nğŸ¤ Talk to Agent\n\nPrepares â†’ Logs â†’ Sends via WhatsApp API"},"typeVersion":1},{"id":"008da021-054b-47a9-9df4-63a53143163d","name":"Sticky Note7","type":"n8n-nodes-base.stickyNote","position":[-288,1072],"parameters":{"width":496,"height":672,"content":"## Smart Menu Navigation\n\nMenu Route (Main Options):\nRoutes to 8 primary services based on button ID\n\nSub Route (Nested Actions):\n- price_* â†’ Price lookup flow\n- req_* â†’ New request flow  \n- complaint_* â†’ Complaint handling\n- m_* â†’ Back to main menu\n\nEach route:\n1. Prepares appropriate response\n2. Logs outgoing message\n3. Sends via WhatsApp API\n4. Triggers backend actions (Google Sheets, Email)"},"typeVersion":1},{"id":"545f13c2-8301-42f0-9ea8-ca1df7b7c81d","name":"Sticky Note8","type":"n8n-nodes-base.stickyNote","position":[2768,592],"parameters":{"width":864,"height":1328,"content":"## Complete Service Flows & Backend Integration\n\nğŸ“Š PRICE INQUIRY\n- Static data (8 nationalities with prices in SAR)\n- User selects nationality â†’ Bot sends price\n- No backend needed\n\nğŸ“ NEW REQUEST\n1. User selects nationality\n2. Bot sends CV link\n3. Save to \"Ø·Ù„Ø¨Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©\" sheet\n4. Email staff (fahadrecr@gmail.com)\n5. Send confirmation to customer\nData: Phone, Name, Nationality, Status: \"Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©\"\n\nğŸ” REQUEST TRACKING\n1. Bot asks user to wait\n2. Lookup phone in Google Sheets\n3. Found â†’ Send status\n4. Not found â†’ Send error message\n\nğŸ”„ WORKER TRANSFER\n1. Send transfer page link\n2. Save to \"Ù†Ù‚Ù„ Ø§Ù„Ø®Ø§Ø¯Ù…Ø§Øª\" sheet\n3. Email staff notification\n4. Confirm to customer\n\nğŸŒ TRANSLATION SERVICE\n- Send WhatsApp link for phone interpretation\n- All nationalities supported\n- Static response only\n\nğŸ› ï¸ COMPLAINTS\nTypes: Worker issue, Service issue, Delays, Financial, Other\n1. User selects complaint type\n2. Save to \"Ø´ÙƒØ§ÙˆÙŠ\" sheet\n3. Email staff immediately\n4. Confirm receipt to customer\n\nğŸ¢ ABOUT OFFICE\n- Licensed info, 8 nationalities, prices\n- 2-year insurance, contact info\n- Static text response\n\nğŸ¤ HUMAN AGENT\n1. Send \"please wait\" message\n2. Email staff immediately\n3. Include customer name & phone\n\nğŸ“Š GOOGLE SHEETS CRM (3 Tabs)\n- \"Ø·Ù„Ø¨Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©\" - New requests\n- \"Ù†Ù‚Ù„ Ø§Ù„Ø®Ø§Ø¯Ù…Ø§Øª\" - Transfers\n- \"Ø´ÙƒØ§ÙˆÙŠ\" - Complaints\nOperation: Upsert by phone number\n\nâœ‰ï¸ EMAIL NOTIFICATIONS\nTo: fahadrecr@gmail.com\nTriggers: New request, Transfer, Complaint, Human agent\nIncludes: Customer details, request type, timestamp\n\nAll flows: Prepare â†’ Log â†’ Send â†’ Backend Action"},"typeVersion":1},{"id":"bc5197a4-1da4-4a0e-a365-6f4b3a08b337","name":"Sticky Note4","type":"n8n-nodes-base.stickyNote","position":[-2816,-816],"parameters":{"color":3,"width":1760,"height":704,"content":"# âš ï¸ Important Note\n\n# This workflow is part of a larger system.\n# It is not a standalone workflow â€” it connects to a full dashboard where:\n\n## - All data from the workflow is saved\n## - All incoming and outgoing messages are displayed\n## - A human escalation process is available when the automated workflow cannot complete the task or requires manual intervention"},"typeVersion":1}],"active":false,"pinData":{},"settings":{"executionOrder":"v1"},"versionId":"67bd5bef-cdc4-4843-acd7-3b132374fc55","connections":{"If":{"main":[[{"node":"ØªØ­Ø¶ÙŠØ± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ - Ø§Ù„Ø£Ø³Ø¹Ø§Ø±","type":"main","index":0}]]},"If1":{"main":[[{"node":"ØªØ­Ø¶ÙŠØ± Ø¥Ø±Ø³Ø§Ù„ - Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø³ÙŠØ± Ø§Ù„Ø°Ø§ØªÙŠØ©","type":"main","index":0}]]},"If2":{"main":[[{"node":"ØªØ­Ø¶ÙŠØ± Ø¥Ø±Ø³Ø§Ù„ - Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©","type":"main","index":0}],[{"node":"ØªØ­Ø¶ÙŠØ± Ø¥Ø±Ø³Ø§Ù„ - Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ù„Ø§ ÙŠÙˆØ¬Ø¯","type":"main","index":0}]]},"If3":{"main":[[{"node":"Ø­Ø¶Ù‘Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ â€“ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©","type":"main","index":0}]]},"If5":{"main":[[{"node":"Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª","type":"main","index":0}]]},"Wait":{"main":[[{"node":"ØªØ­Ø¶ÙŠØ± Ø¥Ø±Ø³Ø§Ù„ - Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø³ÙŠØ± Ø§Ù„Ø°Ø§ØªÙŠØ©1","type":"main","index":0}]]},"Wait1":{"main":[[{"node":"Ø­Ø¶Ø± Ø§Ù„Ø§Ø±Ø³Ø§Ù„ - Ù†Ù‚Ù„ Ø§Ù„Ø®Ø§Ø¯Ù…Ø§Øª","type":"main","index":0}]]},"Webhook":{"main":[[{"node":"Verify Webhook2","type":"main","index":0}],[{"node":"If5","type":"main","index":0}]]},"bot on?":{"main":[[{"node":"Ø§Ù‚Ø±Ø£ Ø§Ù„Ø­Ø§Ù„Ø©","type":"main","index":0}],[{"node":"Respond to Webhook","type":"main","index":0}]]},"sub route":{"main":[[{"node":"Get row(s)","type":"main","index":0}],[{"node":"Ø§Ù„Ø³ÙŠØ±","type":"main","index":0}],[{"node":"Ø­Ø¶Ù‘Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ â€“ Ø´ÙƒÙˆÙ‰ ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„","type":"main","index":0}],[{"node":"menu route","type":"main","index":0}]]},"Get row(s)":{"main":[[{"node":"If","type":"main","index":0}]]},"menu route":{"main":[[{"node":"Ø­Ø¶Ù‘Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ â€“ Ø§Ù„Ø£Ø³Ø¹Ø§Ø±","type":"main","index":0}],[{"node":"Ø­Ø¶Ù‘Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ â€“ Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯","type":"main","index":0}],[{"node":"Ø­Ø¶Ù‘Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ â€“ Ø·Ù„Ø¨ Ù…ØªØ§Ø¨Ø¹Ø©","type":"main","index":0}],[{"node":"Ø­Ø¶Ù‘Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ â€“ Ù†Ù‚Ù„ Ø§Ù„Ø®Ø§Ø¯Ù…Ø§Øª","type":"main","index":0}],[{"node":"Ø­Ø¶Ù‘Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ â€“ Ø§Ù„ØªØ±Ø¬Ù…Ø©","type":"main","index":0}],[{"node":"Ø­Ø¶Ù‘Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ â€“ Ø´ÙƒÙˆÙ‰","type":"main","index":0}],[{"node":"Ø­Ø¶Ù‘Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ â€“ Ù„Ø§Ù„Ù…ÙƒØªØ¨","type":"main","index":0}],[{"node":"Ø­Ø¶Ù‘Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ â€“ Ø§Ù„Ù…ÙˆØ¸Ù","type":"main","index":0}]]},"Ø§Ù„Ø³ÙŠØ±":{"main":[[{"node":"If1","type":"main","index":0}]]},"HTTP Request":{"main":[[{"node":"Ø­ÙØ¸ Ø§Ù„Ù…ÙŠØ¯ÙŠØ§","type":"main","index":0}]]},"Ù…ØªØ§Ø¨Ø¹Ø©":{"main":[[{"node":"Code in JavaScript","type":"main","index":0}]]},"Upsert row(s)":{"main":[[{"node":"Code in JavaScript4","type":"main","index":0}]]},"Send a message2":{"main":[[{"node":"Ø¥Ø¯Ø®Ø§Ù„ Ù†Ù‚Ù„ Ø®Ø§Ø¯Ù…Ø§Øª1","type":"main","index":0}]]},"Action in an app":{"main":[[{"node":"HTTP Request","type":"main","index":0}]]},"Ø¹Ù† Ø§Ù„Ù…ÙƒØªØ¨":{"main":[[{"node":"Respond to Webhook","type":"main","index":0}]]},"ÙÙŠ ÙˆØ³Ø§Ø¦Ø·ØŸ":{"main":[[{"node":"Action in an app","type":"main","index":0}],[{"node":"ØªÙ†Ø²ÙŠÙ„ Ø§Ù„ÙˆØ³Ø§Ø¦Ø·","type":"main","index":0}]]},"Code in JavaScript":{"main":[[{"node":"If2","type":"main","index":0}]]},"Code in JavaScript1":{"main":[[{"node":"Ø³Ø¬Ù„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„","type":"main","index":0}]]},"Code in JavaScript2":{"main":[[{"node":"bot on?","type":"main","index":0}]]},"Code in JavaScript4":{"main":[[{"node":"Code in JavaScript1","type":"main","index":0}]]},"Menu Cooldown Check":{"main":[[{"node":"If3","type":"main","index":0}]]},"Ø§Ù‚Ø±Ø£ Ø§Ù„Ø­Ø§Ù„Ø©":{"main":[[{"node":"Ø±Ø³Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©ØŸ","type":"main","index":0}]]},"Ø­ÙØ¸ Ø§Ù„Ù…ÙŠØ¯ÙŠØ§":{"main":[[{"node":"Upsert row(s)","type":"main","index":0}]]},"Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø³ÙŠØ±":{"main":[[{"node":"Ø¥Ø¯Ø®Ø§Ù„ Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯","type":"main","index":0},{"node":"Respond to Webhook","type":"main","index":0}]]},"Ø³Ø¬Ù„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„":{"main":[[{"node":"Code in JavaScript2","type":"main","index":0}]]},"Ø±Ø³Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©ØŸ":{"main":[[{"node":"Menu Cooldown Check","type":"main","index":0}],[{"node":"sub route","type":"main","index":0}]]},"Ø§Ù„ØªØ±Ø¬Ù…Ø© - Ø±Ø§Ø¨Ø·":{"main":[[{"node":"Respond to Webhook","type":"main","index":0}]]},"ØªÙ†Ø²ÙŠÙ„ Ø§Ù„ÙˆØ³Ø§Ø¦Ø·":{"main":[[{"node":"Code in JavaScript1","type":"main","index":0}]]},"Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø£Ø³Ø¹Ø§Ø±":{"main":[[{"node":"Respond to Webhook","type":"main","index":0}]]},"Ø¥Ø¯Ø®Ø§Ù„ Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯":{"main":[[{"node":"Wait","type":"main","index":0},{"node":"Send a message","type":"main","index":0}]]},"Ø§Ù„ØªØ­Ø¯Ø« Ù…Ø¹ Ù…ÙˆØ¸Ù":{"main":[[{"node":"Respond to Webhook","type":"main","index":0},{"node":"Send a message3","type":"main","index":0}]]},"Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©":{"main":[[{"node":"Respond to Webhook","type":"main","index":0}]]},"Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©1":{"main":[[{"node":"Respond to Webhook","type":"main","index":0}]]},"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø©1":{"main":[[{"node":"Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ - Ø§Ø®ØªØ± Ø¬Ù†Ø³ÙŠØ©","type":"main","index":0}]]},"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø©2":{"main":[[{"node":"Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰ - Ø§Ø·Ù„Ø¨ ØªÙØ§ØµÙŠÙ„","type":"main","index":0}]]},"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø©3":{"main":[[{"node":"Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰ - Ø§Ø·Ù„Ø¨ ØªÙØ§ØµÙŠÙ„1","type":"main","index":0}]]},"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø©4":{"main":[[{"node":"Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø£Ø³Ø¹Ø§Ø±","type":"main","index":0}]]},"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø©5":{"main":[[{"node":"Ù…ØªØ§Ø¨Ø¹Ø© - Ø§Ø·Ù„Ø¨ Ø±Ù‚Ù…","type":"main","index":0}]]},"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø©6":{"main":[[{"node":"Ù†Ù‚Ù„ Ø®Ø§Ø¯Ù…Ø§Øª - Ø§Ø®ØªØ± Ø¬Ù†Ø³ÙŠØ©","type":"main","index":0}]]},"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø©7":{"main":[[{"node":"Ø§Ù„ØªØ±Ø¬Ù…Ø© - Ø±Ø§Ø¨Ø·","type":"main","index":0}]]},"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø©8":{"main":[[{"node":"Ø¹Ù† Ø§Ù„Ù…ÙƒØªØ¨","type":"main","index":0}]]},"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø©9":{"main":[[{"node":"Ø§Ù„ØªØ­Ø¯Ø« Ù…Ø¹ Ù…ÙˆØ¸Ù","type":"main","index":0}]]},"Ø¥Ø¯Ø®Ø§Ù„ Ù†Ù‚Ù„ Ø®Ø§Ø¯Ù…Ø§Øª":{"main":[[{"node":"Wait1","type":"main","index":0},{"node":"Send a message1","type":"main","index":0}]]},"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø©10":{"main":[[{"node":"Ø±Ø³Ø§Ù„Ø© ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø³ÙŠØ±Ø©","type":"main","index":0}]]},"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø©11":{"main":[[{"node":"Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©","type":"main","index":0}]]},"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø©12":{"main":[[{"node":"Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©1","type":"main","index":0}]]},"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø©13":{"main":[[{"node":"Ø±Ø³Ø§Ù„Ø© ØªØ£ÙƒÙŠØ¯ Ø·Ù„Ø¨ Ø§Ù„Ù†Ù‚Ù„ Ø§Ù„Ø®Ø§Ø¯Ù…Ø§Øª","type":"main","index":0}]]},"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø©14":{"main":[[{"node":"Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø³ÙŠØ±","type":"main","index":0}]]},"Ù…ØªØ§Ø¨Ø¹Ø© - Ø§Ø·Ù„Ø¨ Ø±Ù‚Ù…":{"main":[[{"node":"Respond to Webhook","type":"main","index":0},{"node":"Ù…ØªØ§Ø¨Ø¹Ø©","type":"main","index":0}]]},"Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª":{"main":[[{"node":"ÙÙŠ ÙˆØ³Ø§Ø¦Ø·ØŸ","type":"main","index":0}]]},"Ù†Ù‚Ù„ Ø®Ø§Ø¯Ù…Ø§Øª Ù…Ù† Ø§Ù„Ø´ÙŠØª":{"main":[[{"node":"Ø¥Ø¯Ø®Ø§Ù„ Ù†Ù‚Ù„ Ø®Ø§Ø¯Ù…Ø§Øª","type":"main","index":0}]]},"Ø§Ù„Ø£Ø³Ø¹Ø§Ø± - Ø§Ø®ØªØ± Ø¬Ù†Ø³ÙŠØ©":{"main":[[{"node":"Respond to Webhook","type":"main","index":0}]]},"Ø­Ø¶Ù‘Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ â€“ Ø´ÙƒÙˆÙ‰":{"main":[[{"node":"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø©2","type":"main","index":0}]]},"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø© (Ø¹Ø§Ù…)":{"main":[[{"node":"Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©","type":"main","index":0}]]},"Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ - Ø§Ø®ØªØ± Ø¬Ù†Ø³ÙŠØ©":{"main":[[{"node":"Respond to Webhook","type":"main","index":0}]]},"Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰ - Ø§Ø·Ù„Ø¨ ØªÙØ§ØµÙŠÙ„":{"main":[[{"node":"Respond to Webhook","type":"main","index":0}]]},"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø© (Ø¹Ø§Ù…)1":{"main":[[{"node":"Ø§Ù„Ø£Ø³Ø¹Ø§Ø± - Ø§Ø®ØªØ± Ø¬Ù†Ø³ÙŠØ©","type":"main","index":0}]]},"Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰ - Ø§Ø·Ù„Ø¨ ØªÙØ§ØµÙŠÙ„1":{"main":[[{"node":"Respond to Webhook","type":"main","index":0},{"node":"Send a message2","type":"main","index":0}]]},"Ø­Ø¶Ù‘Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ â€“ Ø§Ù„Ù…ÙˆØ¸Ù":{"main":[[{"node":"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø©9","type":"main","index":0}]]},"Ù†Ù‚Ù„ Ø®Ø§Ø¯Ù…Ø§Øª - Ø§Ø®ØªØ± Ø¬Ù†Ø³ÙŠØ©":{"main":[[{"node":"Respond to Webhook","type":"main","index":0},{"node":"Ù†Ù‚Ù„ Ø®Ø§Ø¯Ù…Ø§Øª Ù…Ù† Ø§Ù„Ø´ÙŠØª","type":"main","index":0}]]},"Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©":{"main":[[{"node":"Respond to Webhook","type":"main","index":0}]]},"ØªØ­Ø¶ÙŠØ± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ - Ø§Ù„Ø£Ø³Ø¹Ø§Ø±":{"main":[[{"node":"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø©4","type":"main","index":0}]]},"Ø­Ø¶Ù‘Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ â€“ Ø§Ù„Ø£Ø³Ø¹Ø§Ø±":{"main":[[{"node":"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø© (Ø¹Ø§Ù…)1","type":"main","index":0}]]},"Ø­Ø¶Ù‘Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ â€“ Ø§Ù„ØªØ±Ø¬Ù…Ø©":{"main":[[{"node":"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø©7","type":"main","index":0}]]},"Ø­Ø¶Ù‘Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ â€“ Ù„Ø§Ù„Ù…ÙƒØªØ¨":{"main":[[{"node":"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø©8","type":"main","index":0}]]},"Ø­Ø¶Ù‘Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ â€“ Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯":{"main":[[{"node":"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø©1","type":"main","index":0}]]},"Ø­Ø¶Ø± Ø§Ù„Ø§Ø±Ø³Ø§Ù„ - Ù†Ù‚Ù„ Ø§Ù„Ø®Ø§Ø¯Ù…Ø§Øª":{"main":[[{"node":"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø©13","type":"main","index":0}]]},"Ø­Ø¶Ù‘Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ â€“ Ø·Ù„Ø¨ Ù…ØªØ§Ø¨Ø¹Ø©":{"main":[[{"node":"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø©5","type":"main","index":0}]]},"ØªØ­Ø¶ÙŠØ± Ø¥Ø±Ø³Ø§Ù„ - Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©":{"main":[[{"node":"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø©11","type":"main","index":0}]]},"Ø­Ø¶Ù‘Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ â€“ Ù†Ù‚Ù„ Ø§Ù„Ø®Ø§Ø¯Ù…Ø§Øª":{"main":[[{"node":"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø©6","type":"main","index":0}]]},"Ø­Ø¶Ù‘Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ â€“ Ø´ÙƒÙˆÙ‰ ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„":{"main":[[{"node":"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø©3","type":"main","index":0}]]},"Ø±Ø³Ø§Ù„Ø© ØªØ£ÙƒÙŠØ¯ Ø·Ù„Ø¨ Ø§Ù„Ù†Ù‚Ù„ Ø§Ù„Ø®Ø§Ø¯Ù…Ø§Øª":{"main":[[{"node":"Respond to Webhook","type":"main","index":0}]]},"Ø­Ø¶Ù‘Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ â€“ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©":{"main":[[{"node":"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø© (Ø¹Ø§Ù…)","type":"main","index":0}]]},"ØªØ­Ø¶ÙŠØ± Ø¥Ø±Ø³Ø§Ù„ - Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø³ÙŠØ± Ø§Ù„Ø°Ø§ØªÙŠØ©":{"main":[[{"node":"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø©14","type":"main","index":0}]]},"ØªØ­Ø¶ÙŠØ± Ø¥Ø±Ø³Ø§Ù„ - Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø³ÙŠØ± Ø§Ù„Ø°Ø§ØªÙŠØ©1":{"main":[[{"node":"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø©10","type":"main","index":0}]]},"ØªØ­Ø¶ÙŠØ± Ø¥Ø±Ø³Ø§Ù„ - Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ù„Ø§ ÙŠÙˆØ¬Ø¯":{"main":[[{"node":"Ø³Ø¬Ù„ Ø±Ø³Ø§Ù„Ø© Ø®Ø§Ø±Ø¬Ø©12","type":"main","index":0}]]}}}