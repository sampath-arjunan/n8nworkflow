Automated Amazon Stock Level Tracker with Bright Data MCP and OpenAI

https://n8nworkflows.xyz/workflows/automated-amazon-stock-level-tracker-with-bright-data-mcp-and-openai-5960


# Automated Amazon Stock Level Tracker with Bright Data MCP and OpenAI

### 1. Workflow Overview

This workflow automates the monitoring of an Amazon product‚Äôs stock availability and sends an alert email to the supplier if the product is out of stock. It is designed for users or businesses who want to track stock levels without manual checks, leveraging AI and proxy scraping for reliability and bypassing anti-bot protections.

**Use Cases:**  
- Retailers or resellers tracking inventory for restocking  
- Dropshippers monitoring supplier stock  
- Automated inventory alerts to avoid lost sales  

**Logical Blocks:**

- **1.1 Input Setup & Trigger:** Defines the product URL to monitor and sets the schedule for periodic checks.  
- **1.2 Scraping & Data Extraction:** Uses AI-driven scraping combined with Bright Data‚Äôs Mobile Carrier Proxy (MCP) to fetch and parse product stock data from Amazon.  
- **1.3 Decision & Notification:** Evaluates if the product is in stock and triggers an email alert if out of stock, otherwise takes no action.  

---

### 2. Block-by-Block Analysis

#### 1.1 Input Setup & Trigger

**Overview:**  
This block initiates the workflow execution on a schedule and sets the Amazon product URL to be monitored.

**Nodes Involved:**  
- Check Stock Every X Hours  
- Define Product URL  

**Node Details:**

- **Check Stock Every X Hours**  
  - Type: Schedule Trigger  
  - Configuration: Triggers daily at 9:00 AM (triggerAtHour=9)  
  - Inputs: None (trigger node)  
  - Outputs: Connects to Define Product URL  
  - Failures: None common, but workflow will not trigger if n8n service is down or if scheduling is misconfigured  

- **Define Product URL**  
  - Type: Set  
  - Configuration: Manually assigns the Amazon product URL as a string parameter under ‚ÄúProduct url‚Äù  
  - Inputs: From Schedule Trigger  
  - Outputs: Passes product URL to the scraping agent node  
  - Failures: No dynamic validation, malformed or outdated URLs may yield scraping errors  

---

#### 1.2 Scraping & Data Extraction

**Overview:**  
This block performs the actual stock data scraping using AI agents and Bright Data MCP to simulate a mobile user browsing Amazon, then parses the output into structured JSON.

**Nodes Involved:**  
- Scrape Product Data (via Agent)  
- OpenAI (Chat)  
- Bright Data MCP (Scraper)  
- Structured Output Parser  
- Auto-fixing Output Parser  
- OpenAI Chat Model  

**Node Details:**

- **Scrape Product Data (via Agent)**  
  - Type: Langchain AI Agent  
  - Configuration: Prompt instructs to scrape the Amazon product page URL passed in to determine stock status (‚ÄúIn Stock‚Äù or ‚ÄúOut of Stock‚Äù)  
  - Inputs: Receives product URL from Define Product URL, AI tool data from Bright Data MCP, and AI language model from OpenAI (Chat)  
  - Outputs: Sends scraped data to condition node for stock check  
  - Failures: Possible if AI agent misinterprets output, or if MCP scraper fails to retrieve page  

- **OpenAI (Chat)**  
  - Type: Langchain OpenAI Chat Model  
  - Configuration: Model set to ‚Äúgpt-4o-mini‚Äù for comprehension and parsing assistance  
  - Inputs: Connected as AI language model to Scrape Product Data (via Agent)  
  - Outputs: Provides language model responses to agent  
  - Credentials: Requires valid OpenAI API key  
  - Failures: API rate limits, authentication errors, or model unavailability  

- **Bright Data MCP (Scraper)**  
  - Type: MCP Client Tool (Bright Data)  
  - Configuration: Uses the ‚Äúweb_data_amazon_product‚Äù tool with parameters dynamically generated by AI override code  
  - Inputs: Provides web page data to Scrape Product Data (via Agent) as AI tool  
  - Outputs: Raw scraped page data for AI processing  
  - Credentials: MCP Client API credentials required  
  - Failures: Proxy service downtime, IP bans, or tool parameter errors  

- **Structured Output Parser**  
  - Type: Langchain Structured Output Parser  
  - Configuration: Uses a JSON schema example specifying fields like availability, product title, price, seller, rating, and URL to parse AI output into structured JSON  
  - Inputs: Receives AI chat output from OpenAI Chat Model  
  - Outputs: Provides structured JSON to Auto-fixing Output Parser  
  - Failures: Parsing errors if AI output deviates significantly from schema  

- **Auto-fixing Output Parser**  
  - Type: Langchain Output Parser Autofixing  
  - Configuration: Automatically corrects minor deviations in AI output to match the expected JSON format  
  - Inputs: From Structured Output Parser  
  - Outputs: Returns fixed output back to Scrape Product Data (via Agent) for final use  
  - Failures: Complex or totally malformed data may not be fixed  

- **OpenAI Chat Model**  
  - Type: Langchain OpenAI Chat Model  
  - Configuration: Another instance of ‚Äúgpt-4o-mini‚Äù used to assist output parsing and validation  
  - Inputs: Feeds AI language model for parsing nodes  
  - Outputs: Outputs feed into Structured Output Parser  
  - Credentials: OpenAI API key required  
  - Failures: Same as the first OpenAI Chat node  

---

#### 1.3 Decision & Notification

**Overview:**  
This block checks the parsed stock availability and sends an email notification if the product is out of stock. If the product is available, it does nothing.

**Nodes Involved:**  
- Product In Stock? (If)  
- Email Supplier (Out of Stock Alert)  
- Do Nothing (Stock Available)  

**Node Details:**

- **Product In Stock?**  
  - Type: If  
  - Configuration: Checks if the field `output.availability` equals the string ‚ÄúIn Stock‚Äù (case sensitive)  
  - Inputs: Output data from Scrape Product Data (via Agent)  
  - Outputs:  
    - True: Connects to Do Nothing (Stock Available)  
    - False: Connects to Email Supplier (Out of Stock Alert)  
  - Failures: If output JSON is missing or malformed, condition may fail or default to false  

- **Email Supplier (Out of Stock Alert)**  
  - Type: Gmail (OAuth2)  
  - Configuration: Sends an email to ‚Äúshahkar.genai@gmail.com‚Äù with subject dynamically set to the product title indicating out of stock, message requesting 50 more products  
  - Inputs: From Product In Stock? node (false branch)  
  - Outputs: None (end node)  
  - Credentials: Requires valid Gmail OAuth2 credentials  
  - Failures: SMTP sending errors, OAuth token expiration, invalid email address  

- **Do Nothing (Stock Available)**  
  - Type: No Operation  
  - Configuration: No parameters, used to end workflow silently when product is in stock  
  - Inputs: From Product In Stock? node (true branch)  
  - Outputs: None (end node)  
  - Failures: None  

---

### 3. Summary Table

| Node Name                      | Node Type                               | Functional Role                      | Input Node(s)                        | Output Node(s)                      | Sticky Note                                                                                      |
|-------------------------------|---------------------------------------|------------------------------------|------------------------------------|-----------------------------------|------------------------------------------------------------------------------------------------|
| Check Stock Every X Hours      | Schedule Trigger                      | Workflow trigger at fixed time     | None                               | Define Product URL                 | ### üü© **SECTION 1: Input Setup & Trigger**                                                     |
| Define Product URL             | Set                                   | Defines product URL to check       | Check Stock Every X Hours           | Scrape Product Data (via Agent)   | ### üü© **SECTION 1: Input Setup & Trigger**                                                     |
| Scrape Product Data (via Agent)| Langchain AI Agent                    | Coordinates scraping via AI & MCP  | Define Product URL, Bright Data MCP, OpenAI (Chat), Auto-fixing Output Parser | Product In Stock?                 | ### ü§ñ **SECTION 2: Scraping Product Data from Amazon**                                        |
| OpenAI (Chat)                 | Langchain OpenAI Chat Model            | Provides language model to agent   | None                               | Scrape Product Data (via Agent)   | ### ü§ñ **SECTION 2: Scraping Product Data from Amazon**                                        |
| Bright Data MCP (Scraper)      | MCP Client Tool (Bright Data)          | Performs proxy scraping of Amazon  | None                               | Scrape Product Data (via Agent)   | ### ü§ñ **SECTION 2: Scraping Product Data from Amazon**                                        |
| Structured Output Parser       | Langchain Structured Output Parser     | Parses AI output into JSON         | OpenAI Chat Model                  | Auto-fixing Output Parser          | ### ü§ñ **SECTION 2: Scraping Product Data from Amazon**                                        |
| Auto-fixing Output Parser      | Langchain Output Parser Autofixing     | Auto-corrects AI output format     | Structured Output Parser            | Scrape Product Data (via Agent)   | ### ü§ñ **SECTION 2: Scraping Product Data from Amazon**                                        |
| OpenAI Chat Model              | Langchain OpenAI Chat Model            | Assists in output parsing          | None                               | Structured Output Parser           | ### ü§ñ **SECTION 2: Scraping Product Data from Amazon**                                        |
| Product In Stock?              | If                                    | Checks stock availability          | Scrape Product Data (via Agent)    | Do Nothing (Stock Available), Email Supplier (Out of Stock Alert) | ### üì¨ **SECTION 3: Decision & Notification**                                                  |
| Do Nothing (Stock Available)  | No Operation                          | Ends workflow silently if in stock| Product In Stock? (True branch)    | None                             | ### üì¨ **SECTION 3: Decision & Notification**                                                  |
| Email Supplier (Out of Stock Alert) | Gmail (OAuth2)                     | Sends alert email if out of stock  | Product In Stock? (False branch)   | None                             | ### üì¨ **SECTION 3: Decision & Notification**                                                  |
| Sticky Note                   | Sticky Note                           | Documentation and notes            | None                               | None                             | Covers sections and overall workflow explanation                                              |

---

### 4. Reproducing the Workflow from Scratch

1. **Create Schedule Trigger Node**  
   - Name: `Check Stock Every X Hours`  
   - Type: Schedule Trigger  
   - Set to trigger daily at 9:00 AM (triggerAtHour=9)  

2. **Create Set Node**  
   - Name: `Define Product URL`  
   - Type: Set  
   - Add a string field named `Product url` with the full Amazon product URL as value  
   - Connect output of `Check Stock Every X Hours` to this node‚Äôs input  

3. **Add MCP Client Tool Node**  
   - Name: `Bright Data MCP (Scraper)`  
   - Type: MCP Client Tool  
   - Select tool name: `web_data_amazon_product`  
   - Set operation to `executeTool`  
   - Input tool parameters: Use dynamic JSON from AI override or leave blank if manually configuring  
   - Configure MCP credentials with valid Bright Data MCP API key  

4. **Add OpenAI Chat Model Node**  
   - Name: `OpenAI (Chat)`  
   - Type: Langchain OpenAI Chat Model  
   - Model: `gpt-4o-mini`  
   - Link OpenAI API credentials with valid API key  

5. **Add Auto-fixing Output Parser Node**  
   - Name: `Auto-fixing Output Parser`  
   - Type: Langchain Output Parser Autofixing  
   - Default options  

6. **Add Structured Output Parser Node**  
   - Name: `Structured Output Parser`  
   - Type: Langchain Structured Output Parser  
   - Provide JSON schema example matching expected product data fields (availability, product title, price, etc.)  

7. **Add Second OpenAI Chat Model Node**  
   - Name: `OpenAI Chat Model`  
   - Type: Langchain OpenAI Chat Model  
   - Model: `gpt-4o-mini`  
   - Connect with same OpenAI API credentials  

8. **Add Langchain AI Agent Node**  
   - Name: `Scrape Product Data (via Agent)`  
   - Type: Langchain AI Agent  
   - Configure prompt to instruct scraping of Amazon product page URL passed in `Product url`  
   - Connect inputs:  
     - From `Define Product URL` (main input)  
     - From `Bright Data MCP (Scraper)` (AI tool input)  
     - From `OpenAI (Chat)` (AI languageModel input)  
     - From `Auto-fixing Output Parser` (AI outputParser input)  

9. **Create If Node**  
   - Name: `Product In Stock?`  
   - Type: If  
   - Condition: Check if `output.availability` equals `"In Stock"` (string, case-sensitive)  
   - Input: Connect from `Scrape Product Data (via Agent)`  

10. **Add No Operation Node**  
    - Name: `Do Nothing (Stock Available)`  
    - Type: No Operation  
    - Connect as True branch output of `Product In Stock?`  

11. **Add Gmail Node**  
    - Name: `Email Supplier (Out of Stock Alert)`  
    - Type: Gmail (OAuth2)  
    - Configure:  
      - Send To: `shahkar.genai@gmail.com`  
      - Subject: `Product "{{ $json.output.product.title }}" is out of stock` (dynamic expression)  
      - Message: `The product is out of stock so I need 50 more products`  
    - Connect as False branch output of `Product In Stock?`  
    - Set up Gmail OAuth2 credentials  

12. **Connect Flow**  
    - `Check Stock Every X Hours` ‚Üí `Define Product URL` ‚Üí `Scrape Product Data (via Agent)` ‚Üí `Product In Stock?` ‚Üí True ‚Üí `Do Nothing (Stock Available)`  
    - `Product In Stock?` ‚Üí False ‚Üí `Email Supplier (Out of Stock Alert)`  

---

### 5. General Notes & Resources

| Note Content                                                                                                                                                                                                 | Context or Link                                                                                     |
|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------|
| This workflow uses Bright Data MCP for mobile carrier proxy scraping to avoid Amazon blocks and obtain mobile-specific stock information.                                                                      | Bright Data: https://brightdata.com/                                                              |
| OpenAI GPT-4o-mini model is used for parsing and AI agent tasks to improve scraping accuracy and structured data extraction.                                                                                   | OpenAI API: https://platform.openai.com/                                                         |
| To monitor multiple products, replace the ‚ÄúDefine Product URL‚Äù node with a Google Sheets node to loop over product URLs for bulk monitoring.                                                                   | General workflow extension idea                                                                    |
| Gmail node requires OAuth2 credentials configured for secure email sending.                                                                                                                                     | Gmail OAuth2 docs: https://developers.google.com/identity/protocols/oauth2                            |
| For support or questions, contact Yaron Been: [YouTube](https://www.youtube.com/@YaronBeen/videos), [LinkedIn](https://www.linkedin.com/in/yaronbeen/)                                                        | Workflow assistance note                                                                           |
| Affiliate link for Bright Data MCP that helps support free content creation: https://get.brightdata.com/1tndi4600b25                                                                                           | Affiliate link                                                                                     |

---

**Disclaimer:** The provided text originates exclusively from an automated workflow created with n8n, an integration and automation tool. This process strictly adheres to current content policies and contains no illegal, offensive, or protected elements. All data handled is legal and publicly accessible.