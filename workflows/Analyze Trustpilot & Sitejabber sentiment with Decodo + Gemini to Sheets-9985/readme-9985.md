Analyze Trustpilot & Sitejabber sentiment with Decodo + Gemini to Sheets

https://n8nworkflows.xyz/workflows/analyze-trustpilot---sitejabber-sentiment-with-decodo---gemini-to-sheets-9985


# Analyze Trustpilot & Sitejabber sentiment with Decodo + Gemini to Sheets

### 1. Workflow Overview

This workflow automates the process of scraping, analyzing, and summarizing customer reviews for a business from two major review platforms: **Trustpilot** and **Sitejabber**. It is designed to produce structured, spreadsheet-ready JSON data combined with a concise sentiment summary generated by AI (Google Gemini). The final output is appended as a new row in a Google Sheets spreadsheet for easy tracking and further analysis.

The workflow is logically divided into the following blocks:

- **1.1 Input Reception**: Collects the business name or URL via a form trigger.
- **1.2 Configuration Setup**: Sets key configuration variables such as business name and Google Sheets IDs.
- **1.3 Review Scraping and Structured Data Extraction**: Uses the Decodo node (community node) to scrape reviews, followed by an AI agent enforcing a strict JSON schema.
- **1.4 Sentiment Analysis and Recommendations**: Runs a Google Gemini language model node to generate a natural-language summary and recommendations based on reviews.
- **1.5 Data Merging and Formatting**: Combines structured data and AI summary into one JSON object.
- **1.6 Data Persistence**: Appends the merged data to a Google Sheets spreadsheet for record-keeping.

---

### 2. Block-by-Block Analysis

#### 2.1 Input Reception

- **Overview:**  
  Captures user input via a web form to initiate a business review lookup.

- **Nodes Involved:**  
  - Trigger: Business Review Form  
  - Sticky Note2 (Instructional)

- **Node Details:**

  - **Trigger: Business Review Form**  
    - *Type:* Form Trigger  
    - *Role:* Entry point of the workflow; collects a required field "Business Name or URL" through a simple form interface.  
    - *Configuration:* One required field labeled "Business Name or URL".  
    - *Connections:* Outputs JSON containing user input to "Set: Config Variables".  
    - *Edge Cases:* Missing or malformed input; the form enforces required field validation. No webhook authentication configured, so open access.  

  - **Sticky Note2**  
    - *Content:* "Use one required field: Business Name or URL."  
    - *Role:* Instruction for users setting up or triggering this form.

---

#### 2.2 Configuration Setup

- **Overview:**  
  Stores key variables needed throughout the workflow, such as the business name, Google Sheets document ID, and sheet ID.

- **Nodes Involved:**  
  - Set: Config Variables  
  - Sticky Note3 (Instructional)

- **Node Details:**

  - **Set: Config Variables**  
    - *Type:* Set node  
    - *Role:* Assigns workflow variables from form input and static values for Google Sheets integration.  
    - *Configuration:*  
      - `business_name`: from form input `"Business Name or URL"`  
      - `chatInput`: a prompt template string referencing business name (though note it references `$json['Business Name']` which might be a mismatch)  
      - `spreadsheet_id`: placeholder `"(YOUR_SPREADSHEET_ID)"` to be replaced by user  
      - `sheet_id`: placeholder `"(YOUR_SHEET_ID)"` to be replaced by user  
    - *Connections:* Passes data to the "Agent: Business Review Scanner" node.  
    - *Edge Cases:* User must replace spreadsheet and sheet IDs; otherwise, Google Sheets append will fail.  
    - *Expression Notes:* Uses `={{ }}` expressions to dynamically assign values.  

  - **Sticky Note3**  
    - *Content:* "Make sure to replace (YOUR_SPREADSHEET_ID) and (YOUR_SHEET_ID) with your own ID."  
    - *Role:* Setup reminder for users configuring the workflow.

---

#### 2.3 Review Scraping and Structured Data Extraction

- **Overview:**  
  Scrapes public reviews from Trustpilot and Sitejabber using Decodo, parses the output into a strict JSON format via an AI agent, and enforces data quality rules.

- **Nodes Involved:**  
  - Decodo Review Scraper  
  - Agent: Business Review Scanner  
  - Parse: Structured JSON Output  
  - Set: Output Fields  
  - Sticky Note4 (Decodo usage)  
  - Sticky Note5 (Schema enforcement)  
  - Sticky Note1 (Disclaimer about community node)  
  - Sticky Note7 (General overview)

- **Node Details:**

  - **Decodo Review Scraper**  
    - *Type:* Decodo Tool (community node)  
    - *Role:* Scrapes business review data from Trustpilot and Sitejabber.  
    - *Configuration:* No parameters set explicitly in JSON; uses default Decodo scraping for these sources.  
    - *Connections:* Outputs raw scraping results to the "Agent: Business Review Scanner" node as an AI tool.  
    - *Edge Cases:* Requires Decodo API credentials configured; errors include auth failures, API limits, or data unavailability.  
    - *Sticky Note4:* Notes it is a community node for self-hosted n8n, requiring Decodo API credentials.

  - **Agent: Business Review Scanner**  
    - *Type:* Langchain Agent node  
    - *Role:* Orchestrates review scraping, applies a strict output schema, and generates structured JSON summarizing company info and reviews.  
    - *Configuration:*  
      - System message defines task to scrape Trustpilot and Sitejabber only.  
      - Output parser enabled with strict JSON schema (as per "Parse: Structured JSON Output" node).  
      - Output rules enforce flat JSON, max 10 reviews per source, missing data as "Data not found".  
      - Required output structure includes fields like `business_name`, `industry_field`, `trustpilot_reviews`, etc.  
    - *Connections:* Receives Decodo output as AI tool input; outputs parsed JSON to "Set: Output Fields".  
    - *Edge Cases:* Failure modes include AI model errors, parsing failures, or missing fields; strict schema helps mitigate inconsistent data.

  - **Parse: Structured JSON Output**  
    - *Type:* Langchain Output Parser Structured JSON  
    - *Role:* Validates and parses AI output into structured JSON following an example schema.  
    - *Configuration:* Uses a detailed JSON example schema with fields for business info and reviews from Trustpilot and Sitejabber.  
    - *Connections:* Output parser input from Agent node; output back to Agent node as AI output parser.  
    - *Edge Cases:* Parsing errors if AI output is malformed or deviates from schema.

  - **Set: Output Fields**  
    - *Type:* Set node  
    - *Role:* Maps parsed JSON fields from the agent output into explicit fields under `output.*` for downstream processing.  
    - *Configuration:* Assigns fields like `output.business_name`, `output.industry_field`, `output.trustpilot_reviews`, etc.  
    - *Connections:* Receives from Agent; outputs to LLM: Summarize & Recommendations and Merge node.  
    - *Edge Cases:* Missing fields in parsed JSON would propagate as null or empty values.

  - **Sticky Note1**  
    - *Content:* "Disclaimer: This workflow relies on a community Decodo node and therefore requires self-hosted n8n. Install the node from the community marketplace and configure the Decodo API credential."  
    - *Role:* Setup warning.

  - **Sticky Note5**  
    - *Content:* "Keep the provided schema. Output must be strictly flat JSON."  
    - *Role:* Reminder about output format compliance.

  - **Sticky Note7**  
    - *Content:* "Self-hosted template using a community Decodo node. Scrapes reviews, produces flat JSON, summarizes with Gemini, and appends results to Google Sheets."  
    - *Role:* General workflow summary.

---

#### 2.4 Sentiment Analysis and Recommendations

- **Overview:**  
  Uses a Google Gemini language model node to generate a concise sentiment summary and recommendations based on the structured review data.

- **Nodes Involved:**  
  - LLM: Summarize & Recommendations  
  - Sticky Note (general context in Sticky Note6)  

- **Node Details:**

  - **LLM: Summarize & Recommendations**  
    - *Type:* Langchain Google Gemini node  
    - *Role:* Accepts structured reviews from previous step and produces a natural-language conclusion, improvement suggestions, and overall sentiment.  
    - *Configuration:*  
      - Model: `models/gemini-2.5-flash`  
      - Prompt message includes conditional logic to detect missing sources and add "There's no data in this website" message accordingly.  
      - Inputs Trustpilot, Sitejabber, and ResellerRatings reviews JSON strings (ResellerRatings may be empty or not scraped here).  
    - *Connections:* Input from "Set: Output Fields" (via main connection). Output to "Merge: Business Data + Review Summary".  
    - *Edge Cases:* AI model failures or timeout; missing data handled gracefully via prompt logic.

  - **Sticky Note6**  
    - *Content:* "Google Sheets columns for mapping (suggested): business_name, industry_field, company_summary, overall_sentiment, summary_text, trustpilot_url, sitejabber_url"  
    - *Role:* Guidance for downstream Google Sheets mapping.

---

#### 2.5 Data Merging and Formatting

- **Overview:**  
  Combines the structured business data with the AI-generated summary into a single JSON object for insertion into Google Sheets.

- **Nodes Involved:**  
  - Merge: Business Data + Review Summary  

- **Node Details:**

  - **Merge: Business Data + Review Summary**  
    - *Type:* Merge node  
    - *Role:* Combines two JSON objects by position: one with business data, one with AI summary.  
    - *Configuration:* Mode set to "combine" by position, merging the two incoming inputs into one unified output.  
    - *Connections:* Receives:  
      - From "LLM: Summarize & Recommendations" (main output)  
      - From "Set: Output Fields" (main output, mapped as second input)  
    - *Outputs:* Passes combined JSON to "Google Sheets: Append Results".  
    - *Edge Cases:* Misalignment of inputs could cause data mismatch; using combine by position mitigates key conflicts.

---

#### 2.6 Data Persistence

- **Overview:**  
  Appends the merged data as a new row in a configured Google Sheets spreadsheet for ongoing record-keeping and analysis.

- **Nodes Involved:**  
  - Google Sheets: Append Results  

- **Node Details:**

  - **Google Sheets: Append Results**  
    - *Type:* Google Sheets node  
    - *Role:* Appends one row to a specific sheet in a Google Sheets document.  
    - *Configuration:*  
      - Operation: Append  
      - Document ID: Dynamically assigned from `spreadsheet_id` set earlier.  
      - Sheet ID: Dynamically assigned from `sheet_id` set earlier.  
      - Mapping Mode: "Define below" (user to map columns explicitly).  
      - Columns: Empty in JSON, expecting user to define columns matching output fields.  
    - *Connections:* Input from "Merge: Business Data + Review Summary".  
    - *Edge Cases:* Google Sheets API errors, permission issues, invalid IDs, or schema mismatch can cause append failure.

---

### 3. Summary Table

| Node Name                       | Node Type                                    | Functional Role                               | Input Node(s)                                   | Output Node(s)                         | Sticky Note                                                                                              |
|--------------------------------|----------------------------------------------|-----------------------------------------------|------------------------------------------------|---------------------------------------|--------------------------------------------------------------------------------------------------------|
| Trigger: Business Review Form   | Form Trigger                                 | Entry point collecting business name or URL  | —                                              | Set: Config Variables                 | Use one required field: Business Name or URL.                                                          |
| Set: Config Variables           | Set                                          | Stores business name and Google Sheets IDs    | Trigger: Business Review Form                   | Agent: Business Review Scanner        | Make sure to replace (YOUR_SPREADSHEET_ID) and (YOUR_SHEET_ID) with your own ID.                        |
| Decodo Review Scraper           | Decodo Tool (community node)                  | Scrapes reviews from Trustpilot & Sitejabber  | Agent: Business Review Scanner (ai_tool input) | Agent: Business Review Scanner        | Community node; works on self-hosted n8n. Make sure to add your Decodo API credentials.                  |
| Agent: Business Review Scanner  | Langchain Agent                              | Orchestrates scraping, schema enforcement      | Set: Config Variables, Decodo Review Scraper   | Set: Output Fields                    | Disclaimer: This workflow relies on a community Decodo node and requires self-hosted n8n.               |
| Parse: Structured JSON Output   | Langchain Output Parser (Structured JSON)    | Validates and parses AI output to strict JSON | Agent: Business Review Scanner (ai_outputParser) | Agent: Business Review Scanner        | Keep the provided schema. Output must be strictly flat JSON.                                           |
| Set: Output Fields              | Set                                          | Maps parsed JSON fields explicitly             | Agent: Business Review Scanner                   | LLM: Summarize & Recommendations, Merge: Business Data + Review Summary |                                                                                                        |
| LLM: Summarize & Recommendations | Langchain Google Gemini                      | Generates sentiment summary and recommendations | Set: Output Fields                               | Merge: Business Data + Review Summary | Google Sheets columns for mapping (suggested): business_name, industry_field, company_summary, overall_sentiment, summary_text, trustpilot_url, sitejabber_url |
| Merge: Business Data + Review Summary | Merge                                      | Combines structured data and AI summary        | LLM: Summarize & Recommendations, Set: Output Fields | Google Sheets: Append Results         |                                                                                                        |
| Google Sheets: Append Results   | Google Sheets                                | Appends combined data as a new row             | Merge: Business Data + Review Summary            | —                                     |                                                                                                        |
| Sticky Note                     | Sticky Note                                  | Workflow overview and instructions              | —                                              | —                                     | See next section for full content.                                                                     |
| Sticky Note1                   | Sticky Note                                  | Disclaimer about Decodo community node usage   | —                                              | —                                     | Disclaimer about community Decodo node and self-hosted n8n requirement.                                |
| Sticky Note2                   | Sticky Note                                  | Instruction on form field requirement           | —                                              | —                                     | Use one required field: Business Name or URL.                                                          |
| Sticky Note3                   | Sticky Note                                  | Reminder to replace Google Sheets IDs           | —                                              | —                                     | Make sure to replace (YOUR_SPREADSHEET_ID) and (YOUR_SHEET_ID) with your own ID.                        |
| Sticky Note4                   | Sticky Note                                  | Note on Decodo node usage and credentials       | —                                              | —                                     | Community node; works on self-hosted n8n. Make sure to add your Decodo API credentials.                  |
| Sticky Note5                   | Sticky Note                                  | Reminder on keeping the JSON schema             | —                                              | —                                     | Keep the provided schema. Output must be strictly flat JSON.                                           |
| Sticky Note6                   | Sticky Note                                  | Google Sheets column mapping suggestions         | —                                              | —                                     | Google Sheets columns for mapping (suggested): business_name, industry_field, company_summary, overall_sentiment, summary_text, trustpilot_url, sitejabber_url |
| Sticky Note7                   | Sticky Note                                  | General workflow summary                         | —                                              | —                                     | Self-hosted template using a community Decodo node. Scrapes reviews, produces flat JSON, summarizes with Gemini, and appends results to Google Sheets. |

---

### 4. Reproducing the Workflow from Scratch

1. **Create a Form Trigger node:**  
   - Name: `Trigger: Business Review Form`  
   - Type: Form Trigger  
   - Configure a form with one required field labeled "Business Name or URL".  
   - This node acts as the entry point for user input.

2. **Create a Set node:**  
   - Name: `Set: Config Variables`  
   - Type: Set  
   - Assign the following fields:  
     - `business_name` → expression: `={{ $json["Business Name or URL"] }}` (from form input)  
     - `chatInput` → string: `"I’d like to know more about the business reputation of {{ $json['Business Name'] }}. Please summarize the company profile and collect recent customer reviews"` (Note: check variable name consistency)  
     - `spreadsheet_id` → string: `"(YOUR_SPREADSHEET_ID)"` (replace with your actual Google Sheets document ID)  
     - `sheet_id` → string: `"(YOUR_SHEET_ID)"` (replace with your actual Google Sheets sheet ID)  
   - Connect the output of the form trigger to this node.

3. **Add the Decodo Review Scraper node:**  
   - Name: `Decodo Review Scraper`  
   - Type: `@decodo/n8n-nodes-decodo.decodoTool` (community node)  
   - No additional parameters needed; it scrapes Trustpilot and Sitejabber by default.  
   - Ensure Decodo API credentials are configured in n8n Credential Manager.  
   - This node will be connected as an AI tool input to the agent node (next step).

4. **Create the Agent node:**  
   - Name: `Agent: Business Review Scanner`  
   - Type: `@n8n/n8n-nodes-langchain.agent`  
   - Configure the system message with detailed instructions:  
     - Limit scraping to Trustpilot and Sitejabber via Decodo.  
     - Enforce strict JSON output with max 10 reviews per source.  
     - Return fields: business_name, industry_field, company_summary, reviews arrays, overall_sentiment, source_links.  
     - Output must be flat JSON, no markdown or extraneous text.  
   - Enable output parser and link it to the structured JSON output parser node.  
   - Connect the Set node (`Set: Config Variables`) main output to this agent’s main input.  
   - Connect the Decodo Review Scraper node output as AI tool input to this agent.  

5. **Add Parse: Structured JSON Output node:**  
   - Name: `Parse: Structured JSON Output`  
   - Type: `@n8n/n8n-nodes-langchain.outputParserStructured`  
   - Configure the JSON schema example exactly as provided (including fields for business info, reviews, and URLs).  
   - Connect this node as the AI output parser input for the agent node.

6. **Create a Set node to map output fields:**  
   - Name: `Set: Output Fields`  
   - Type: Set  
   - Map the parsed JSON fields from the agent output to explicit fields prefixed with `output.` (e.g., `output.business_name`, `output.trustpilot_reviews`).  
   - Connect the main output of the agent node to this node.

7. **Add the Google Gemini language model node:**  
   - Name: `LLM: Summarize & Recommendations`  
   - Type: `@n8n/n8n-nodes-langchain.googleGemini`  
   - Set model to `models/gemini-2.5-flash`.  
   - Prepare prompt message that analyzes Trustpilot, Sitejabber, and ResellerRatings (even if empty), instructs to add "There's no data in this website" if missing, and requests conclusion and recommendations.  
   - Connect the output of `Set: Output Fields` node to this node.

8. **Add a Merge node to combine data:**  
   - Name: `Merge: Business Data + Review Summary`  
   - Type: Merge  
   - Configure mode as "combine" by position.  
   - Connect outputs of `Set: Output Fields` (input 2) and `LLM: Summarize & Recommendations` (input 1) to this node.

9. **Create a Google Sheets node to append results:**  
   - Name: `Google Sheets: Append Results`  
   - Type: Google Sheets  
   - Operation: Append  
   - Document ID: set dynamically to `={{ $('Set: Config Variables').item.json.spreadsheet_id }}`  
   - Sheet ID: set dynamically to `={{ $('Set: Config Variables').item.json.sheet_id }}`  
   - Set mapping mode to "Define below" and map columns explicitly to the output fields, e.g., business_name, company_summary, overall_sentiment, summary_text from AI summary, trustpilot_url, sitejabber_url, etc.  
   - Connect the output of the Merge node to this Google Sheets node.

10. **Add sticky notes (optional but recommended) for instructions and disclaimers:**  
    - Include notes about the community Decodo node requirement, credential setup, replacing Google Sheet IDs, required input fields, and output schema adherence.  
    - Use notes similar to those present in the original workflow for ease of maintenance and onboarding.

11. **Credentials setup:**  
    - Add and configure credentials for:  
      - Decodo API (community node credential)  
      - Google OAuth2 credentials for Google Sheets node  
      - Google Gemini API credentials for Langchain nodes

12. **Testing and activation:**  
    - Activate the workflow.  
    - Open the form URL, submit a business name or URL, and verify that a row is appended in the specified Google Sheets document with structured review data and AI summary.

---

### 5. General Notes & Resources

| Note Content                                                                                                                         | Context or Link                                                                                      |
|--------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------|
| Sign up for Decodo [HERE](https://visit.decodo.com/discount) for a discount on API access.                                           | Decodo API registration and discount link                                                          |
| This workflow requires self-hosted n8n due to reliance on the community Decodo node available in the n8n community marketplace.      | Community node usage disclaimer                                                                     |
| Recommended Google Sheets columns: business_name, industry_field, company_summary, overall_sentiment, summary_text, trustpilot_url, sitejabber_url | For user to configure Google Sheets columns mapping                                                |
| The workflow is ideal for marketing teams, growth analysts, founders, and agencies needing repeatable, automated reputation analysis. | Use case description                                                                                |
| Keep the JSON output strictly flat and conforming to the provided schema to ensure seamless spreadsheet integration and parsing.      | Critical integration note to avoid data parsing issues                                             |

---

**Disclaimer:** This analysis is based exclusively on the provided n8n workflow JSON for an automated business review sentiment analysis process involving Decodo and Google Gemini. All nodes and instructions comply with standard n8n capabilities and the community Decodo node requirements.