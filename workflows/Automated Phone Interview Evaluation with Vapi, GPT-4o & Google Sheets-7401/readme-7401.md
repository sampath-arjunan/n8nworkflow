Automated Phone Interview Evaluation with Vapi, GPT-4o & Google Sheets

https://n8nworkflows.xyz/workflows/automated-phone-interview-evaluation-with-vapi--gpt-4o---google-sheets-7401


# Automated Phone Interview Evaluation with Vapi, GPT-4o & Google Sheets

---

### 1. Workflow Overview

This workflow automates the evaluation of phone interviews conducted for a $17/hour driving job in Massachusetts, integrating Vapi.ai phone interview data, GPT-4o AI models for transcript analysis, and Google Sheets for result storage. It is designed to:

- Receive phone interview transcripts via webhook from Vapi.ai.
- Use AI to evaluate candidate eligibility based on strict predefined criteria.
- Convert AI output into structured JSON.
- Append candidate evaluation results to a Google Sheet for record-keeping.

The workflow is logically divided into these blocks:

- **1.1 Input Reception:** Captures incoming webhook data containing the phone interview transcript.
- **1.2 Transcript Preparation:** Extracts and formats the transcript field for AI processing.
- **1.3 AI Candidate Evaluation:** Uses an AI agent node with a system prompt to assess candidate qualification based on domain-specific criteria.
- **1.4 Output Processing:** Converts the AI output string into valid JSON format.
- **1.5 Data Storage:** Appends the structured candidate data into a Google Sheets document.
- **1.6 Documentation & Support:** Includes sticky notes with setup instructions, prerequisites, and contact info.

---

### 2. Block-by-Block Analysis

#### 2.1 Input Reception

- **Overview:** Receives webhook POST requests from the phone interview system (Vapi.ai), containing detailed call transcripts and metadata.
- **Nodes Involved:** `Webhook`
  
##### Node: Webhook
- **Type & Role:** Built-in n8n Webhook node; entry point for the workflow.
- **Configuration:**  
  - HTTP Method: POST  
  - Path: Unique webhook ID (auto-generated by n8n)  
- **Key Expressions:** None; raw JSON payload received.
- **Input/Output:** No input; outputs full webhook JSON body including interview transcript and call metadata.
- **Version Requirements:** n8n v2+ recommended for Webhook node v2.
- **Failure Modes:**  
  - Missing or malformed webhook data.  
  - Network or authentication issues if protected.
- **Sub-workflow:** None.

---

#### 2.2 Transcript Preparation

- **Overview:** Extracts the transcript string from the nested webhook JSON payload and assigns it to a simplified JSON path for downstream AI nodes.
- **Nodes Involved:** `Edit Fields2`
  
##### Node: Edit Fields2
- **Type & Role:** Set node; prepares data structure by assigning `body.message.artifact.transcript` to a top-level JSON field for easier reference.
- **Configuration:**  
  - Assigns `body.message.artifact.transcript` to the same path (string type).  
- **Key Expressions:**  
  - `={{ $json.body.message.artifact.transcript }}`
- **Input/Output:** Input from `Webhook`; outputs simplified JSON with transcript string.
- **Failure Modes:**  
  - Missing transcript field in incoming data.  
  - Expression evaluation failures if JSON path is incorrect.
- **Sub-workflow:** None.

---

#### 2.3 AI Candidate Evaluation

- **Overview:** Evaluates the candidate’s phone interview transcript against strict hiring criteria using an AI agent node configured with a detailed system prompt.
- **Nodes Involved:** `Evaluate Candidate`
  
##### Node: Evaluate Candidate
- **Type & Role:** LangChain Agent node specialized for AI-driven text evaluation and decision-making.
- **Configuration:**  
  - Prompt includes system message specifying:  
    - Job details ($17/hr driving job in Massachusetts)  
    - Input variable `transcript` containing full interview text  
    - Seven yes/no criteria (license status, felony convictions, tickets, background check consent, drug test pass, work availability, residence in Massachusetts)  
    - Output JSON format with candidate details and qualification result  
  - Prompt requires output of **only** the specified JSON, no extra text or formatting.  
- **Key Expressions:**  
  - `"Transcript: {{ $json.body.message.artifact.transcript }}"`
- **Input/Output:** Input from `Edit Fields2`; outputs AI-generated JSON string.
- **Version Requirements:** Compatible with n8n LangChain nodes v1.8+; requires OpenAI API credentials with GPT-4o-mini model access.
- **Failure Modes:**  
  - API key invalid or quota exceeded.  
  - Model timeout or incomplete response.  
  - AI output not strictly conforming to JSON format.  
- **Sub-workflow:** None.

---

#### 2.4 Output Processing

- **Overview:** Ensures AI output is valid JSON by invoking a secondary AI agent prompt to convert or confirm the output format, preparing it for structured storage.
- **Nodes Involved:** `Convert to JSON`
  
##### Node: Convert to JSON
- **Type & Role:** LangChain Agent node used as a validator and converter to enforce strict JSON compliance.
- **Configuration:**  
  - Input text: `={{ $json.output }}` (AI output from `Evaluate Candidate`)  
  - System message instructs generating only valid JSON in the prescribed schema.  
  - Has output parser enabled to parse JSON response directly.
- **Input/Output:** Input from `Evaluate Candidate`; outputs parsed JSON object.
- **Failure Modes:**  
  - Conversion may fail if AI output is malformed.  
  - API rate limiting or connectivity issues.
- **Sub-workflow:** None.

---

#### 2.5 Data Storage

- **Overview:** Appends the structured candidate evaluation results to a designated Google Sheet for record-keeping and further processing.
- **Nodes Involved:** `Save to Google Sheets`
  
##### Node: Save to Google Sheets
- **Type & Role:** Google Sheets node for appending rows.
- **Configuration:**  
  - Operation: Append  
  - Spreadsheet ID: `18W1ZzPM__foVNjeapuxnon0ZtgxaQjncNaamuZOdUSo` (pre-created or template)  
  - Sheet: gid=0 (Sheet1)  
  - Columns mapped to JSON fields: `name`, `phone`, `cityState`, `qualifies`, `reasoning`  
  - Credentials: OAuth2 Google account authorized for the sheet.
- **Input/Output:** Input from `Convert to JSON`; no output.
- **Failure Modes:**  
  - OAuth token expiry or permission denied.  
  - Sheet not found or incorrect ID.  
  - Data type mismatches or empty fields.
- **Sub-workflow:** None.

---

#### 2.6 Documentation & Support

- **Overview:** Provides user-facing guidance, setup instructions, and contact information via sticky note nodes.
- **Nodes Involved:** `Sticky Note16`, `Sticky Note1`, `Sticky Note2`, `Sticky Note`
  
##### Node: Sticky Note16
- **Content:** Contact info for help or customization: email and LinkedIn of Robert Breen.

##### Node: Sticky Note1
- **Content:** Steps to customize evaluation criteria and connect to Vapi.ai phone interview system.

##### Node: Sticky Note2
- **Content:** Prerequisites including n8n, OpenAI, Google account, and phone interview system. Setup instructions for OpenAI API key and Google Sheet.

##### Node: Sticky Note
- **Content:** Instructions for importing the workflow JSON, configuring OpenAI and Google Sheets credentials, and setting up the webhook URL.

- **Type & Role:** Informational; no inputs/outputs.
- **Failure Modes:** Not applicable.

---

### 3. Summary Table

| Node Name          | Node Type                             | Functional Role                   | Input Node(s)       | Output Node(s)          | Sticky Note                                                                                                      |
|--------------------|-------------------------------------|---------------------------------|---------------------|-------------------------|------------------------------------------------------------------------------------------------------------------|
| Webhook            | n8n-nodes-base.webhook               | Receives phone interview webhook| None                | Edit Fields2            | See Sticky Note2 for prerequisites and setup instructions.                                                      |
| Edit Fields2       | n8n-nodes-base.set                   | Extracts transcript from payload| Webhook             | Evaluate Candidate       |                                                                                                                  |
| Evaluate Candidate  | @n8n/n8n-nodes-langchain.agent      | AI evaluates candidate transcript| Edit Fields2        | Convert to JSON          | See Sticky Note1 for customizing evaluation criteria.                                                           |
| Convert to JSON    | @n8n/n8n-nodes-langchain.agent      | Converts AI output to strict JSON| Evaluate Candidate   | Save to Google Sheets    |                                                                                                                  |
| Save to Google Sheets| n8n-nodes-base.googleSheets         | Stores evaluation results        | Convert to JSON     | None                    | See Sticky Note for Google Sheets credentials and spreadsheet setup.                                            |
| Sticky Note16      | n8n-nodes-base.stickyNote            | Contact info for support         | None                | None                    | Contact: robert@ynteractive.com, LinkedIn: https://www.linkedin.com/in/robert-breen-29429625/                   |
| Sticky Note1       | n8n-nodes-base.stickyNote            | Customization guidance           | None                | None                    | Instructions on evaluation criteria and Vapi.ai connection                                                      |
| Sticky Note2       | n8n-nodes-base.stickyNote            | Prerequisites & setup steps      | None                | None                    | Lists required accounts and API keys, links to Google Sheets template                                          |
| Sticky Note        | n8n-nodes-base.stickyNote            | Import & configure workflow      | None                | None                    | Step-by-step import and credential setup instructions                                                           |

---

### 4. Reproducing the Workflow from Scratch

1. **Create Webhook Node**
   - Type: Webhook (n8n-nodes-base.webhook)  
   - HTTP Method: POST  
   - Path: Choose unique endpoint path (auto-generated or custom)  
   - No credentials required  
   - This node receives incoming JSON from your phone interview system (e.g., Vapi.ai).

2. **Add 'Set' Node (Edit Fields2)**
   - Type: Set (n8n-nodes-base.set)  
   - Add an assignment:  
     - Field Name: `body.message.artifact.transcript` (string)  
     - Value Expression: `={{ $json.body.message.artifact.transcript }}`  
   - Connect Webhook node output to this node input.

3. **Add LangChain Agent Node for Candidate Evaluation (Evaluate Candidate)**
   - Type: LangChain Agent (`@n8n/n8n-nodes-langchain.agent`)  
   - Parameters:  
     - Text: `Transcript: {{ $json.body.message.artifact.transcript }}`  
     - System Message: Paste detailed evaluation criteria prompt specifying the 7 qualification criteria, input/output format, and rules as per the original.  
     - Prompt Type: define  
   - Credentials: Set up OpenAI API credentials with GPT-4o-mini model access.  
   - Connect `Edit Fields2` output to this node.

4. **Add LangChain Agent Node for JSON Conversion (Convert to JSON)**
   - Type: LangChain Agent (`@n8n/n8n-nodes-langchain.agent`)  
   - Parameters:  
     - Text: `={{ $json.output }}` (output from previous AI node)  
     - System Message: Prompt instructing to convert input to valid JSON with the exact schema.  
     - Enable Output Parser to parse JSON response.  
   - Credentials: Use same OpenAI API credential as above.  
   - Connect `Evaluate Candidate` output to this node.

5. **Add Google Sheets Node (Save to Google Sheets)**
   - Type: Google Sheets (n8n-nodes-base.googleSheets)  
   - Operation: Append  
   - Document ID: Use your Google Sheet ID (or copy from [template](https://docs.google.com/spreadsheets/d/18W1ZzPM__foVNjeapuxnon0ZtgxaQjncNaamuZOdUSo/edit))  
   - Sheet Name: `Sheet1` or `gid=0`  
   - Columns Mapping: Map fields `name`, `phone`, `cityState`, `qualifies`, `reasoning` to corresponding JSON keys from the previous node.  
   - Credentials: Set up Google OAuth2 credentials with access to the sheet.  
   - Connect `Convert to JSON` output to this node.

6. **Optional: Add Sticky Notes for User Guidance**
   - Add nodes of type `stickyNote` with content for:  
     - Contact info  
     - Setup instructions (OpenAI API, Google Sheets, webhook URL)  
     - Customization guide for evaluation criteria.

7. **Save and Activate Workflow**
   - Test by sending a sample POST request with a transcript in the expected JSON format to the webhook URL.  
   - Verify AI evaluation and Google Sheet append.

---

### 5. General Notes & Resources

| Note Content                                                                                                            | Context or Link                                                                                         |
|-------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------|
| Pre-made Google Sheets template for driver interview results: Copy and customize your own version.                      | https://docs.google.com/spreadsheets/d/18W1ZzPM__foVNjeapuxnon0ZtgxaQjncNaamuZOdUSo/edit              |
| OpenAI API setup instructions including API key generation.                                                             | https://platform.openai.com/                                                                           |
| Contact for workflow support and customization: Robert Breen, email and LinkedIn profile.                                | robert@ynteractive.com / https://www.linkedin.com/in/robert-breen-29429625/                            |
| Evaluation criteria and call flow script embedded in AI prompt to ensure consistent candidate screening according to rules.| Embedded in Evaluate Candidate node’s system prompt                                                     |
| Vapi.ai phone interview system integration requires webhook POST to n8n webhook URL with specific JSON payload structure.| Vapi.ai webhook configuration with URL obtained from n8n Webhook node                                 |

---

**Disclaimer:**  
The provided workflow arises solely from an automated n8n integration and complies fully with content policies. It does not contain any illegal, offensive, or protected content. All processed data is legal and public.

---