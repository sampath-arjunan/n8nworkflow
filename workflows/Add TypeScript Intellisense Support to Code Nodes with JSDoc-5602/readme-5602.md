Add TypeScript Intellisense Support to Code Nodes with JSDoc

https://n8nworkflows.xyz/workflows/add-typescript-intellisense-support-to-code-nodes-with-jsdoc-5602


# Add TypeScript Intellisense Support to Code Nodes with JSDoc

### 1. Workflow Overview

This workflow demonstrates how to enhance n8n’s Code nodes with TypeScript-style Intellisense support using JSDoc annotations. It is intended for users who want improved code authoring experience inside Code nodes by enabling intelligent code completion and type hints for key n8n data structures such as Workflow and Node.

The workflow is logically divided into these blocks:

- **1.1 Input Reception:** Receives a form submission to trigger the workflow.
- **1.2 Workflow Retrieval:** Fetches the current workflow’s JSON data via the n8n API.
- **1.3 Code Node with Intellisense:** Processes the workflow JSON with a Code node enhanced by JSDoc typedefs to provide Intellisense hints.
- **1.4 Result Display:** Outputs the processed results to a form for visual display.
- **1.5 Documentation Sticky Notes:** Multiple sticky notes provide contextual explanations and instructions.

---

### 2. Block-by-Block Analysis

#### 1.1 Input Reception

- **Overview:**  
  Triggers the workflow execution upon receiving a form submission from an external source or user interface.

- **Nodes Involved:**  
  - On form submission

- **Node Details:**  

  - **On form submission**  
    - Type: Form Trigger  
    - Role: Entry point of the workflow; listens for a form submit event titled "Test Code Node".  
    - Configuration: Minimal default options; webhook ID defined to receive HTTP form POST.  
    - Inputs: None (trigger node)  
    - Outputs: Connected to "Get This Workflow" node.  
    - Edge Cases: Failure to receive submission or webhook misconfiguration may prevent triggering.  
    - Version: 2.2  

#### 1.2 Workflow Retrieval

- **Overview:**  
  Retrieves the JSON data of this very workflow using the n8n API, enabling the Code node to operate on accurate metadata.

- **Nodes Involved:**  
  - Get This Workflow

- **Node Details:**  

  - **Get This Workflow**  
    - Type: n8n API Node  
    - Role: Fetches the current workflow details by ID using the n8n internal API credentials.  
    - Configuration: Operation = "get" with workflowId referencing current workflow’s ID via expression `={{ $workflow.id }}`.  
    - Inputs: Receives trigger from "On form submission".  
    - Outputs: Passes workflow JSON to "Code With Intellisense".  
    - Credentials: Uses "n8n unio API v1" credential for authentication.  
    - Edge Cases: API auth failure, invalid workflow ID, or connectivity issues may cause errors.  
    - Version: 1  

#### 1.3 Code Node with Intellisense

- **Overview:**  
  Processes the fetched workflow JSON using a Code node enhanced with JSDoc comments and typedefs to enable TypeScript-style Intellisense for Workflow and Node objects.

- **Nodes Involved:**  
  - Code With Intellisense

- **Node Details:**  

  - **Code With Intellisense**  
    - Type: Code Node (JavaScript)  
    - Role: Demonstrates JSDoc usage to define typedefs for Node and Workflow objects, then casts input JSON to these types to enable Intellisense hints while coding.  
    - Configuration: Contains inline JSDoc typedefs for Node and Workflow, uses inline casting with `@type` to help editor understand the data structure, and produces an HTML string output summarizing workflow properties and node details.  
    - Key Expressions:  
      - Inline JSDoc typedefs for `Node` and `Workflow`.  
      - Casting input JSON with `const wf = /** @type {Workflow} */ ($input.first().json);`  
    - Inputs: Receives JSON from "Get This Workflow".  
    - Outputs: Sends the HTML-formatted string to "Display Results".  
    - Edge Cases: Misconfiguration in JSDoc or invalid input JSON could cause runtime errors or missing Intellisense hints.  
    - Version: 2  

#### 1.4 Result Display

- **Overview:**  
  Displays the HTML-formatted output generated by the Code node in a form, illustrating the processed results.

- **Nodes Involved:**  
  - Display Results

- **Node Details:**  

  - **Display Results**  
    - Type: Form Node  
    - Role: Presents the formatted HTML output from the Code node as a response to the user or calling system.  
    - Configuration: Contains a single HTML field that renders the `result` property from input JSON.  
    - Inputs: Receives from "Code With Intellisense".  
    - Outputs: None (terminal node)  
    - Edge Cases: Display issues if HTML content is malformed or if input lacks `result` property.  
    - Version: 1  

#### 1.5 Documentation Sticky Notes

- **Overview:**  
  Provides contextual information, instructions, and explanations displayed on the workflow canvas to aid understanding.

- **Nodes Involved:**  
  - Sticky Note  
  - Sticky Note1  
  - Sticky Note2  
  - Sticky Note3

- **Node Details:**  

  - **Sticky Note**  
    - Role: Explains initial setup step for the workflow.  
    - Content: "## Setup\nJust get this workflow so we can show the Code node working."  
  - **Sticky Note1**  
    - Role: Explains the example usage of Intellisense in the Code node.  
    - Content: "## Example\nOpen the Code node and see how we've given Intellisense hints to Workflow and Node."  
  - **Sticky Note2**  
    - Role: Explains the output display usage.  
    - Content: "## Output\nPrint results -- illustrative use of HTML in Forms."  
  - **Sticky Note3**  
    - Role: High-level explanation of Code node Intellisense usage.  
    - Content: "## Code node with Intellisense!\nThis example shows how to get Intellisense for n8n classes. Great when debugging complex Code nodes."  
  - Edge Cases: None; purely informational.

---

### 3. Summary Table

| Node Name           | Node Type          | Functional Role                     | Input Node(s)         | Output Node(s)         | Sticky Note                                                                                     |
|---------------------|--------------------|-----------------------------------|-----------------------|-----------------------|------------------------------------------------------------------------------------------------|
| On form submission   | Form Trigger       | Entry trigger on form submit      |                       | Get This Workflow     |                                                                                                |
| Get This Workflow    | n8n API Node       | Retrieves current workflow JSON   | On form submission    | Code With Intellisense |                                                                                                |
| Code With Intellisense | Code Node        | Processes workflow JSON with JSDoc for Intellisense | Get This Workflow    | Display Results        |                                                                                                |
| Display Results      | Form Node          | Displays processed HTML output    | Code With Intellisense |                       |                                                                                                |
| Sticky Note         | Sticky Note        | Setup instructions                |                       |                       | ## Setup\nJust get this workflow so we can show the Code node working.                         |
| Sticky Note1        | Sticky Note        | Example usage explanation         |                       |                       | ## Example\nOpen the Code node and see how we've given Intellisense hints to Workflow and Node.|
| Sticky Note2        | Sticky Note        | Output display explanation        |                       |                       | ## Output\nPrint results -- illustrative use of HTML in Forms.                                 |
| Sticky Note3        | Sticky Note        | High-level Intellisense explanation |                       |                       | ## Code node with Intellisense!\nThis example shows how to get Intellisense for n8n classes. Great when debugging complex Code nodes. |

---

### 4. Reproducing the Workflow from Scratch

1. **Create the Trigger Node**  
   - Add a **Form Trigger** node.  
   - Set `Form Title` to "Test Code Node".  
   - Leave other options default.  
   - This node will provide the webhook URL to receive form submissions.

2. **Create the Workflow Retrieval Node**  
   - Add an **n8n API** node.  
   - Set `Operation` to `get`.  
   - For `workflowId`, use the expression: `{{$workflow.id}}` to dynamically fetch the current workflow ID.  
   - Set the credentials to a valid n8n API credential (e.g., "n8n unio API v1") to authorize the API call.  
   - Connect the **Form Trigger** node’s output to this node’s input.

3. **Create the Code Node with Intellisense Support**  
   - Add a **Code** node (JavaScript mode).  
   - Paste the following code snippet (adjusted for clarity):  

   ```javascript
   // Define JSDoc typedefs to enable Intellisense for Workflow and Node
   
   /**
    * @typedef {Object} Node
    * @property {string} type
    * @property {number} typeVersion
    * @property {number} id
    * @property {string} name
    */
   
   /**
    * @typedef {Object} Workflow
    * @property {string} name
    * @property {number} id
    * @property {boolean} isArchived
    * @property {Array<Node>} nodes
    */
   
   // Cast input JSON to Workflow type for Intellisense
   const wf = /** @type {Workflow} */ ($input.first().json);
   
   let output = "<p>Example:</p>";
   output += "<p>Workflow.id: " + wf.id + "</p>";
   output += "<p>Workflow.name: " + wf.name + "</p>";
   output += "<p>Workflow.isArchived: " + wf.isArchived + "</p>";
   
   for (let i = 0; i < wf.nodes.length; i++) {
     const node = wf.nodes[i];
     output += "<p>Workflow.nodes[" + i + "]: " + node.name + "</p>";
     output += "<p>Workflow.nodes[" + i + "]: " + node.type + "</p>";
   }
   
   return [{ json: { result: output } }];
   ```

   - Connect the output of the **n8n API** node to this Code node’s input.

4. **Create the Result Display Node**  
   - Add a **Form** node for output display.  
   - Configure it with a single form field of type `HTML`.  
   - Use the expression `{{ $json.result }}` to fill the HTML content from the Code node’s output.  
   - Connect the Code node’s output to this Form node.

5. **Add Sticky Notes for Documentation (Optional but Recommended)**  
   - Add multiple **Sticky Note** nodes with the following contents and place them near related nodes:  
     - Setup instructions for initial workflow retrieval.  
     - Explanation about the usage of Intellisense in the Code node.  
     - Explanation about output display using HTML in the form node.  
     - High-level note on the Code node Intellisense capability.

6. **Save and Activate the Workflow**  
   - Ensure all nodes are properly connected as follows:  
     `On form submission → Get This Workflow → Code With Intellisense → Display Results`  
   - Save the workflow and activate it.  
   - Submit the form to trigger the workflow and observe the output.

---

### 5. General Notes & Resources

| Note Content                                                                                          | Context or Link                                                                                  |
|-----------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------|
| This workflow demonstrates how to leverage JSDoc typedefs inside n8n Code nodes for TypeScript-style Intellisense, enhancing code authoring. | Core concept for advanced Code node users and debugging complex scripted workflows.            |
| The example output uses HTML rendering inside a Form node to illustrate formatted results.          | Shows flexibility of HTML content rendering in n8n forms.                                      |
| Workflow uses internal n8n API credentials to fetch its own metadata dynamically at runtime.        | Useful pattern for workflows that need self-inspection or introspection capabilities.          |
| For more on n8n Code node JSDoc support, see community discussions and official docs.                | https://docs.n8n.io/code-nodes/ and n8n community forums.                                       |

---

**Disclaimer:** The provided text originates exclusively from an automated workflow created with n8n, an integration and automation tool. This processing strictly adheres to current content policies and contains no illegal, offensive, or protected elements. All handled data is legal and public.