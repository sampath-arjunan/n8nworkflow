Automate Cold Outreach with Apollo, LinkedIn & Gmail Using GPT-4

https://n8nworkflows.xyz/workflows/automate-cold-outreach-with-apollo--linkedin---gmail-using-gpt-4-8449


# Automate Cold Outreach with Apollo, LinkedIn & Gmail Using GPT-4

### 1. Workflow Overview

This workflow automates cold outreach by integrating Apollo.io lead generation, LinkedIn connection requests, email outreach via Gmail, and AI-powered personalization using GPT-4. It is designed for B2B sales teams or marketers looking to efficiently generate and engage new leads based on user-defined criteria. The workflow processes form submissions specifying lead parameters, generates precise Apollo search URLs, scrapes leads via Apify, enriches data with LinkedIn and company profiles via Unipile API, verifies emails with ZeroBounce, and sends personalized LinkedIn invitations and outreach emails.

**Logical Blocks:**

- **1.1 Input Reception:** Captures user inputs from a form to define lead search criteria.  
- **1.2 Apollo Search URL Generation:** Uses GPT-4 to convert form inputs into an Apollo.io search URL, respecting complex multi-value fields.  
- **1.3 Lead Scraping via Apify:** Calls Apify API to scrape leads from Apollo using the generated URL and limits results to 10 leads per run.  
- **1.4 Data Enrichment:** Extracts LinkedIn user and company identifiers, then fetches detailed LinkedIn profiles and company data from Unipile API.  
- **1.5 CRM Integration:** Creates or updates lead contacts in HubSpot CRM with enriched data.  
- **1.6 AI Outreach Message Generation:** Uses GPT-4 mini model to generate personalized LinkedIn connection requests and email content based on lead and company info.  
- **1.7 Connection & Email Workflow:**  
  - Checks if the lead is already connected on LinkedIn; if not, sends a LinkedIn invitation via Unipile API.  
  - Verifies email validity using ZeroBounce API.  
  - If email is valid or catch-all, sends a personalized outreach email via Gmail.

---

### 2. Block-by-Block Analysis

#### 2.1 Input Reception

- **Overview:** Captures lead criteria from a user-submitted form, including job title, company size, keywords, and location.  
- **Nodes Involved:**  
  - `On form submission`

- **Node Details:**  
  - **On form submission**  
    - Type: Form Trigger  
    - Configuration: Form titled "Apollo + Apify Lead Generation" with fields for Job Title (text), Company Size (dropdown with size ranges), Keywords (text), Location (text).  
    - Inputs: None (triggered by HTTP form submission)  
    - Outputs: JSON containing form responses for downstream processing  
    - Edge Cases: Empty or malformed inputs, multi-value fields with improper separators, no submission  
    - Version: 2.2

---

#### 2.2 Apollo Search URL Generation

- **Overview:** Converts form input data into a precise Apollo.io search URL that handles multiple comma-separated values per field and URL encodes parameters.  
- **Nodes Involved:**  
  - `OpenAI Chat Model`  
  - `Apollo URL Generator`

- **Node Details:**  
  - **OpenAI Chat Model**  
    - Type: LangChain OpenAI Chat Model Node  
    - Configuration: Model set to GPT-4.1; no special prompt options beyond default.  
    - Credentials: OpenAI API  
    - Input: Triggered by form submission node output  
    - Output: Text prompt fed to Apollo URL Generator chain  
    - Edge Cases: API rate limits, malformed prompt, connectivity issues  
    - Version: 1.2

  - **Apollo URL Generator**  
    - Type: LangChain Chain LLM (prompt chain)  
    - Configuration: Custom prompt instructing to parse multi-value fields (Job Title, Keywords, Location) into Apollo URL parameters with correct encoding and formatting. Example provided in prompt for clarity.  
    - Input: Text generated by OpenAI Chat Model, containing form data variables  
    - Output: A single, exact Apollo.io search URL string  
    - Edge Cases: Incorrect parsing of multi-value fields, encoding errors, unexpected input format  
    - Version: 1.7

---

#### 2.3 Lead Scraping via Apify

- **Overview:** Uses the generated Apollo URL to invoke Apify actor for scraping lead details, then limits results to 10 leads per run to control volume.  
- **Nodes Involved:**  
  - `run apify`  
  - `Limit`

- **Node Details:**  
  - **run apify**  
    - Type: HTTP Request  
    - Configuration: POST request to Apify Apollo scraper API, sending JSON body with the Apollo URL under `url` key. Uses API key in Authorization header.  
    - Input: Apollo URL from previous block  
    - Output: JSON array of lead data objects  
    - Edge Cases: API errors, rate limits, invalid URL, network failures  
    - Version: 4.2

  - **Limit**  
    - Type: Limit node (native n8n)  
    - Configuration: Limits processing to max 10 items per execution  
    - Input: List of leads from Apify  
    - Output: Trimmed list of up to 10 leads for downstream processing  
    - Edge Cases: Empty results, fewer than 10 leads returned  
    - Version: 1

---

#### 2.4 Data Enrichment

- **Overview:** Extracts LinkedIn user and company public identifiers from scraped lead data, then fetches enriched LinkedIn profile and company information using Unipile API.  
- **Nodes Involved:**  
  - `public_identifiers`  
  - `scrape_profile`  
  - `company_profile`

- **Node Details:**  
  - **public_identifiers**  
    - Type: Set  
    - Configuration: Extracts LinkedIn user and company URL segments from lead JSON fields by splitting URLs and taking last path element.  
    - Input: Limited leads list  
    - Output: Adds `user` and `company_url` fields for each lead  
    - Edge Cases: Missing or malformed LinkedIn URLs, empty strings  
    - Version: 3.4

  - **scrape_profile**  
    - Type: HTTP Request  
    - Configuration: GET request to Unipile API endpoint for LinkedIn user profile, passing user identifier and account ID as query parameters, with API key in headers.  
    - Input: `user` parameter from previous node  
    - Output: Detailed LinkedIn profile JSON including relationship status  
    - Edge Cases: API errors, missing user, auth failure  
    - Version: 4.2

  - **company_profile**  
    - Type: HTTP Request  
    - Configuration: GET request to Unipile API endpoint for LinkedIn company profile, using company URL identifier and account ID with API key  
    - Input: `company_url` from public_identifiers node  
    - Output: Company description and data JSON  
    - Edge Cases: API errors, missing company, auth failure  
    - Version: 4.2

---

#### 2.5 CRM Integration

- **Overview:** Creates or updates lead contacts in HubSpot CRM with enriched data from Apify and Unipile.  
- **Nodes Involved:**  
  - `Create or update a contact`

- **Node Details:**  
  - Type: HubSpot node (CRM integration)  
  - Configuration: Uses HubSpot App Token authentication; maps lead fields such as email, name, company, industry, website, city, country, postal code, phone, company size from lead and enrichment data.  
  - Input: Company profile and scraped lead data  
  - Output: Confirmation of contact creation or update in HubSpot  
  - Edge Cases: API errors, data validation failures, duplicate contacts, auth errors  
  - Version: 2.1

---

#### 2.6 AI Outreach Message Generation

- **Overview:** Generates personalized LinkedIn connection request text and outreach email subject/body using GPT-4 mini, based on lead first name, company info, industry, and company description.  
- **Nodes Involved:**  
  - `OpenAI Chat Model4`  
  - `Structured Output Parser`  
  - `outreach_message`

- **Node Details:**  
  - **OpenAI Chat Model4**  
    - Type: LangChain OpenAI Chat Model  
    - Configuration: Model GPT-4.1-mini for cost-effective personalized text generation  
    - Credentials: OpenAI API  
    - Input: Concatenated lead/company data from previous nodes  
    - Output: Raw AI-generated JSON string with connection request and email fields  
    - Edge Cases: Parsing errors, API limit, incomplete data  
    - Version: 1.2

  - **Structured Output Parser**  
    - Type: LangChain Structured Output Parser  
    - Configuration: JSON schema example forcing output to have `connection_request` (â‰¤300 chars), and `email` with `subject` and `body` arrays  
    - Input: Raw AI output string  
    - Output: Parsed JSON object with structured outreach message  
    - Edge Cases: Parsing failures, invalid JSON from AI  
    - Version: 1.3

  - **outreach_message**  
    - Type: LangChain Agent Node  
    - Configuration: System message instructs professional B2B sales copywriting style with strict JSON output; input variables include lead first name, company name, website, industry, and company description  
    - Input: Parsed structured output  
    - Output: JSON with personalized LinkedIn message and email content  
    - Edge Cases: Missing fields, malformed AI output  
    - Version: 2.1

---

#### 2.7 Connection & Email Workflow

- **Overview:** Checks LinkedIn connection status and email validity to decide outreach actions. Sends LinkedIn invitations via Unipile API if not connected, and sends outreach emails via Gmail if the email is valid or catch-all.  
- **Nodes Involved:**  
  - `not_connected?`  
  - `send_linkedIn_invitation`  
  - `email_exists`  
  - `email_verifier`  
  - `If`  
  - `Send a message`

- **Node Details:**  
  - **not_connected?**  
    - Type: If node  
    - Configuration: Checks if lead's `is_relationship` JSON field is false (i.e., not connected)  
    - Input: LinkedIn profile data from `scrape_profile`  
    - Output: Branches to send LinkedIn invite or skip  
    - Edge Cases: Missing field, incorrect boolean interpretation  
    - Version: 2.2

  - **send_linkedIn_invitation**  
    - Type: HTTP Request  
    - Configuration: POST to Unipile API endpoint to send LinkedIn invite with provider ID, account ID, and personalized message from AI output  
    - Input: Not connected leads only  
    - Output: API response (ignored on error to avoid stopping workflow)  
    - Edge Cases: API failures, rate limits, invalid provider ID  
    - OnError: Continue regular output  
    - Version: 4.2

  - **email_exists**  
    - Type: If node  
    - Configuration: Checks if email field exists in lead data (non-null)  
    - Input: Lead data after LinkedIn invitation branch  
    - Output: Branches to email verification or skip  
    - Edge Cases: Missing or malformed email field  
    - Version: 2.2

  - **email_verifier**  
    - Type: HTTP Request  
    - Configuration: GET request to ZeroBounce API with API key and lead email for validation  
    - Input: Email from lead data  
    - Output: Validation status JSON (e.g., valid, catch-all, invalid)  
    - Edge Cases: API rate limit, invalid API key, network errors  
    - OnError: Continue error output to avoid workflow stop  
    - Version: 4.2

  - **If**  
    - Type: If node  
    - Configuration: Checks if ZeroBounce status is `valid` or `catch-all`  
    - Input: Email verification result  
    - Output: Branches to send email or skip  
    - Edge Cases: Unexpected status values  
    - Version: 2.2

  - **Send a message**  
    - Type: Gmail node  
    - Configuration: Sends email to lead email with subject and body from AI-generated outreach message  
    - Credentials: Gmail OAuth2  
    - Input: Validated leads with email content  
    - Output: Email send confirmation  
    - Edge Cases: Gmail API limits (500/day personal, 2000/day workspace), auth expiration, invalid email format  
    - Version: 2.1

---

### 3. Summary Table

| Node Name               | Node Type                            | Functional Role                      | Input Node(s)                      | Output Node(s)                      | Sticky Note                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|-------------------------|------------------------------------|------------------------------------|----------------------------------|-----------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| On form submission      | Form Trigger                       | Capture user lead search criteria  | None                             | OpenAI Chat Model, Apollo URL Generator | Describes overall workflow and step flow, including APIs needed, costs, and usage notes                                                                                                                                                                                                                                                                                                                                                                                             |
| OpenAI Chat Model       | LangChain OpenAI Chat Model        | Generate Apollo search URL prompt  | On form submission               | Apollo URL Generator               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| Apollo URL Generator    | LangChain Chain LLM                | Convert inputs to Apollo.io URL    | OpenAI Chat Model, On form submission | run apify                        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| run apify               | HTTP Request                      | Scrape leads from Apollo URL       | Apollo URL Generator             | Limit                            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| Limit                   | Limit Node                        | Limit leads to 10 per execution    | run apify                       | public_identifiers                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| public_identifiers      | Set Node                         | Extract LinkedIn user/company IDs  | Limit                          | scrape_profile                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| scrape_profile          | HTTP Request                     | Fetch LinkedIn user profile        | public_identifiers             | company_profile                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| company_profile         | HTTP Request                     | Fetch LinkedIn company profile     | scrape_profile                 | Create or update a contact       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| Create or update a contact | HubSpot                         | Add/update contact in CRM          | company_profile                | outreach_message                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| OpenAI Chat Model4      | LangChain OpenAI Chat Model        | Generate personalized outreach text| Create or update a contact      | outreach_message                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| Structured Output Parser | LangChain Structured Output Parser | Parse AI JSON output                | OpenAI Chat Model4             | outreach_message                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| outreach_message        | LangChain Agent                   | Produce LinkedIn request & email   | Structured Output Parser, Create or update a contact | not_connected?, email_exists    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| not_connected?          | If Node                          | Check LinkedIn connection status   | outreach_message               | send_linkedIn_invitation        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| send_linkedIn_invitation| HTTP Request                     | Send LinkedIn invite via Unipile   | not_connected?                 | None                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| email_exists            | If Node                          | Check if lead email exists         | outreach_message               | email_verifier, (empty branch)  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| email_verifier          | HTTP Request                     | Validate email via ZeroBounce      | email_exists                   | If                             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| If                      | If Node                          | Check email validity status        | email_verifier                 | Send a message, (empty branch)  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| Send a message          | Gmail                            | Send outreach email                | If                            | None                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| Sticky Note             | Sticky Note                      | Workflow explanation and notes     | None                          | None                           | #  Email Outreach + LinkedIn Connect\n\n##  How It Works (Step Flow)...\n\n##  APIs Needed\n\nDetails on Apify, Unipile, ZeroBounce, OpenAI, HubSpot, Gmail APIs including cost and usage.                                                                                                                                                                                                                                                                                                        |

---

### 4. Reproducing the Workflow from Scratch

1. **Create a Form Trigger node** named `On form submission`:  
   - Set form title: "Apollo + Apify Lead Generation"  
   - Add fields:  
     - Job Title (text input, placeholder example: "Founder, Engineer, Owner, CEO, Developer")  
     - Company Size (dropdown with options: 1-10, 11-50, 51-200, 201-1000, 5001-10000, 10001-5000, 10001-100000)  
     - Keywords (text input)  
     - Location (text input)  
   - This node triggers the workflow on user form submission.

2. **Add a LangChain OpenAI Chat Model node** named `OpenAI Chat Model`:  
   - Connect input from `On form submission`  
   - Select GPT-4.1 model  
   - Use OpenAI API credentials  
   - Purpose: To prepare prompt for Apollo URL generation.

3. **Add a LangChain Chain LLM node** named `Apollo URL Generator`:  
   - Connect input from `OpenAI Chat Model` and `On form submission` (main input)  
   - Configure prompt with instructions to generate Apollo search URL from form fields, handling multi-value fields as separate parameters and URL encoding (see prompt in original workflow).  
   - Use GPT-4.1 as model.  
   - Output: Apollo search URL string.

4. **Add HTTP Request node** named `run apify`:  
   - Connect input from `Apollo URL Generator`  
   - POST to `https://api.apify.com/v2/acts/code_crafter~apollo-io-scraper/run-sync-get-dataset-items`  
   - JSON body: `{ "cleanOutput": false, "url": "{{ $json.text }}" }` where `$json.text` is Apollo URL  
   - Headers: Authorization Bearer with Apify API key, Accept application/json  
   - Purpose: Scrape leads data from Apollo.

5. **Add a Limit node** named `Limit`:  
   - Connect input from `run apify`  
   - Set max items to 10  
   - Purpose: Limit leads processed per run.

6. **Add a Set node** named `public_identifiers`:  
   - Connect input from `Limit`  
   - Add two new fields extracting LinkedIn URL segments from each lead:  
     - `user` = last path segment of `linkedin_url` field  
     - `company_url` = last path segment of `organization.linkedin_url` field  
   - Purpose: Prepare identifiers for Unipile API calls.

7. **Add HTTP Request node** named `scrape_profile`:  
   - Connect input from `public_identifiers`  
   - GET request to Unipile LinkedIn user profile API:  
     - URL: `https://<subdomain>.unipile.com:<port>/api/v1/users/{{ $json.user }}`  
     - Query parameter: account_id = UNIPILE ACCOUNT ID  
     - Headers: Accept application/json, X-API-KEY = UNIPILE API KEY  
   - Purpose: Fetch LinkedIn profile details for lead.

8. **Add HTTP Request node** named `company_profile`:  
   - Connect input from `scrape_profile`  
   - GET request to Unipile LinkedIn company profile API:  
     - URL: `https://<subdomain>.unipile.com:<port>/api/v1/linkedin/company/{{ $json.company_url }}`  
     - Query parameter: account_id = UNIPILE ACCOUNT ID  
     - Headers: Accept application/json, X-API-KEY = UNIPILE API KEY  
   - Purpose: Fetch company profile data.

9. **Add HubSpot node** named `Create or update a contact`:  
   - Connect input from `company_profile`  
   - Use HubSpot App Token credentials  
   - Map fields: email, first name, last name, phone, city, country, postal code, industry, company name, website URL, company size from lead and enriched data  
   - Purpose: Add or update CRM contacts.

10. **Add LangChain OpenAI Chat Model node** named `OpenAI Chat Model4`:  
    - Connect input from `Create or update a contact`  
    - Use GPT-4.1-mini model for cost-effective personalized message generation  
    - Use OpenAI credentials.

11. **Add LangChain Structured Output Parser node** named `Structured Output Parser`:  
    - Connect input from `OpenAI Chat Model4` (ai_languageModel output)  
    - Configure JSON schema to parse connection request message and email subject/body.

12. **Add LangChain Agent node** named `outreach_message`:  
    - Connect input from `Structured Output Parser` and `Create or update a contact`  
    - Provide system message instructing professional B2B sales copywriting with strict JSON output.  
    - Inputs: first name, company name, website, industry, company description.  
    - Output: personalized LinkedIn connection request and email content.

13. **Add If node** named `not_connected?`:  
    - Connect input from `outreach_message`  
    - Condition: Check if `$('scrape_profile').item.json.is_relationship` is false (not connected on LinkedIn).

14. **Add HTTP Request node** named `send_linkedIn_invitation`:  
    - Connect input from `not_connected?` (true branch)  
    - POST to Unipile API endpoint for sending LinkedIn invites:  
      - URL: `https://<subdomain>.unipile.com:<port>/api/v1/users/invite`  
      - Body parameters: provider_id from scrape_profile, account_id, and message from outreach_message's connection_request  
      - Headers: Accept, Content-Type JSON, X-API-KEY  
    - On error: continue workflow without interruption.

15. **Add If node** named `email_exists`:  
    - Connect input from `outreach_message`  
    - Condition: Check if email exists (`$('Append or update row in sheet').item.json.email` or lead email is present).

16. **Add HTTP Request node** named `email_verifier`:  
    - Connect input from `email_exists` (true branch)  
    - GET request to ZeroBounce API:  
      - URL: `https://api.zerobounce.net/v2/validate`  
      - Query params: api_key, email from lead data  
    - On error: continue error output.

17. **Add If node** named `If`:  
    - Connect input from `email_verifier`  
    - Condition: Check if status is "valid" or "catch-all".

18. **Add Gmail node** named `Send a message`:  
    - Connect input from `If` (true branch)  
    - Configure with Gmail OAuth2 credentials  
    - Send email to lead email with subject and body from outreach_message's email output.

19. **Add Sticky Note**:  
    - Add a sticky note with workflow description, API info, step flow, and cost notes for documentation.

---

### 5. General Notes & Resources

| Note Content                                                                                                                                                                                                                                         | Context or Link                                                            |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------|
| Workflow uses multiple paid APIs (Apify, Unipile, ZeroBounce, OpenAI) with free tiers noted. Budgeting and API limits should be monitored to avoid interruptions.                                                                                     | Workflow Sticky Note                                                       |
| Apify actor for Apollo.io scraping costs approx. $1.20 per 1000 leads; free credits available.                                                                                                                                                        | Apify API details in Sticky Note                                          |
| Unipile API provides LinkedIn profile/company data and invitation sending, free trial for 7 days then paid.                                                                                                                                             | Unipile API info in Sticky Note                                           |
| ZeroBounce API validates email addresses; free 100/month, paid thereafter.                                                                                                                                                                            | ZeroBounce API info in Sticky Note                                        |
| OpenAI GPT-4 models used for search URL generation and message composition; cost-effective GPT-4-mini used for message generation.                                                                                                                   | OpenAI API info in Sticky Note                                            |
| HubSpot CRM integration requires App Token authentication for contact management.                                                                                                                                                                     | HubSpot API info in Sticky Note                                           |
| Gmail API limits apply: 500 emails/day personal, 2000/day workspace accounts; OAuth2 credentials required.                                                                                                                                             | Gmail API info in Sticky Note                                             |
| The workflow is not active by default; ensure all API keys, OAuth credentials, and account IDs are properly configured before execution.                                                                                                              | Workflow metadata                                                          |
| URL encoding and multi-value handling for Apollo URL generation is critical for correct lead scraping results.                                                                                                                                        | Apollo URL Generator prompt instructions                                 |
| LinkedIn connection status check is based on Unipile profile field `is_relationship` boolean; false triggers invitation sending.                                                                                                                     | Node `not_connected?` logic                                                |

---

**Disclaimer:** The provided text is extracted exclusively from an automated n8n workflow. It complies strictly with content policies, does not contain illegal or offensive elements, and only processes legal and publicly available data.