Sync Events from Excel to Google Calendar with GPT-4o-Mini Smart Summaries

https://n8nworkflows.xyz/workflows/sync-events-from-excel-to-google-calendar-with-gpt-4o-mini-smart-summaries-10376


# Sync Events from Excel to Google Calendar with GPT-4o-Mini Smart Summaries

---
### 1. Workflow Overview

This workflow automates the synchronization of event data from an Excel spreadsheet stored in Google Drive to a Google Calendar, enhanced by AI-powered context analysis and smart summaries generated by GPT-4o-Mini. It is designed primarily for users managing recurring schedules such as educators, project managers, or administrators who need accurate, enriched calendar events and executive email summaries.

The workflow logically divides into the following blocks:

- **1.1 Scheduled Trigger & File Acquisition:** Periodically trigger the workflow, set the Excel file ID, download the spreadsheet from Google Drive, and read its contents.
- **1.2 Data Validation & Filtering:** Filter out invalid or incomplete event entries from the Excel data.
- **1.3 AI Event Context Analysis:** Use GPT-4o-Mini via OpenAI and Langchain to analyze each eventâ€™s context, extracting categories, urgency, tags, and suggesting durations, plus parse the AI output for structured data.
- **1.4 Data Enrichment & Calendar Sync:** Merge AI insights with original data, enrich event details, then create or update Google Calendar events accordingly.
- **1.5 AI-Generated Executive Summary & Email:** Aggregate event data, generate a professional summary email with AI assistance, format it, and send it to designated recipients.
- **1.6 Informational Documentation:** Sticky notes providing introduction, use cases, prerequisites, and setup instructions embedded within the workflow for user guidance.

---

### 2. Block-by-Block Analysis

#### 1.1 Scheduled Trigger & File Acquisition

- **Overview:** This block initiates the workflow on a fixed schedule, sets the target Excel file ID, downloads the file from Google Drive, and converts its spreadsheet contents to JSON for further processing.

- **Nodes Involved:**
  - Schedule Trigger
  - Set Excel File ID
  - Google Drive - Download Excel
  - Read Excel File

- **Node Details:**

  - **Schedule Trigger**
    - Type: Schedule Trigger Node
    - Role: Automatically triggers the workflow every 6 hours.
    - Configuration: Interval set to 6 hours.
    - Input: None (start node)
    - Output: Activates the "Set Excel File ID" node.
    - Edge Cases: Workflow will not run if n8n instance is down or scheduling misconfigured.

  - **Set Excel File ID**
    - Type: Set Node
    - Role: Defines the Google Drive file ID for the Excel spreadsheet.
    - Configuration: Hardcoded string for fileId (to be replaced with actual ID).
    - Input: From Schedule Trigger.
    - Output: Passes fileId to Google Drive download node.
    - Edge Cases: Failure if fileId is incorrect or missing.

  - **Google Drive - Download Excel**
    - Type: Google Drive Node
    - Role: Downloads the Excel file by file ID using OAuth2 credentials.
    - Configuration: Operation set to "download", fileId from previous node.
    - Input: fileId from Set Excel File ID.
    - Output: Binary data of the Excel file.
    - Edge Cases: Auth errors, file not found, permission issues.

  - **Read Excel File**
    - Type: Spreadsheet File Node
    - Role: Converts binary Excel file to JSON records for event processing.
    - Configuration: Default options (no special parsing options).
    - Input: Binary Excel file data from Google Drive node.
    - Output: JSON array of event objects.
    - Edge Cases: Malformed Excel files, unsupported formats.

#### 1.2 Data Validation & Filtering

- **Overview:** Filters out events lacking essential fields or with invalid start dates, ensuring only valid events proceed.

- **Nodes Involved:**
  - Filter Valid Events

- **Node Details:**

  - **Filter Valid Events**
    - Type: Filter Node
    - Role: Validates each event JSON object for required fields (title, startDate) and correct date format.
    - Configuration: Conditions check non-empty title and startDate, and that startDate is a valid date.
    - Input: JSON events from Read Excel File.
    - Output: Valid event items continue; invalid ones discarded.
    - Edge Cases: Events with missing or malformed dates or titles are filtered out.

#### 1.3 AI Event Context Analysis

- **Overview:** Uses AI models to analyze each eventâ€™s textual content, extracting enhanced metadata like category, suggested duration, tags, urgency, and reminders. It then parses AI outputs for structured use.

- **Nodes Involved:**
  - AI - Analyze Event Context
  - OpenAI Chat Model
  - Structured Output Parser
  - Merge AI Insights

- **Node Details:**

  - **AI - Analyze Event Context**
    - Type: Langchain Agent Node
    - Role: Sends event text (title, description, location) to conversational AI agent with a system prompt to analyze and classify event details.
    - Configuration: System message instructs extraction of category, duration, tags, urgency, reminders; expects valid JSON output.
    - Input: Filtered event JSON.
    - Output: Raw AI response JSON.
    - Edge Cases: AI may fail to return valid JSON, timeout, or rate-limit errors.

  - **OpenAI Chat Model**
    - Type: Langchain OpenAI Chat Model Node
    - Role: Connects to OpenAI GPT API using stored credentials to generate AI completions.
    - Configuration: Uses OpenAI account credential; no extra options.
    - Input: Prompt from AI - Analyze Event Context.
    - Output: AI chat response.
    - Edge Cases: API key invalid, quota exceeded, network issues.

  - **Structured Output Parser**
    - Type: Langchain Output Parser Node
    - Role: Parses AI JSON output using defined JSON schema to enforce structure and extract fields.
    - Configuration: Schema expects category (string), suggestedDuration (number), tags (string array), urgency (string), reminderMinutes (number), enhancedDescription (string).
    - Input: Raw AI output.
    - Output: Structured JSON for downstream use.
    - Edge Cases: Parsing errors if AI output deviates from schema.

  - **Merge AI Insights**
    - Type: Merge Node
    - Role: Combines original event data with AI-analyzed metadata.
    - Configuration: Mode set to "combine" to merge item properties.
    - Input: Filter Valid Events (original data) and AI - Analyze Event Context (structured AI data).
    - Output: Enriched event JSON.
    - Edge Cases: Data mismatch if inputs are out of sync.

#### 1.4 Data Enrichment & Calendar Sync

- **Overview:** Enriches merged event data with AI insights, calculates missing end times, and synchronizes events by creating or updating them in Google Calendar.

- **Nodes Involved:**
  - Enrich Event Data
  - Google Calendar - Create Event
  - Update Calendar Event

- **Node Details:**

  - **Enrich Event Data**
    - Type: Set Node
    - Role: Adds AI-derived fields to event data (category, tags, enhanced description, urgency, calculated endDate, reminders).
    - Configuration:
      - Title remains original.
      - category, tags, urgency from AI node.
      - description replaced by enhancedDescription if available.
      - endDate calculated as startDate + suggestedDuration if endDate missing.
      - reminderMinutes set from AI.
    - Input: Merged AI insights and original event data.
    - Output: Fully enriched event data.
    - Edge Cases: Missing AI fields may cause calculation errors.

  - **Google Calendar - Create Event**
    - Type: Google Calendar Node
    - Role: Creates new events in the primary Google Calendar.
    - Configuration:
      - Uses enriched startDate, endDate.
      - Sets color based on urgency (high=11, medium=5, low=1).
      - Sets location, attendees if available.
      - Description includes original plus AI metadata.
      - Does not send update notifications.
      - Default reminders disabled.
    - Input: Enriched event data.
    - Output: Created event details including eventId.
    - Edge Cases: API permission errors, invalid dates.

  - **Update Calendar Event**
    - Type: Google Calendar Node
    - Role: Updates existing calendar events with enriched descriptions and AI metadata.
    - Configuration: Uses eventId from existing event.
    - Input: Events that already exist (from Create Event node output).
    - Output: Updated event confirmation.
    - Edge Cases: Event not found, permission denied.

#### 1.5 AI-Generated Executive Summary & Email

- **Overview:** Aggregates all synchronized events, generates an AI-powered executive summary email with event breakdowns, formats it, and sends it to recipients.

- **Nodes Involved:**
  - Prepare AI Summary Data
  - AI - Generate Smart Summary
  - OpenAI Chat Model1
  - Format AI Email
  - Send Email Summary

- **Node Details:**

  - **Prepare AI Summary Data**
    - Type: Set Node
    - Role: Aggregates event summaries, categories, urgencies, and captures sync timestamp.
    - Configuration:
      - totalEvents: count of processed events.
      - aggregatedEvents: textual concatenation of event summaries with category, urgency, and date.
      - syncTimestamp: current date/time string.
    - Input: Output from calendar event creation/update.
    - Output: Aggregated data for summary generation.
    - Edge Cases: Empty event list results in minimal summary.

  - **AI - Generate Smart Summary**
    - Type: Langchain Agent Node
    - Role: Uses AI to create a professional, concise HTML email summarizing events.
    - Configuration:
      - System prompt asks for executive summary, category breakdown, urgency highlights, preparation suggestions, and next sync info.
      - Input includes aggregatedEvents text, totalEvents count, and sync timestamp.
    - Input: Aggregated event data.
    - Output: AI-generated email HTML.
    - Edge Cases: AI output malformation, API errors.

  - **OpenAI Chat Model1**
    - Type: Langchain OpenAI Chat Model Node
    - Role: Supports the AI summary generation by connecting to OpenAI API.
    - Configuration: Uses same OpenAI credentials.
    - Input: Prompt from AI - Generate Smart Summary.
    - Output: AI response with summary.
    - Edge Cases: Same as other OpenAI node.

  - **Format AI Email**
    - Type: Set Node
    - Role: Prepares final email subject and body fields from AI output.
    - Configuration:
      - emailBody set to AI output.
      - emailSubject formatted with sync timestamp.
    - Input: AI summary output.
    - Output: Email-ready data.
    - Edge Cases: Missing AI output leads to blank email.

  - **Send Email Summary**
    - Type: Email Send Node
    - Role: Sends the formatted summary email to specified recipients.
    - Configuration:
      - To: recipient@example.com (replace with real address).
      - From: your-email@example.com (configured SMTP or Gmail).
      - Subject and HTML body from previous node.
    - Input: Formatted email data.
    - Output: Email send confirmation.
    - Edge Cases: SMTP configuration errors, network issues.

#### 1.6 Informational Documentation

- **Overview:** Provides embedded sticky notes in the workflow interface to guide users on purpose, use cases, prerequisites, and setup instructions.

- **Nodes Involved:**
  - Sticky Note
  - Sticky Note1
  - Sticky Note2

- **Node Details:**

  - **Sticky Note**
    - Type: Sticky Note Node
    - Role: Detailed introduction, workflow logic summary, and setup steps.
    - Content: Explains automation process, stepwise workflow breakdown, and initial configuration instructions.
    - Position: Top-left area of workflow canvas.

  - **Sticky Note1**
    - Type: Sticky Note Node
    - Role: Use cases, customization ideas, and benefits.
    - Content: Lists domains of application, options for AI model swaps, calendar routing, filters, and time-saving claims.

  - **Sticky Note2**
    - Type: Sticky Note Node
    - Role: Lists prerequisites to run the workflow successfully.
    - Content: Google Workspace, OpenAI key, SMTP setup, Excel formatting standards, n8n version, OAuth2 setup.

---

### 3. Summary Table

| Node Name                   | Node Type                          | Functional Role                       | Input Node(s)                      | Output Node(s)                  | Sticky Note                                                                                              |
|-----------------------------|----------------------------------|------------------------------------|----------------------------------|-------------------------------|--------------------------------------------------------------------------------------------------------|
| Schedule Trigger            | Schedule Trigger                  | Workflow scheduled start trigger    | -                                | Set Excel File ID              | See Sticky Note for workflow introduction, setup, use cases                                            |
| Set Excel File ID           | Set                              | Defines Excel file ID for download  | Schedule Trigger                 | Google Drive - Download Excel  | See Sticky Note for workflow introduction, setup, use cases                                            |
| Google Drive - Download Excel | Google Drive                     | Downloads Excel file from Drive     | Set Excel File ID                | Read Excel File               | See Sticky Note for workflow introduction, setup, use cases                                            |
| Read Excel File             | Spreadsheet File                 | Converts Excel to JSON events       | Google Drive - Download Excel    | Filter Valid Events            | See Sticky Note for workflow introduction, setup, use cases                                            |
| Filter Valid Events         | Filter                          | Filters valid event records         | Read Excel File                  | Google Calendar - Create Event, AI - Analyze Event Context, Merge AI Insights | See Sticky Note for workflow introduction, setup, use cases                                            |
| AI - Analyze Event Context  | Langchain Agent                 | AI event context analysis           | Filter Valid Events              | Merge AI Insights             | See Sticky Note for workflow introduction, setup, use cases                                            |
| OpenAI Chat Model           | Langchain OpenAI Chat Model     | Connects to OpenAI for AI queries   | AI - Analyze Event Context       | AI - Analyze Event Context    | See Sticky Note for workflow introduction, setup, use cases                                            |
| Structured Output Parser    | Langchain Output Parser          | Parses AI JSON output               | OpenAI Chat Model                | AI - Analyze Event Context    | See Sticky Note for workflow introduction, setup, use cases                                            |
| Merge AI Insights           | Merge                           | Combines original and AI data      | Filter Valid Events, AI - Analyze Event Context | Enrich Event Data          | See Sticky Note for workflow introduction, setup, use cases                                            |
| Enrich Event Data           | Set                             | Enhances event data with AI fields | Merge AI Insights               | Google Calendar - Create Event | See Sticky Note for workflow introduction, setup, use cases                                            |
| Google Calendar - Create Event | Google Calendar                | Creates new calendar events         | Enrich Event Data               | Aggregate Events, Update Calendar Event | See Sticky Note for workflow introduction, setup, use cases                                            |
| Update Calendar Event       | Google Calendar                 | Updates existing calendar events    | Google Calendar - Create Event  | Prepare AI Summary Data       | See Sticky Note for workflow introduction, setup, use cases                                            |
| Prepare AI Summary Data     | Set                             | Aggregates event summaries          | Update Calendar Event           | AI - Generate Smart Summary   | See Sticky Note for workflow introduction, setup, use cases                                            |
| AI - Generate Smart Summary | Langchain Agent                 | Generates executive summary email   | Prepare AI Summary Data         | Format AI Email               | See Sticky Note for workflow introduction, setup, use cases                                            |
| OpenAI Chat Model1          | Langchain OpenAI Chat Model     | Supports AI summary generation      | AI - Generate Smart Summary     | AI - Generate Smart Summary   | See Sticky Note for workflow introduction, setup, use cases                                            |
| Format AI Email             | Set                             | Prepares email subject and body     | AI - Generate Smart Summary     | Send Email Summary            | See Sticky Note for workflow introduction, setup, use cases                                            |
| Send Email Summary          | Email Send                     | Sends summary email                 | Format AI Email                 | -                             | See Sticky Note for workflow introduction, setup, use cases                                            |
| Sticky Note                | Sticky Note                    | Introduction and overview           | -                              | -                             | Contains detailed intro, stepwise logic, setup instructions                                            |
| Sticky Note1               | Sticky Note                    | Use cases, customization, benefits | -                              | -                             | Lists use cases, customization options, and benefits                                                   |
| Sticky Note2               | Sticky Note                    | Prerequisites                      | -                              | -                             | Lists required accounts, keys, setup, and version notes                                               |

---

### 4. Reproducing the Workflow from Scratch

1. **Create a Schedule Trigger Node**
   - Set interval to 6 hours.

2. **Add a Set Node named "Set Excel File ID"**
   - Add a string field `fileId`.
   - Assign it the Google Drive file ID of the Excel spreadsheet to process.

3. **Add a Google Drive Node "Google Drive - Download Excel"**
   - Operation: `download`
   - Set `fileId` to the expression: `{{$json.fileId}}`
   - Configure OAuth2 credentials for Google Drive access.

4. **Add a Spreadsheet File Node "Read Excel File"**
   - Input: Binary data from Google Drive node.
   - Default parsing options.
   - Converts Excel into JSON records.

5. **Add a Filter Node "Filter Valid Events"**
   - Conditions:
     - `title` is not empty.
     - `startDate` is not empty.
     - `startDate` parsed as Date is valid (not "Invalid Date").

6. **Add Langchain Agent Node "AI - Analyze Event Context"**
   - Text input: concatenate `title`, `description`, `location`.
   - System message instructing to extract category, suggested duration, tags, urgency, reminder minutes, enhanced description.
   - Output raw JSON.

7. **Add Langchain OpenAI Chat Model Node "OpenAI Chat Model"**
   - Use OpenAI credentials.
   - Connect as AI language model for the previous AI node.

8. **Add Langchain Output Parser Node "Structured Output Parser"**
   - Define JSON schema with keys: category (string), suggestedDuration (number), tags (array of string), urgency (string), reminderMinutes (number), enhancedDescription (string).
   - Connect as output parser for AI node.

9. **Add Merge Node "Merge AI Insights"**
   - Mode: combine
   - Inputs: Filter Valid Events (original data) and AI - Analyze Event Context (structured data).
   - Output combined event data.

10. **Add Set Node "Enrich Event Data"**
    - Assign:
      - `title`: original title.
      - `category`: AI category.
      - `tags`: AI tags joined by comma.
      - `description`: AI enhancedDescription if present, else original description.
      - `urgency`: AI urgency.
      - `endDate`: original endDate if present; else calculate as `startDate + suggestedDuration (hours)`.
      - `reminderMinutes`: AI reminderMinutes.
    - Include other fields as needed.

11. **Add Google Calendar Node "Google Calendar - Create Event"**
    - Operation: create
    - Calendar: primary or desired calendar.
    - Set start and end dates from enriched data.
    - Set color based on urgency (`high`=11, `medium`=5, else 1).
    - Add location, attendees if present.
    - Description includes original description plus AI metadata.
    - Disable default reminders.
    - Configure OAuth2 credentials for Google Calendar.

12. **Add Google Calendar Node "Update Calendar Event"**
    - Operation: update
    - Event ID from created event.
    - Update description with latest AI insights.
    - Use same calendar and credentials as create node.

13. **Add Set Node "Prepare AI Summary Data"**
    - Assign:
      - `totalEvents`: count of all processed events.
      - `aggregatedEvents`: concatenated string of event summaries with category, urgency, and date.
      - `syncTimestamp`: current date/time string.

14. **Add Langchain Agent Node "AI - Generate Smart Summary"**
    - Text input includes aggregated events, total events, and timestamp.
    - System message requests an executive summary email with HTML formatting.

15. **Add Langchain OpenAI Chat Model Node "OpenAI Chat Model1"**
    - Use same OpenAI credentials.
    - Connect as AI language model for summary generation.

16. **Add Set Node "Format AI Email"**
    - Assign:
      - `emailBody`: AI output from summary generation.
      - `emailSubject`: formatted with sync timestamp (e.g., "ðŸ“… AI-Enhanced Calendar Sync - [timestamp]").

17. **Add Email Send Node "Send Email Summary"**
    - Configure SMTP or Gmail credentials.
    - To: recipient email(s).
    - From: verified sender email.
    - Subject and HTML body from previous node.

18. **Connect all nodes according to the logic:**
    - Schedule Trigger â†’ Set Excel File ID â†’ Google Drive Download â†’ Read Excel File â†’ Filter Valid Events â†’ Parallel:
      - â†’ Google Calendar Create Event â†’ Update Calendar Event â†’ Prepare AI Summary Data â†’ AI Generate Smart Summary â†’ Format AI Email â†’ Send Email Summary
      - â†’ AI Analyze Event Context â†’ Structured Output Parser â†’ Merge AI Insights â†’ Enrich Event Data â†’ Google Calendar Create Event

19. **Add Sticky Notes on the canvas to document:**
    - Introduction and workflow overview
    - Use cases and benefits
    - Prerequisites and setup instructions

---

### 5. General Notes & Resources

| Note Content                                                                                                                                                                                                                                           | Context or Link                              |
|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------|
| This workflow automates Excel schedule imports from Google Drive with AI validation, syncing to Google Calendar and emailing smart summaries. Ideal for educators, managers, and administrators handling recurring schedules.                             | Sticky Note (Introduction)                   |
| Use cases include education (course schedules), projects (milestones), events (venue bookings), HR (interviews), healthcare (shifts). Customizations possible with other AI models or calendar routing. Time savings of 5â€“10 hours per week claimed.       | Sticky Note1 (Use Cases)                      |
| Prerequisites: Google Workspace with Drive & Calendar, OpenAI API key, Gmail/SMTP setup, standardized Excel format, n8n v1.0+, OAuth2 configured for Google services.                                                                                  | Sticky Note2 (Prerequisites)                  |
| Replace the OpenAI model with alternatives like Anthropic Claude, LLaMA, or Azure OpenAI for customization.                                                                                                                                             | Sticky Note1 (Customization)                  |
| Ensure correct permissions and API credentials are configured for Google Drive, Calendar, OpenAI, and Email sending to avoid integration failures.                                                                                                      | General integration note                      |
| Excel spreadsheet should include columns for event title, start and end dates/times, description, location, attendees, etc., formatted consistently for reliable parsing.                                                                              | General data formatting note                  |
| Email sending requires proper SMTP or Gmail credentials set up in n8n with verified sender addresses to prevent delivery issues.                                                                                                                        | Email setup note                              |
| The AI system prompts are designed to return strictly JSON-formatted data for reliability; malformed outputs may cause downstream parsing errors.                                                                                                       | AI prompt and parsing note                    |
| Workflow uses n8n version 1.0 or later with Langchain nodes and requires OAuth2 credentials for Google APIs.                                                                                                                                             | Version and credential requirements           |

---

**Disclaimer:**  
The provided content exclusively originates from an n8n automated workflow. The processing adheres strictly to applicable content policies and contains no illegal, offensive, or protected elements. All data handled are legal and public.