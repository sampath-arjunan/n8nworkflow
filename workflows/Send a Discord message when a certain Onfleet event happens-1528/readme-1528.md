Send a Discord message when a certain Onfleet event happens

https://n8nworkflows.xyz/workflows/send-a-discord-message-when-a-certain-onfleet-event-happens-1528


# Send a Discord message when a certain Onfleet event happens

### 1. Workflow Overview

This workflow integrates Onfleet, a last-mile delivery management platform, with Discord, a popular communication tool. Its primary purpose is to listen for specific delivery-related events from Onfleet and automatically send notifications to a designated Discord channel. This enables teams to get real-time updates on delivery statuses directly within their Discord servers.

**Logical blocks:**

- **1.1 Onfleet Event Reception:** Captures events from Onfleet via a webhook trigger based on a selected delivery task event.
- **1.2 Discord Notification:** Sends a formatted message to a Discord channel using a webhook to notify users about the Onfleet event.

---

### 2. Block-by-Block Analysis

#### 2.1 Onfleet Event Reception

**Overview:**  
This block listens for a specific event in Onfleet using a webhook trigger node. It monitors the delivery task lifecycle and activates when the chosen event occurs, initiating the workflow.

**Nodes Involved:**  
- Onfleet Trigger

**Node Details:**

- **Onfleet Trigger**  
  - *Type:* Trigger node for Onfleet events (webhook-based)  
  - *Configuration:*  
    - **Trigger Event:** Set to `taskStarted` (triggers when a delivery task starts)  
    - **Webhook ID:** Unique identifier for the webhook endpoint (auto-generated by n8n)  
    - **Credentials:** Uses an Onfleet API key credential to authenticate and register the webhook with Onfleet's API  
  - *Expressions/Variables:* None explicitly set; event data from Onfleet is passed as input  
  - *Input Connections:* None (trigger node)  
  - *Output Connections:* Connects to the `Discord` node  
  - *Version Requirements:* Compatible with n8n version supporting Onfleet Trigger node (generally from n8n v0.151+)  
  - *Potential Failures:*  
    - Authentication errors if the API key is invalid or revoked  
    - Webhook registration failures due to connectivity or API limits  
    - Event filter misconfiguration (if event type is unsupported or changed)  
    - Network timeouts or dropped webhook calls  

---

#### 2.2 Discord Notification

**Overview:**  
This block sends a notification message to a Discord channel using a webhook URL when the Onfleet trigger fires. It enables real-time communication of delivery task status within Discord.

**Nodes Involved:**  
- Discord

**Node Details:**

- **Discord**  
  - *Type:* Discord node to send messages via Discord webhook  
  - *Configuration:*  
    - **Webhook URL:** Must be set with the Discord server's webhook URL (configurable in node parameters)  
    - **Text Field:** User-customizable message content using expressions, typically referencing Onfleet event data  
  - *Expressions/Variables:* The node can use expressions to parse and format the incoming Onfleet event data dynamically (not preset in the template, user to customize)  
  - *Input Connections:* Receives data from `Onfleet Trigger` node  
  - *Output Connections:* None (end node)  
  - *Version Requirements:* Compatible with n8n versions that support Discord webhook node  
  - *Potential Failures:*  
    - Invalid or expired Discord webhook URL causing message rejection  
    - Rate limits from Discord API if messages sent too frequently  
    - Incorrect message formatting causing sending errors  
    - Network issues blocking webhook calls  

---

### 3. Summary Table

| Node Name       | Node Type                 | Functional Role                 | Input Node(s)     | Output Node(s) | Sticky Note                                                                                                                                            |
|-----------------|---------------------------|--------------------------------|-------------------|----------------|--------------------------------------------------------------------------------------------------------------------------------------------------------|
| Onfleet Trigger | onfleetTrigger (Trigger)  | Listens for Onfleet events     | -                 | Discord        | Update the Onfleet trigger node with your own Onfleet credentials, to register for an Onfleet API key, please visit https://onfleet.com/signup to get started. Learn more about Onfleet webhooks with [Onfleet Support](https://support.onfleet.com/hc/en-us/articles/360045763852-Webhooks) |
| Discord         | discord                   | Sends message to Discord server | Onfleet Trigger   | -              | Update the Discord node with your Discord server webhook URL, add your own expressions to the `Text` field                                                                                   |

---

### 4. Reproducing the Workflow from Scratch

1. **Create a new workflow** in n8n and name it appropriately (e.g., "Onfleet --> Discord").

2. **Add Onfleet Trigger node:**  
   - Node Type: `Onfleet Trigger`  
   - Position the node on the canvas for clarity (e.g., x=460, y=300)  
   - Configure the following:  
     - Select the trigger event to listen for (default: `taskStarted`, but can be changed to any supported Onfleet webhook event such as `taskCompleted`, `taskCreated`, etc.)  
     - Provide Onfleet API credentials:  
       - If not yet created, go to https://onfleet.com/signup, obtain an API key and add it under n8n Credentials as "Onfleet API Key" (type: API Key)  
     - Ensure the webhook ID is auto-generated or configured as needed.  

3. **Add Discord node:**  
   - Node Type: `Discord`  
   - Position the node to the right of the Onfleet Trigger node (e.g., x=680, y=300)  
   - Configure the following:  
     - Enter your Discord server webhook URL in the node’s credentials or directly in the webhook URL parameter.  
     - Customize the `Text` field to format the message that should be sent to Discord. Use expressions to include dynamic data from the Onfleet event, e.g., task details, driver name, times, etc.  
     - Ensure the webhook URL is active and has the necessary permissions to post messages.

4. **Connect the nodes:**  
   - Draw a connection from the `Onfleet Trigger` node’s main output to the `Discord` node’s input.

5. **Save and activate the workflow:**  
   - Activate the workflow to start listening for events.  
   - Test by triggering an event in Onfleet that matches the selected webhook (e.g., start a task). Confirm the Discord message is posted as expected.

---

### 5. General Notes & Resources

| Note Content                                                                                                                                   | Context or Link                                                                                                      |
|------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------|
| To register for an Onfleet API key and learn about supported webhook events, visit: https://onfleet.com/signup                                  | Onfleet API registration and webhook documentation                                                                  |
| Detailed Onfleet webhook documentation is available at: https://support.onfleet.com/hc/en-us/articles/360045763852-Webhooks                     | Official Onfleet support article on webhook setup and event types                                                    |
| To create a Discord webhook URL, follow Discord’s official guide: https://support.discord.com/hc/en-us/articles/228383668-Intro-to-Webhooks      | Discord webhook setup instructions                                                                                   |
| Customize the Discord message text with n8n expressions to include relevant Onfleet event data for contextual notifications                    | n8n expressions docs: https://docs.n8n.io/nodes/expressions/                                                        |

---

This detailed documentation provides full insight into the workflow’s structure, logic, and setup instructions, enabling advanced users and automation agents to understand, reproduce, and extend the integration between Onfleet events and Discord messaging.