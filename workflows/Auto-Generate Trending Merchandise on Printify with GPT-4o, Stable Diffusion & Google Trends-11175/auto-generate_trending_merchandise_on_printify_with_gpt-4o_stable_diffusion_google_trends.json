{"id":"LIjTGBDOMRXvIElN","meta":{"instanceId":"b023674627c58980fb6714426453392ba62def288b4513c7739228bcf5ecfb50"},"name":"Create trend-based merchandise on Printify using OpenAI and Replicate","tags":[],"nodes":[{"id":"b23cc75d-0968-4290-99bc-c29c6e7312cc","name":"Sticky Note 1","type":"n8n-nodes-base.stickyNote","position":[528,528],"parameters":{"color":7,"width":260,"height":212,"content":"### 1. Configuration & Data\n\n- Define all API keys in the **Workflow Configuration** node.\n- Pulls data from Typeform (User preferences) and Google Trends (Market trends)."},"typeVersion":1},{"id":"9ef04bc1-eada-4a18-b89a-426615c5c335","name":"Sticky Note 2","type":"n8n-nodes-base.stickyNote","position":[1408,576],"parameters":{"color":7,"width":260,"content":"### 2. AI Design & Generation\n\n- **Chief Designer AI**: Combines trends into design prompts.\n- **Replicate**: Generates the actual image file from the prompt."},"typeVersion":1},{"id":"43dd6a0c-d57e-471f-82c5-3fc1eb88bb9c","name":"Sticky Note 3","type":"n8n-nodes-base.stickyNote","position":[2208,560],"parameters":{"color":7,"width":280,"height":228,"content":"### 3. QC & Publishing\n\n- **Vision AI**: Scores the design quality.\n- **Filter**: Drops designs scoring < 7.\n- **Pricing**: Adds premium for higher scores.\n- **Printify**: Pushes product live."},"typeVersion":1},{"id":"12d21c69-6214-4cf4-816a-afb2372eb671","name":"Weekly Schedule Trigger1","type":"n8n-nodes-base.scheduleTrigger","position":[528,800],"parameters":{"rule":{"interval":[{"field":"weeks","triggerAtDay":[1],"triggerAtHour":9}]}},"typeVersion":1.2},{"id":"da39845a-9635-4d0d-a5e4-c642cd883e7a","name":"Workflow Configuration1","type":"n8n-nodes-base.set","position":[752,800],"parameters":{"options":{},"assignments":{"assignments":[{"id":"id-1","name":"typeformApiUrl","type":"string","value":"https://api.typeform.com"},{"id":"id-2","name":"typeformFormId","type":"string","value":"YOUR_TYPEFORM_FORM_ID"},{"id":"id-3","name":"typeformApiToken","type":"string","value":"YOUR_TYPEFORM_API_TOKEN"},{"id":"id-4","name":"replicateApiToken","type":"string","value":"YOUR_REPLICATE_API_TOKEN"},{"id":"id-5","name":"printifyApiToken","type":"string","value":"YOUR_PRINTIFY_API_TOKEN"},{"id":"id-6","name":"printifyShopId","type":"string","value":"YOUR_PRINTIFY_SHOP_ID"},{"id":"id-7","name":"basePrice","type":"number","value":25}]},"includeOtherFields":true},"typeVersion":3.4},{"id":"ff51af75-03c8-404d-bae3-fac5028267f3","name":"Get Typeform Responses1","type":"n8n-nodes-base.httpRequest","position":[976,688],"parameters":{"url":"={{ $('Workflow Configuration1').first().json.typeformApiUrl }}/forms/{{ $('Workflow Configuration1').first().json.typeformFormId }}/responses","options":{},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"Authorization","value":"={{ 'Bearer ' + $('Workflow Configuration1').first().json.typeformApiToken }}"}]}},"typeVersion":4.3},{"id":"8f4288be-ee4c-4304-b98a-75fcfe7c58cb","name":"Get Google Trends Data1","type":"n8n-nodes-base.httpRequest","position":[976,896],"parameters":{"url":"https://trends.google.com/trends/trendingsearches/daily/rss?geo=US","options":{}},"typeVersion":4.3},{"id":"99556f8a-e8af-4958-91a8-07e8da720066","name":"Merge Trend Data1","type":"n8n-nodes-base.merge","position":[1200,800],"parameters":{},"typeVersion":3.2},{"id":"13be13ff-cb5e-4a87-a8ac-c437cae6db79","name":"Chief Designer AI1","type":"@n8n/n8n-nodes-langchain.openAi","position":[1408,800],"parameters":{"operation":"message"},"credentials":{"openAiApi":{"id":"EHMa6TeFtigiQ48U","name":"n8n free OpenAI API credits"}},"typeVersion":2},{"id":"3a92c1c7-eb89-4bf5-a05e-b3810c3f725f","name":"Parse Design Proposals1","type":"n8n-nodes-base.code","position":[1776,800],"parameters":{"jsCode":"const aiResponse = items[0].json.message?.content || items[0].json.text || '';\n\n// Try to extract JSON from the response\nlet designs = [];\ntry {\n  // Remove markdown code blocks if present\n  const jsonMatch = aiResponse.match(/\\[\\s*\\{[\\s\\S]*\\}\\s*\\]/);\n  if (jsonMatch) {\n    designs = JSON.parse(jsonMatch[0]);\n  } else {\n    designs = JSON.parse(aiResponse);\n  }\n} catch (error) {\n  throw new Error('Failed to parse AI response as JSON: ' + error.message);\n}\n\n// Return each design as a separate item for processing\nreturn designs.map(design => ({\n  json: {\n    title: design.Title,\n    description: design.Description,\n    imagePrompt: design.Image_Prompt\n  }\n}));"},"typeVersion":2},{"id":"e6a42139-e59f-4ee6-a962-312e3a74a00d","name":"Generate Image with Replicate1","type":"n8n-nodes-base.httpRequest","position":[2000,800],"parameters":{"url":"https://api.replicate.com/v1/predictions","method":"POST","options":{},"jsonBody":"={\n  \"version\": \"5599ed30703defd1d160a25a63321b4dec97101d98b4674bcc56e41f62f35637\",\n  \"input\": {\n    \"prompt\": \"{{ $json.imagePrompt }}, t-shirt design, vector style, white background, high quality, commercial print ready\",\n    \"num_outputs\": 1,\n    \"aspect_ratio\": \"1:1\",\n    \"output_format\": \"png\",\n    \"output_quality\": 90\n  }\n}","sendBody":true,"sendHeaders":true,"specifyBody":"json","headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $('Workflow Configuration1').first().json.replicateApiToken }}"},{"name":"Content-Type","value":"application/json"}]}},"typeVersion":4.3},{"id":"c37e5d20-4762-4114-a9ce-2615e8c50cf6","name":"Quality Control AI Vision1","type":"@n8n/n8n-nodes-langchain.openAi","position":[2208,800],"parameters":{"text":"Rate this t-shirt design on a scale of 1-10","modelId":{"__rl":true,"mode":"id","value":"gpt-4o"},"options":{},"resource":"image","imageUrls":"={{ $json.output?.[0] || $json.urls?.[0] }}","operation":"analyze"},"credentials":{"openAiApi":{"id":"EHMa6TeFtigiQ48U","name":"n8n free OpenAI API credits"}},"typeVersion":2},{"id":"6ca78e23-428f-4b8c-98f9-d97880bb7cba","name":"Parse Quality Score1","type":"n8n-nodes-base.code","position":[2432,800],"parameters":{"mode":"runOnceForEachItem","jsCode":"const aiResponse = items[0].json.message?.content || items[0].json.text || '';\n\n// Parse the quality score from AI response\nlet scoreData = {};\ntry {\n  const jsonMatch = aiResponse.match(/\\{[\\s\\S]*\\}/);\n  if (jsonMatch) {\n    scoreData = JSON.parse(jsonMatch[0]);\n  } else {\n    scoreData = JSON.parse(aiResponse);\n  }\n} catch (error) {\n  // If parsing fails, try to extract score from text\n  const scoreMatch = aiResponse.match(/score[\"']?\\s*:\\s*(\\d+)/);\n  if (scoreMatch) {\n    scoreData = { score: parseInt(scoreMatch[1]), reason: 'Extracted from text' };\n  } else {\n    throw new Error('Failed to parse quality score: ' + error.message);\n  }\n}\n\nreturn {\n  json: {\n    ...items[0].json,\n    qualityScore: scoreData.score,\n    qualityReason: scoreData.reason\n  }\n};"},"typeVersion":2},{"id":"3f2e4b9a-2c4e-4714-81b1-4883c4418c6a","name":"Quality Filter1","type":"n8n-nodes-base.if","position":[2656,800],"parameters":{"options":{},"conditions":{"options":{"leftValue":"","caseSensitive":true,"typeValidation":"strict"},"combinator":"and","conditions":[{"id":"id-1","operator":{"type":"number","operation":"gte"},"leftValue":"={{ $('Parse Quality Score1').item.json.qualityScore }}","rightValue":"7"}]}},"typeVersion":2.2},{"id":"4d13a93f-c724-46bf-8c84-b398cc5f74d2","name":"Dynamic Pricing Calculator1","type":"n8n-nodes-base.code","position":[2880,800],"parameters":{"mode":"runOnceForEachItem","jsCode":"const basePrice = parseFloat($('Workflow Configuration1').first().json.basePrice);\nconst score = items[0].json.qualityScore;\n\n// Dynamic pricing based on quality score\nlet finalPrice = basePrice;\nif (score >= 9) {\n  finalPrice = basePrice * 1.2; // 20% premium for exceptional designs\n} else if (score >= 8) {\n  finalPrice = basePrice * 1.1; // 10% premium for great designs\n}\n\nreturn {\n  json: {\n    ...items[0].json,\n    finalPrice: finalPrice.toFixed(2)\n  }\n};"},"typeVersion":2},{"id":"18699846-e9fa-423b-a727-d8b72619033f","name":"Publish to Printify1","type":"n8n-nodes-base.httpRequest","position":[3088,800],"parameters":{"url":"=https://api.printify.com/v1/shops/{{ $('Workflow Configuration1').first().json.printifyShopId }}/products.json","method":"POST","options":{},"jsonBody":"={\n  \"title\": \"{{ $json.title }}\",\n  \"description\": \"{{ $json.description }}\\n\\nQuality Score: {{ $json.qualityScore }}/10\\n{{ $json.qualityReason }}\",\n  \"blueprint_id\": <__PLACEHOLDER_VALUE__Printify Blueprint ID (product type)__>,\n  \"print_provider_id\": <__PLACEHOLDER_VALUE__Printify Print Provider ID__>,\n  \"variants\": [\n    {\n      \"id\": <__PLACEHOLDER_VALUE__Variant ID__>,\n      \"price\": {{ $json.finalPrice * 100 }},\n      \"is_enabled\": true\n    }\n  ],\n  \"print_areas\": [\n    {\n      \"variant_ids\": [<__PLACEHOLDER_VALUE__Variant IDs array__>],\n      \"placeholders\": [\n        {\n          \"position\": \"front\",\n          \"images\": [\n            {\n              \"id\": \"{{ $json.output[0] }}\",\n              \"x\": 0.5,\n              \"y\": 0.5,\n              \"scale\": 1,\n              \"angle\": 0\n            }\n          ]\n        }\n      ]\n    }\n  ]\n}","sendBody":true,"sendHeaders":true,"specifyBody":"json","headerParameters":{"parameters":[{"name":"Authorization","value":"=Bearer {{ $('Workflow Configuration1').first().json.printifyApiToken }}"},{"name":"Content-Type","value":"application/json"}]}},"typeVersion":4.3},{"id":"082f358a-e4bd-496a-beb3-c733ca51269d","name":"Save to Product Dashboard1","type":"n8n-nodes-base.airtable","position":[3312,800],"parameters":{"base":{"__rl":true,"mode":"id","value":"<__PLACEHOLDER_VALUE__Airtable Base ID__>"},"table":{"__rl":true,"mode":"id","value":"<__PLACEHOLDER_VALUE__Airtable Table Name (e.g., Products)__>"},"columns":{"value":{"Date":"={{ $now.toISO() }}","Price":"={{ $json.finalPrice }}","Title":"={{ $json.title }}","Status":"Published","Image_URL":"={{ $json.output?.[0] || $json.urls?.[0] }}","Description":"={{ $json.description }}","Quality_Score":"={{ $json.qualityScore }}","Quality_Reason":"={{ $json.qualityReason }}","Printify_Product_ID":"={{ $json.id }}"},"mappingMode":"defineBelow"},"options":{},"operation":"create"},"typeVersion":2.1},{"id":"6ac23383-d72a-44c4-83b0-88a6bcff180d","name":"Sticky Note1","type":"n8n-nodes-base.stickyNote","position":[80,736],"parameters":{"width":393,"height":707,"content":"## AI Merch Empire: Trend Analysis to Printify Publishing\n\n**Description**\nThis workflow fully automates a print-on-demand merchandising business. It analyzes weekly search trends and customer feedback to generate high-demand t-shirt designs using AI, evaluates them, and publishes the best ones to your store.\n\n**What it does**\n1. **Data Collection**: Fetches survey data from Typeform and trending topics from Google Trends.\n2. **AI Design**: GPT-4o conceptualizes designs based on trends; Replicate (Flux) generates the images.\n3. **Quality Control**: GPT-4o Vision rates the designs (1-10) and only allows high-scoring ones (7+) to proceed.\n4. **Publishing**: Automatically calculates pricing based on quality score and publishes to Printify and Airtable.\n\n**How to set up**\n1. Open the **Workflow Configuration** node and replace the `YOUR_...` placeholders with your actual API keys and IDs for Typeform, Replicate, and Printify.\n2. Ensure you have OpenAI credentials set up in the AI nodes.\n3. Update the Printify Blueprint/Provider IDs in the \"Publish to Printify\" node to match your preferred product (e.g., Bella+Canvas 3001)."},"typeVersion":1}],"active":false,"pinData":{},"settings":{"executionOrder":"v1"},"versionId":"cb0c6a92-aad8-4d18-b4f1-3206780f93c3","connections":{"Quality Filter1":{"main":[[{"node":"Dynamic Pricing Calculator1","type":"main","index":0}]]},"Merge Trend Data1":{"main":[[{"node":"Chief Designer AI1","type":"main","index":0}]]},"Chief Designer AI1":{"main":[[{"node":"Parse Design Proposals1","type":"main","index":0}]]},"Parse Quality Score1":{"main":[[{"node":"Quality Filter1","type":"main","index":0}]]},"Publish to Printify1":{"main":[[{"node":"Save to Product Dashboard1","type":"main","index":0}]]},"Get Google Trends Data1":{"main":[[{"node":"Merge Trend Data1","type":"main","index":1}]]},"Get Typeform Responses1":{"main":[[{"node":"Merge Trend Data1","type":"main","index":0}]]},"Parse Design Proposals1":{"main":[[{"node":"Generate Image with Replicate1","type":"main","index":0}]]},"Workflow Configuration1":{"main":[[{"node":"Get Typeform Responses1","type":"main","index":0},{"node":"Get Google Trends Data1","type":"main","index":0}]]},"Weekly Schedule Trigger1":{"main":[[{"node":"Workflow Configuration1","type":"main","index":0}]]},"Quality Control AI Vision1":{"main":[[{"node":"Parse Quality Score1","type":"main","index":0}]]},"Dynamic Pricing Calculator1":{"main":[[{"node":"Publish to Printify1","type":"main","index":0}]]},"Generate Image with Replicate1":{"main":[[{"node":"Quality Control AI Vision1","type":"main","index":0}]]}}}