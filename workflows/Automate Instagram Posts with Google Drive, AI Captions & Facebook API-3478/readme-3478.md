Automate Instagram Posts with Google Drive, AI Captions & Facebook API

https://n8nworkflows.xyz/workflows/automate-instagram-posts-with-google-drive--ai-captions---facebook-api-3478


# Automate Instagram Posts with Google Drive, AI Captions & Facebook API

### 1. Workflow Overview

This workflow automates Instagram content posting by integrating Google Drive, OpenAI, and Facebook Graph API. It targets social media managers, content creators, and businesses seeking to streamline posting of images or video reels on Instagram with AI-generated captions and scheduled automation.

The workflow is logically divided into these blocks:

- **1.1 Input Reception & File Trigger**: Detects new image or video files uploaded to a specific Google Drive folder.
- **1.2 File Retrieval**: Downloads the triggered file from Google Drive for processing.
- **1.3 AI Caption Generation**: Uses OpenAI to generate engaging Instagram captions based on the file name.
- **1.4 Data Logging**: Saves the file metadata and AI-generated caption into a Google Sheet for record-keeping and further use.
- **1.5 Instagram Media Creation via Facebook API**: Creates a media object on Instagram using the Facebook Graph API with the file URL and caption.
- **1.6 Instagram Post Publishing**: Publishes the created media object to Instagram via Facebook Graph API.

Supporting nodes include sticky notes with setup instructions and helpful YouTube tutorial links.

---

### 2. Block-by-Block Analysis

#### 2.1 Input Reception & File Trigger

- **Overview:**  
  This block listens for new files (photos, videos, or carousels) uploaded to a specified Google Drive folder, triggering the workflow execution.

- **Nodes Involved:**  
  - Post File Upload in Google Drive Folder Trigger

- **Node Details:**  
  - **Post File Upload in Google Drive Folder Trigger**  
    - Type: Google Drive Trigger  
    - Configuration: Watches a specific Google Drive folder (ID: `1VfkhYImlmEXw70IrJvvZKO6mM164zMD6`) for new file creation events, polling every minute.  
    - Credentials: Google Drive OAuth2 credentials linked.  
    - Input/Output: No input; outputs metadata of the new file created in the folder.  
    - Edge Cases: Possible failures include credential expiration, folder access permission issues, or API rate limits.  
    - Notes: Sticky notes nearby emphasize setting up Google Drive credentials and provide a YouTube tutorial link: https://youtu.be/L3NUp2XP_h0?si=KAjHYEZ-qedIM-n

#### 2.2 File Retrieval

- **Overview:**  
  Downloads the newly uploaded file from Google Drive to n8n for further processing.

- **Nodes Involved:**  
  - Post File Download in N8N (Google Drive Node)

- **Node Details:**  
  - **Post File Download in N8N (Google Drive Node)**  
    - Type: Google Drive  
    - Operation: Download file by ID (taken dynamically from trigger node output).  
    - Credentials: Google Drive OAuth2 credentials (same as trigger).  
    - Input: File metadata from trigger node.  
    - Output: File binary data and metadata including name, webViewLink, and thumbnailLink.  
    - Edge Cases: Download failures due to file access restrictions, file deletion between trigger and download, or network issues.  
    - Notes: Sticky notes reiterate the importance of Google Drive credentials and link to setup video.

#### 2.3 AI Caption Generation

- **Overview:**  
  Generates an engaging Instagram caption using OpenAI based on the downloaded fileâ€™s name.

- **Nodes Involved:**  
  - AI Caption generated by OpenAI

- **Node Details:**  
  - **AI Caption generated by OpenAI**  
    - Type: OpenAI (Langchain node)  
    - Model: GPT-4O-MINI  
    - Configuration: Sends a prompt to generate a caption with 2-3 sentences, emojis, 3-5 hashtags, and a call-to-action, limited to 150 characters. The prompt dynamically includes the file name from the trigger node.  
    - Credentials: OpenAI API key configured.  
    - Input: File metadata from Google Drive download node.  
    - Output: AI-generated caption text.  
    - Edge Cases: API key limits, prompt errors, or model unavailability.  
    - Notes: Sticky note advises setting up OpenAI credentials and links to tutorial.

#### 2.4 Data Logging

- **Overview:**  
  Logs the file name, AI-generated caption, file URL, and thumbnail URL into a Google Sheet for tracking and integration.

- **Nodes Involved:**  
  - Post File Save in Google Sheets

- **Node Details:**  
  - **Post File Save in Google Sheets**  
    - Type: Google Sheets  
    - Operation: Append or update row based on "Name" column matching.  
    - Columns: Name (file name), Captions (AI caption), Reel Urls (file webViewLink), Reel Thumbnail (thumbnailLink).  
    - Credentials: Google Sheets OAuth2 credentials configured.  
    - Input: AI caption and file metadata.  
    - Output: Confirmation of sheet update.  
    - Edge Cases: Sheet access permission issues, row matching conflicts, or API limits.  
    - Notes: Sticky note instructs on Google Sheets setup with columns Name, Caption, and URL, linking to tutorial.

#### 2.5 Instagram Media Creation via Facebook API

- **Overview:**  
  Creates a media object on Instagram (video reel) using the Facebook Graph API with the URL and caption from the Google Sheet.

- **Nodes Involved:**  
  - Connect Facebook API for Publishing Instagram Post using N8N

- **Node Details:**  
  - **Connect Facebook API for Publishing Instagram Post using N8N**  
    - Type: Facebook Graph API  
    - Operation: POST to `/{instagram_business_account_id}/media` edge  
    - Parameters:  
      - video_url: Reel URL from Google Sheet  
      - media-type: REELS  
      - caption: Caption from Google Sheet  
      - image_url: Reel thumbnail from Google Sheet  
    - Credentials: Facebook Graph API OAuth2 credentials configured.  
    - Input: Data from Google Sheets node.  
    - Output: JSON containing media creation ID.  
    - Edge Cases: Token expiration, permission errors, invalid media URLs, or API rate limits.  
    - Notes: Sticky note highlights this as the hardest step with setup instructions and tutorial link.

#### 2.6 Instagram Post Publishing

- **Overview:**  
  Publishes the created media object to Instagram using Facebook Graph API.

- **Nodes Involved:**  
  - Finally Post to Instagram

- **Node Details:**  
  - **Finally Post to Instagram**  
    - Type: Facebook Graph API  
    - Operation: POST to `/{instagram_business_account_id}/media_publish` edge  
    - Parameters: creation_id from previous media creation node output.  
    - Credentials: Facebook Graph API OAuth2 credentials (same as above).  
    - Input: Media creation ID from previous node.  
    - Output: Confirmation of published post.  
    - Edge Cases: Token expiration, invalid creation ID, API errors.  
    - Notes: Sticky note explains this node posts directly to Instagram and links to tutorial.

---

### 3. Summary Table

| Node Name                                      | Node Type                       | Functional Role                              | Input Node(s)                            | Output Node(s)                                  | Sticky Note                                                                                       |
|------------------------------------------------|--------------------------------|----------------------------------------------|-----------------------------------------|------------------------------------------------|-------------------------------------------------------------------------------------------------|
| Sticky Note1                                   | Sticky Note                    | Setup instructions for Google Drive          | -                                       | -                                              | ðŸ‘ˆ Set up Google Drive credentials. When a new photo/video or carousel is uploaded to Google Drive, this trigger activates. Tutorial: https://youtu.be/L3NUp2XP_h0?si=KAjHYEZ-qedIM-n |
| Sticky Note3                                   | Sticky Note                    | Workflow title and overview                   | -                                       | -                                              | ### Automate instagram posts with Google Drive, AI Captions & Facebook Graph API Agent (Easy to Set-Up) |
| Sticky Note                                    | Sticky Note                    | Setup instructions for Google Drive download | -                                       | -                                              | ðŸ‘ˆ Set up Google Drive credentials. This node downloads the posting file. Tutorial: https://youtu.be/L3NUp2XP_h0?si=KAjHYEZ-qedIM-n |
| Sticky Note5                                   | Sticky Note                    | Setup instructions for OpenAI caption node   | -                                       | -                                              | ðŸ‘ˆ Set up OpenAI Message Model credentials. This node creates captions. Tutorial: https://youtu.be/L3NUp2XP_h0?si=KAjHYEZ-qedIM-n |
| Sticky Note6                                   | Sticky Note                    | Setup instructions for Google Sheets node    | -                                       | -                                              | ðŸ‘ˆ Set up Google Sheets Node credentials. Create sheet with Name, Caption, Image/Reel Link columns. Tutorial: https://youtu.be/L3NUp2XP_h0?si=KAjHYEZ-qedIM-n |
| Sticky Note7                                   | Sticky Note                    | Setup instructions for Facebook Graph API    | -                                       | -                                              | ðŸ‘ˆ Hardest Step (Facebook Graph API): Set up credentials and connect query parameters. Tutorial: https://youtu.be/L3NUp2XP_h0?si=KAjHYEZ-qedIM-n |
| Sticky Note8                                   | Sticky Note                    | Setup instructions for final Instagram post  | -                                       | -                                              | ðŸ‘ˆ Set up Facebook Graph API node and credentials. This node posts directly to Instagram. Tutorial: https://youtu.be/L3NUp2XP_h0?si=KAtjHYE2-qedlM-n |
| Post File Upload in Google Drive Folder Trigger | Google Drive Trigger           | Triggers workflow on new file upload          | -                                       | Post File Download in N8N (Google Drive Node)  | See Sticky Note1                                                                                  |
| Post File Download in N8N (Google Drive Node)  | Google Drive                   | Downloads the triggered file                   | Post File Upload in Google Drive Folder Trigger | AI Caption generated by OpenAI                | See Sticky Note                                                                                   |
| AI Caption generated by OpenAI                 | OpenAI (Langchain)             | Generates Instagram caption                    | Post File Download in N8N (Google Drive Node) | Post File Save in Google Sheets                 | See Sticky Note5                                                                                  |
| Post File Save in Google Sheets                 | Google Sheets                  | Logs file and caption data                      | AI Caption generated by OpenAI           | Connect Facebook API for Publishing Instagram Post using N8N | See Sticky Note6                                                                                  |
| Connect Facebook API for Publishing Instagram Post using N8N | Facebook Graph API             | Creates Instagram media object                  | Post File Save in Google Sheets           | Finally Post to Instagram                       | See Sticky Note7                                                                                  |
| Finally Post to Instagram                       | Facebook Graph API             | Publishes media object to Instagram             | Connect Facebook API for Publishing Instagram Post using N8N | -                                              | See Sticky Note8                                                                                  |

---

### 4. Reproducing the Workflow from Scratch

1. **Create Google Drive Trigger Node**  
   - Type: Google Drive Trigger  
   - Configure to watch a specific folder by folder ID (e.g., `1VfkhYImlmEXw70IrJvvZKO6mM164zMD6`)  
   - Set event to `fileCreated`  
   - Poll every minute  
   - Add Google Drive OAuth2 credentials  

2. **Add Google Drive Node to Download File**  
   - Type: Google Drive  
   - Operation: Download  
   - File ID: Set to `={{ $json.id }}` from trigger node output  
   - Use same Google Drive OAuth2 credentials  
   - Connect trigger node output to this node input  

3. **Add OpenAI Node for Caption Generation**  
   - Type: OpenAI (Langchain)  
   - Model: GPT-4O-MINI (or preferred GPT-4 variant)  
   - Prompt: Generate engaging Instagram caption based on file name from trigger node, including emojis, hashtags, call-to-action, max 150 characters  
   - Credentials: OpenAI API key  
   - Connect Google Drive download node output to this node input  

4. **Add Google Sheets Node to Log Data**  
   - Type: Google Sheets  
   - Operation: Append or update row  
   - Document ID: Your Google Sheet ID  
   - Sheet Name: e.g., `Sheet1` or `gid=0`  
   - Columns to map:  
     - Name: `={{ $('Post File Download in N8N (Google Drive Node)').item.json.name }}`  
     - Captions: `={{ $json.choices[0].message.content }}` (OpenAI output)  
     - Reel Urls: `={{ $('Post File Download in N8N (Google Drive Node)').item.json.webViewLink }}`  
     - Reel Thumbnail: `={{ $('Post File Download in N8N (Google Drive Node)').item.json.thumbnailLink }}`  
   - Credentials: Google Sheets OAuth2 credentials  
   - Connect OpenAI node output to this node input  

5. **Add Facebook Graph API Node to Create Instagram Media**  
   - Type: Facebook Graph API  
   - Operation: POST to `/media` edge of your Instagram Business Account ID  
   - Parameters:  
     - video_url: `={{ $json['Reel Urls '] }}` (from Google Sheets)  
     - media-type: `REELS`  
     - caption: `={{ $json.Captions }}` (from Google Sheets)  
     - image_url: `={{ $json['Reel Thumbnail'] }}` (from Google Sheets)  
   - Credentials: Facebook Graph API OAuth2 credentials  
   - Connect Google Sheets node output to this node input  

6. **Add Facebook Graph API Node to Publish Instagram Post**  
   - Type: Facebook Graph API  
   - Operation: POST to `/media_publish` edge of your Instagram Business Account ID  
   - Parameter: `creation_id` set to `={{ $json.id }}` from previous Facebook API node output  
   - Credentials: Facebook Graph API OAuth2 credentials  
   - Connect media creation node output to this node input  

7. **Add Sticky Notes** (Optional but recommended)  
   - Add sticky notes near each block with setup instructions and tutorial links for easier maintenance and onboarding.

8. **Credential Setup**  
   - Google Drive OAuth2: Connect your Google account with Drive access  
   - Google Sheets OAuth2: Connect your Google account with Sheets access  
   - OpenAI API: Add your OpenAI API key  
   - Facebook Graph API OAuth2: Connect your Facebook Developer account with Instagram Business/Creator account access  

9. **Testing and Scheduling**  
   - Test the workflow with a single file upload to the Google Drive folder  
   - Monitor executions and logs in n8n dashboard  
   - Optionally add a scheduler node if you want periodic checks instead of trigger-based  

---

### 5. General Notes & Resources

| Note Content                                                                                                          | Context or Link                                                                                      |
|-----------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------|
| Workflow tutorial videos covering all setup steps and node configurations.                                            | https://youtu.be/L3NUp2XP_h0?si=KAjHYEZ-qedIM-n                                                    |
| Ensure Instagram Business or Creator account is connected to a Facebook Page for API posting permissions.             | Facebook Developer documentation and Instagram Graph API requirements                               |
| Supported Instagram media aspect ratios: 1:1, 4:5, or 16:9 for images and reels.                                       | Instagram API media guidelines                                                                      |
| OpenAI caption generation prompt is optimized for concise, engaging, and relatable Instagram captions with hashtags. | Prompt can be customized in the OpenAI node for different tone or style                              |
| Google Sheet columns must be named exactly as configured: Name, Caption, Reel Urls, Reel Thumbnail.                    | Sheet must be shared with the Google Sheets OAuth2 account used in n8n                             |
| Facebook Graph API tokens may expire; set up token refresh or error handling in production workflows.                  | Facebook API best practices                                                                         |

---

This document provides a complete, structured reference for understanding, reproducing, and modifying the Instagram automation workflow using Google Drive, OpenAI, and Facebook Graph API in n8n.