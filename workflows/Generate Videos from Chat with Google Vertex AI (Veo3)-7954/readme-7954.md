Generate Videos from Chat with Google Vertex AI (Veo3)

https://n8nworkflows.xyz/workflows/generate-videos-from-chat-with-google-vertex-ai--veo3--7954


# Generate Videos from Chat with Google Vertex AI (Veo3)

### 1. Workflow Overview

This workflow automates the generation of short AI-generated videos from chat prompts using Google Vertex AI‚Äôs Veo3 model. It enables users to type a text prompt in an n8n chat interface and receive a video output generated by the Veo3 API. The workflow handles the entire process: receiving the prompt, submitting it to Google Vertex AI, polling for video generation status, extracting the video data, converting it into a downloadable file, and making it ready for further use or distribution.

The workflow is logically divided into the following blocks:

- **1.1 Chat Input Reception:** Trigger on receiving a chat message that contains the video prompt.
- **1.2 Video Generation Request:** Send the prompt to Google Vertex AI‚Äôs Veo3 model for video creation.
- **1.3 Polling Loop for Video Completion:** Repeatedly check the status of the video generation operation until the video is ready.
- **1.4 Video Data Extraction and Conversion:** Extract the base64 encoded video, metadata, and convert it into a binary file.
- **1.5 Output Delivery:** Prepared video file is ready for download or further processing.

---

### 2. Block-by-Block Analysis

#### 2.1 Chat Input Reception

- **Overview:**  
  Starts the workflow upon receiving a chat message. This message serves as the video prompt input for the AI model.

- **Nodes Involved:**  
  - When chat message received  
  - Sticky Note (label: ‚ÄúChat Trigger‚Äù)

- **Node Details:**  
  - **When chat message received**  
    - Type: `@n8n/n8n-nodes-langchain.chatTrigger` (Chat Trigger)  
    - Role: Listens for any incoming chat message to start the workflow.  
    - Configuration: Default options, no filters applied; assumes any chat message is a prompt.  
    - Inputs: External chat message event  
    - Outputs: Chat message data (accessed as `$json.chatInput` in subsequent nodes)  
    - Failure Modes: No message received, or malformed message data.  
    - No sub-workflow or special version requirements.

  - **Sticky Note (Chat Trigger)**  
    - Visual aid, no functional role.

#### 2.2 Video Generation Request

- **Overview:**  
  Sends the user‚Äôs prompt to the Google Vertex AI Veo3 model endpoint, initiating the video generation request.

- **Nodes Involved:**  
  - Post Veo3 Fast  
  - Sticky Note (label: ‚ÄúPost to Google Vertex AI (Veo3)‚Äù)

- **Node Details:**  
  - **Post Veo3 Fast**  
    - Type: `HTTP Request` node  
    - Role: Sends a POST request to the Vertex AI long-running prediction API.  
    - Configuration:  
      - URL: `<<<VERTEX_PREDICT_LONG_RUNNING_URL>>>` (placeholder for the actual API endpoint)  
      - Method: POST  
      - Body (JSON):  
        ```json
        {
          "instances": [{ "prompt": "{{ $json.chatInput }}" }],
          "parameters": {
            "aspectRatio": "16:9",
            "durationSeconds": 8,
            "resolution": "720p",
            "sampleCount": 1
          }
        }
        ```  
      - Authentication: Google OAuth2 (predefined credential type)  
    - Inputs: Chat message from ‚ÄúWhen chat message received‚Äù  
    - Outputs: Operation metadata including `name` used as operation ID to poll.  
    - Edge cases/failures:  
      - Authentication failure (invalid or expired Google OAuth token)  
      - API errors (quota exceeded, invalid prompt, service downtime)  
      - Network issues  
    - Version: n8n HTTP Request node v4.2  
    - No sub-workflow.

  - **Sticky Note (Post to Google Vertex AI (Veo3))**  
    - Describes this block‚Äôs purpose and connection to Vertex AI.

#### 2.3 Polling Loop for Video Completion

- **Overview:**  
  Implements a loop that waits and then polls the Vertex AI operation endpoint to check if the video generation is complete.

- **Nodes Involved:**  
  - Wait  
  - Poll for Video  
  - If  
  - Wait1  
  - Sticky Note (labels: ‚ÄúPoll Video Loop‚Äù)

- **Node Details:**  
  - **Wait**  
    - Type: `Wait` node  
    - Role: Introduces a 15-second delay between poll attempts to avoid excessive requests.  
    - Configuration: Wait for 15 seconds  
    - Inputs: From ‚ÄúPost Veo3 Fast‚Äù  
    - Outputs: To ‚ÄúPoll for Video‚Äù  
    - Edge cases: Excessive wait time slows workflow; too short may trigger API rate limits.  
    - Version: v1.1

  - **Poll for Video**  
    - Type: `HTTP Request` node  
    - Role: Sends a POST request to the Vertex AI operation fetch URL to check status of the video generation.  
    - Configuration:  
      - URL: `<<<VERTEX_FETCH_OPERATION_URL>>>` (placeholder for operation status URL)  
      - Method: POST  
      - Body (JSON):  
        ```json
        {
          "operationName": "{{$json.name}}"
        }
        ```  
      - Authentication: Google OAuth2  
    - Inputs: From ‚ÄúWait‚Äù and ‚ÄúWait1‚Äù nodes (loop back)  
    - Outputs: JSON containing operation status and video data if complete  
    - Edge cases:  
      - Operation name missing or invalid  
      - API errors or timeouts  
      - Operation failure status returned by API  
    - Version: v4.2

  - **If**  
    - Type: `If` node  
    - Role: Checks if the video generation is complete or still processing.  
    - Configuration:  
      - Condition: Checks a JSON path or flag indicating operation completion (exact condition is blank in JSON; should be set to check completion status, e.g., `status == "done"` or similar)  
    - Inputs: From ‚ÄúPoll for Video‚Äù  
    - Outputs:  
      - True branch: Goes to ‚ÄúEdit Fields‚Äù to process video  
      - False branch: Goes to ‚ÄúWait1‚Äù to pause before polling again  
    - Edge cases: Incorrect condition configuration may cause infinite loops or premature exit  
    - Version: v2.2

  - **Wait1**  
    - Type: `Wait` node  
    - Role: Waits before re-polling the operation status (no explicit time set, defaults likely zero or needs configuration)  
    - Inputs: From ‚ÄúIf‚Äù false branch  
    - Outputs: To ‚ÄúPoll for Video‚Äù to continue polling loop  
    - Edge cases: If no wait time set, may cause rapid polling, risking rate limits or API blocking  
    - Version: v1.1

  - **Sticky Note (Poll Video Loop)**  
    - Describes the loop‚Äôs purpose of polling until video is ready.

#### 2.4 Video Data Extraction and Conversion

- **Overview:**  
  Once video generation is complete, extracts base64-encoded video data and metadata, then converts it into a binary file for download or further use.

- **Nodes Involved:**  
  - Edit Fields  
  - Convert to File  
  - Sticky Note (label: ‚ÄúDownload Binary‚Äù)

- **Node Details:**  
  - **Edit Fields**  
    - Type: `Set` node  
    - Role: Extracts and assigns key video fields from the API response into new JSON properties.  
    - Configuration:  
      - Assigns:  
        - `b64` ‚Üê base64 video content (`$json.response.videos[0].bytesBase64Encoded`)  
        - `mime` ‚Üê MIME type of video (`$json.response.videos[0].mimeType`)  
        - `filename` ‚Üê fixed string `"veo_sample_video"`  
    - Inputs: From ‚ÄúIf‚Äù true branch (video ready)  
    - Outputs: To ‚ÄúConvert to File‚Äù  
    - Edge cases: Missing video data or malformed JSON may cause undefined variables or errors  
    - Version: 3.4

  - **Convert to File**  
    - Type: `Convert To File` node  
    - Role: Converts base64 string stored in `b64` property into binary file data.  
    - Configuration:  
      - Operation: `toBinary`  
      - Source Property: `b64`  
    - Inputs: From ‚ÄúEdit Fields‚Äù  
    - Outputs: Binary file data ready for download or use in subsequent workflow steps  
    - Edge cases: If `b64` is empty or corrupted, conversion will fail  
    - Version: 1.1

  - **Sticky Note (Download Binary)**  
    - Describes this block as responsible for extracting and converting the video to a downloadable file.

---

### 3. Summary Table

| Node Name                 | Node Type                        | Functional Role                     | Input Node(s)              | Output Node(s)           | Sticky Note                                                                                     |
|---------------------------|---------------------------------|-----------------------------------|----------------------------|--------------------------|------------------------------------------------------------------------------------------------|
| When chat message received| Chat Trigger (`@n8n/n8n-nodes-langchain.chatTrigger`) | Trigger workflow on chat input    | (External Event)            | Post Veo3 Fast            | Chat Trigger                                                                                   |
| Post Veo3 Fast            | HTTP Request                    | Send prompt to Vertex AI Veo3     | When chat message received  | Wait                     | Post to Google Vertex AI (Veo3)                                                               |
| Wait                      | Wait                           | Delay before polling status       | Post Veo3 Fast              | Poll for Video            | Poll Video Loop                                                                               |
| Poll for Video            | HTTP Request                   | Poll video generation status      | Wait, Wait1                | If                       | Poll Video Loop                                                                               |
| If                        | If                             | Check if video generation done    | Poll for Video              | Edit Fields (true), Wait1 (false) | Poll Video Loop                                                                               |
| Wait1                     | Wait                           | Delay before next polling         | If (false branch)           | Poll for Video            | Poll Video Loop                                                                               |
| Edit Fields               | Set                            | Extract video base64 & metadata   | If (true branch)            | Convert to File           | Download Binary                                                                              |
| Convert to File           | Convert To File                | Convert base64 string to binary   | Edit Fields                 | (End of flow)             | Download Binary                                                                              |
| Sticky Note               | Sticky Note                    | Visual aid                       | -                          | -                        | Chat Trigger                                                                                   |
| Sticky Note1              | Sticky Note                    | Visual aid                       | -                          | -                        | Post to Google Vertex AI (Veo3)                                                               |
| Sticky Note2              | Sticky Note                    | Visual aid                       | -                          | -                        | Poll Video Loop                                                                               |
| Sticky Note3              | Sticky Note                    | Visual aid                       | -                          | -                        | Download Binary                                                                              |
| Sticky Note4              | Sticky Note                    | Project description, instructions| -                          | -                        | üé¨ Generate Videos from Chat with Google Vertex AI (Veo3) - Full project overview and YouTube link |

---

### 4. Reproducing the Workflow from Scratch

1. **Create Chat Trigger Node**  
   - Add node: `@n8n/n8n-nodes-langchain.chatTrigger`  
   - Purpose: Start workflow on chat message input  
   - Configuration: Default settings, no filters

2. **Create HTTP Request Node for Video Generation (Post Veo3 Fast)**  
   - Add node: `HTTP Request`  
   - Set method to POST  
   - URL: Replace with your Google Vertex AI long-running predict URL (e.g., `https://vertexai.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/models/MODEL_ID:predict`)  
   - Authentication: Set to Google OAuth2 credentials (OAuth2 with Google Cloud project enabled for Vertex AI API)  
   - Body (JSON):  
     ```json
     {
       "instances": [{ "prompt": "{{ $json.chatInput }}" }],
       "parameters": {
         "aspectRatio": "16:9",
         "durationSeconds": 8,
         "resolution": "720p",
         "sampleCount": 1
       }
     }
     ```  
   - Connect output of Chat Trigger to this node

3. **Create Wait Node (Wait)**  
   - Add node: `Wait`  
   - Set wait duration to 15 seconds  
   - Connect output of ‚ÄúPost Veo3 Fast‚Äù to this node

4. **Create HTTP Request Node for Polling (Poll for Video)**  
   - Add node: `HTTP Request`  
   - Set method to POST  
   - URL: Replace with your Vertex AI operation fetch URL (e.g., `https://vertexai.googleapis.com/v1/operations:fetch`)  
   - Authentication: Same Google OAuth2 credentials  
   - Body (JSON):  
     ```json
     {
       "operationName": "{{$json.name}}"
     }
     ```  
   - Connect output of ‚ÄúWait‚Äù to this node

5. **Create If Node (If)**  
   - Add node: `If`  
   - Configure condition to check if the video generation operation is complete. For example, check if `$json.done` equals `true` or appropriate status field from the API response indicates completion.  
   - Connect output of ‚ÄúPoll for Video‚Äù to this node

6. **Create Wait Node (Wait1)**  
   - Add node: `Wait`  
   - Configure a delay (e.g., 15 seconds) to avoid rapid polling (the original config has empty parameters, so set appropriately)  
   - Connect ‚Äòfalse‚Äô output of ‚ÄúIf‚Äù to this node

7. **Loop back Wait1 to Poll for Video**  
   - Connect output of ‚ÄúWait1‚Äù back to ‚ÄúPoll for Video‚Äù to continue polling

8. **Create Set Node (Edit Fields)**  
   - Add node: `Set`  
   - Configure fields:  
     - `b64` = `{{$json.response.videos[0].bytesBase64Encoded}}`  
     - `mime` = `{{$json.response.videos[0].mimeType}}`  
     - `filename` = `"veo_sample_video"` (hardcoded)  
   - Connect ‚Äòtrue‚Äô output of ‚ÄúIf‚Äù to this node

9. **Create Convert To File Node (Convert to File)**  
   - Add node: `Convert To File`  
   - Operation: `toBinary`  
   - Source Property: `b64`  
   - Connect output of ‚ÄúEdit Fields‚Äù to this node

10. **Credentials Setup**  
    - Configure Google OAuth2 credentials under n8n credentials with proper scopes for Vertex AI:  
      - `https://www.googleapis.com/auth/cloud-platform`  
      - Ensure project has Vertex AI API enabled, and service account/user has required permissions.

11. **Optional: Add Sticky Notes for Documentation**  
    - Add sticky notes as visual labels for each logical block: Chat Trigger, Post to Vertex AI, Poll Video Loop, Download Binary, and overall project description.

---

### 5. General Notes & Resources

| Note Content                                                                                                                                                                                                                     | Context or Link                                             |
|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------|
| üé¨ Generate Videos from Chat with Google Vertex AI (Veo3). Turn any text prompt into short AI-generated videos directly from an n8n chat. Watch step-by-step guides here: www.youtube.com/@automatewithmarc                                                                 | Sticky Note4 (Project overview and instructions)            |
| Requires an active Google Cloud Project with Vertex AI API enabled. OAuth2 credentials must be configured within n8n to authenticate API requests.                                                                               | Google Cloud Platform and n8n credential setup               |
| Parameters such as aspect ratio, resolution, and duration are configurable in the POST body to customize the video output.                                                                                                        | Post Veo3 Fast node configuration                            |
| Be mindful of API quota limits and rate limits when setting polling intervals to avoid workflow failures or account suspension.                                                                                                   | Polling loop design notes                                    |
| Video output is delivered as base64 encoded data; conversion to binary is necessary for file download or further integration (e.g., Google Drive, Slack).                                                                         | Convert to File node role                                    |

---

**Disclaimer:** The provided text is exclusively from an automated workflow created with n8n, an integration and automation tool. This processing strictly complies with current content policies and contains no illegal, offensive, or protected elements. All manipulated data is legal and public.