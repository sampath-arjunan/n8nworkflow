Consolidate Daily Google Form Submissions into One Gmail Recap

https://n8nworkflows.xyz/workflows/consolidate-daily-google-form-submissions-into-one-gmail-recap-7431


# Consolidate Daily Google Form Submissions into One Gmail Recap

---

### 1. Workflow Overview

This workflow consolidates daily submissions from a Google Form linked to a Google Sheet and sends a single summarized email via Gmail every day at 5 PM. It is designed for use cases where one wants to receive a daily recap of form responses instead of individual notifications. The workflow is logically divided into the following blocks:

- **1.1 Input Reception and Trigger:** Automatically triggers at 5 PM daily, detecting new rows (form submissions) added to a specified Google Sheet.
- **1.2 Data Aggregation and Email Generation:** Aggregates all the new rows collected during the day, categorizes questions by their categories, and formats an HTML summary.
- **1.3 Email Sending:** Sends the composed HTML summary as an email via Gmail to a predefined recipient.

---

### 2. Block-by-Block Analysis

#### 2.1 Input Reception and Trigger

- **Overview:**  
  This block triggers the workflow once daily at 5 PM and fetches all new rows added to the Google Sheet linked to the Google Form responses.

- **Nodes Involved:**  
  - Trigger data for new row (Google Sheets Trigger)

- **Node Details:**  

  - **Trigger data for new row**  
    - **Type:** Google Sheets Trigger  
    - **Role:** Initiates the workflow by monitoring the Google Sheet for newly added rows within the specified range.  
    - **Configuration:**  
      - Event: `rowAdded`  
      - Data Location: Range set to `A1:Z1000` (specifying the sheet area to monitor)  
      - Polling time: 17:00 (5 PM daily)  
      - Sheet name and document ID specified by URL and ID mode respectively  
    - **Inputs:** None (trigger node)  
    - **Outputs:** Emits all newly added rows detected since the last run at 5 PM  
    - **Version:** Compatible with n8n Google Sheets Trigger v1  
    - **Potential Edge Cases:**  
      - Authentication failures (expired or revoked Google OAuth tokens)  
      - No new rows added on the day (the downstream nodes must handle empty input gracefully)  
      - Incorrect sheet or range configuration leading to missed data  
    - **Sub-Workflow:** None

#### 2.2 Data Aggregation and Email Generation

- **Overview:**  
  This block receives all daily new rows from the trigger, parses and categorizes the submitted questions, and generates an HTML formatted summary for the email body.

- **Nodes Involved:**  
  - Generate the email (Code)

- **Node Details:**  

  - **Generate the email**  
    - **Type:** Code Node (JavaScript)  
    - **Role:** Processes the input rows to build an organized HTML summary grouped by question categories.  
    - **Configuration:**  
      - JavaScript code loops through all input rows, extracting category, question, and sender information using a helper function `pick` to handle varied naming conventions for keys.  
      - If category or question fields are missing, defaults ("Non classé" for category, "(no question)" for question, "Anonymous" for sender) are used.  
      - The output is a single JSON object with an `html` string containing the summary and a `count` of total questions.  
    - **Key Expressions/Variables:**  
      - `$input.all()` to get all input items  
      - `pick()` helper function to flexibly map possible field names  
      - HTML string construction with headings and unordered lists  
    - **Inputs:** Receives multiple new row items from the trigger node  
    - **Outputs:** Single JSON object with `html` and `count` fields  
    - **Version:** Compatible with n8n Code Node v2  
    - **Potential Edge Cases:**  
      - Input rows with inconsistent or missing fields may produce partial summaries  
      - Large number of rows could impact performance or create very long emails  
      - JavaScript errors if input data structure changes unexpectedly  
    - **Sub-Workflow:** None

#### 2.3 Email Sending

- **Overview:**  
  This final block sends the generated HTML summary via Gmail to the specified email address.

- **Nodes Involved:**  
  - Sum up email (Gmail)

- **Node Details:**  

  - **Sum up email**  
    - **Type:** Gmail Node  
    - **Role:** Sends the composed HTML summary email to a defined recipient with a fixed subject line.  
    - **Configuration:**  
      - Recipient email: Specified as `"email"` (likely must be replaced or configured with a real email address in actual use)  
      - Email subject: `"The requests you received today"`  
      - Message body: Uses expression `{{$json.html}}` to insert the HTML generated by the previous code node  
      - No additional options set  
      - Credentials: Gmail OAuth2 credentials configured for the sender’s account  
    - **Inputs:** Receives JSON with `html` content from the code node  
    - **Outputs:** None (terminal node)  
    - **Version:** Compatible with n8n Gmail OAuth2 node v2.1  
    - **Potential Edge Cases:**  
      - Authentication errors due to expired or revoked Gmail OAuth tokens  
      - Delivery failures if recipient email is invalid or blocked  
      - HTML content not rendered properly if malformed  
    - **Sub-Workflow:** None

---

### 3. Summary Table

| Node Name               | Node Type                 | Functional Role                     | Input Node(s)          | Output Node(s)      | Sticky Note                                                                                              |
|-------------------------|---------------------------|-----------------------------------|------------------------|---------------------|--------------------------------------------------------------------------------------------------------|
| Trigger data for new row | Google Sheets Trigger     | Daily trigger and data fetch      | None                   | Generate the email   | ## 1.Workflow trigger et data gathering The workflow is **triggered automatically** everyday at 5pm. How to setup: - Set up your Google form and link it to a google sheet - link the google sheet to this workflow |
| Generate the email       | Code                      | Aggregate data and generate HTML  | Trigger data for new row| Sum up email        | ## 2. Send the email The code node will create the message and gather all the informations wanted about the row added during the day and will list them (row newly added). So a full sum up will be sent in one message only. How to setup: - Connect with your Gmail account credentials. |
| Sum up email            | Gmail                     | Send the daily summary email      | Generate the email      | None                |                                                                                                        |
| Sticky Note1             | Sticky Note               | Notes on required accounts        | None                   | None                | ## Required - Google account - Google Form - Google Sheet linked to the form                            |
| Sticky Note              | Sticky Note               | Notes on trigger and data gathering| None                  | None                | ## 1.Workflow trigger et data gathering The workflow is **triggered automatically** everyday at 5pm. How to setup: - Set up your Google form and link it to a google sheet - link the google sheet to this workflow |
| Sticky Note3             | Sticky Note               | Notes on email sending setup      | None                   | None                | ## 2. Send the email The code node, will create the message and gather all the informations wanted about the row added during the day and will list them (row newly added). So a full sum up will be sent in one message only. How to setup: - Connect with your Gmail account credentials. |

---

### 4. Reproducing the Workflow from Scratch

1. **Create the Google Sheets Trigger node:**  
   - Add node: Google Sheets Trigger  
   - Set event to `rowAdded`  
   - Configure the data range monitored as `A1:Z1000` (adjust as needed for your sheet)  
   - Set polling time to 17:00 (5 PM daily)  
   - Specify the Google Sheet by entering the document URL and sheet name or ID  
   - Connect Google Sheets OAuth2 credentials with access to the target sheet

2. **Create the Code node to generate the email content:**  
   - Add node: Code (JavaScript)  
   - Paste the provided script that processes all input rows, categorizes them, and generates an HTML summary with counts and question lists grouped by category  
   - Ensure the node receives input from the Google Sheets Trigger node

3. **Create the Gmail node to send the email:**  
   - Add node: Gmail  
   - Set the recipient email address (replace `"email"` with the actual recipient)  
   - Set the email subject to `"The requests you received today"`  
   - Set the message body to use an expression referencing the previous node output: `{{$json.html}}`  
   - Choose HTML format for the email body  
   - Connect Gmail OAuth2 credentials with permission to send emails

4. **Connect the nodes:**  
   - Connect Google Sheets Trigger → Code node  
   - Connect Code node → Gmail node

5. **Set workflow execution settings:**  
   - Ensure the workflow is set to active  
   - Confirm polling schedules and credentials are valid

6. **Optional: Add Sticky Notes for documentation:**  
   - Add notes describing prerequisites (Google account, Form, Sheet)  
   - Add notes explaining trigger and email sending setup for clarity

---

### 5. General Notes & Resources

| Note Content                                                                                   | Context or Link                                                         |
|------------------------------------------------------------------------------------------------|------------------------------------------------------------------------|
| The workflow requires a Google account with access to Google Forms and Google Sheets.         | Setup prerequisite                                                     |
| Google Sheet must be linked as response destination for the Google Form to capture submissions.| Google Forms integration                                               |
| Gmail OAuth2 credentials must be authorized to send emails on behalf of the user.              | Gmail API and OAuth2 setup                                             |
| The workflow consolidates all submissions received during the day into a single email at 5 PM. | Use case: daily email summaries instead of per-submission notifications|
| Review Google Sheets range and polling time to match your form submission volume and schedule. | To avoid missed data or duplicates                                     |

---

**Disclaimer:**  
The text provided is derived exclusively from an automated workflow created with n8n, a tool for integration and automation. This processing strictly complies with current content policies and contains no illegal, offensive, or protected elements. All data handled is legal and public.

---