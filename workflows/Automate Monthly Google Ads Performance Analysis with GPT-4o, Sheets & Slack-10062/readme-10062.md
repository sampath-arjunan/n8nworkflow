Automate Monthly Google Ads Performance Analysis with GPT-4o, Sheets & Slack

https://n8nworkflows.xyz/workflows/automate-monthly-google-ads-performance-analysis-with-gpt-4o--sheets---slack-10062


# Automate Monthly Google Ads Performance Analysis with GPT-4o, Sheets & Slack

### 1. Workflow Overview

This workflow automates a monthly performance analysis of Google Ads campaigns by extracting the last 30 days of ad data, processing it to identify trends and themes, and leveraging GPT-4o AI to generate actionable insights. The analysis results are then archived in Google Sheets and shared with the team via Slack.

Logical blocks included:

- **1.1 Monthly Trigger**: Initiates the workflow on the 1st day of each month.
- **1.2 Data Retrieval**: Queries Google Ads API for recent ad performance metrics.
- **1.3 Data Preparation**: Processes raw API data to group ads by category and theme, calculates CTRs, and formats a prompt for AI analysis.
- **1.4 AI Analysis**: Uses an n8n AI Agent backed by GPT-4o to analyze the summarized data and generate recommendations.
- **1.5 Report Generation**: Converts the AI output into a formatted markdown report.
- **1.6 Archiving and Notification**: Saves the report to Google Sheets and sends it via Slack to the team.

---

### 2. Block-by-Block Analysis

#### 1.1 Monthly Trigger

- **Overview:**  
  Runs automatically on the first day of each month to start the performance analysis for the preceding 30 days.

- **Nodes Involved:**  
  - Monthly Trigger

- **Node Details:**  
  - **Monthly Trigger**  
    - Type: Schedule Trigger  
    - Configuration: Cron expression `0 0 1 * *` (runs at midnight on the 1st day of every month)  
    - Input: None (trigger node)  
    - Output: Triggers "Get Performance Data" node  
    - Failure Modes: Cron misconfigurations, n8n service downtime at trigger time  
    - Notes: Ensures timely monthly execution without manual intervention

#### 1.2 Data Retrieval

- **Overview:**  
  Retrieves Google Ads performance data using Google Ads Query Language (GAQL), filtering out ads with fewer than 100 impressions to maintain statistical validity.

- **Nodes Involved:**  
  - Get Performance Data

- **Node Details:**  
  - **Get Performance Data**  
    - Type: HTTP Request  
    - Configuration:  
      - Method: POST  
      - URL: Google Ads API endpoint dynamically built using environment variables for API version and customer ID  
      - Body: GAQL query selecting ad ID, headlines, ad group name, impressions, clicks, CTR for ads with >100 impressions during last 30 days, limited to top 1000 by clicks  
      - Authentication: Google Ads OAuth2 credential  
    - Input: Trigger from Monthly Trigger node  
    - Output: Raw JSON response with ad performance data  
    - Failure Modes: API authentication errors, rate limits, malformed queries, network issues  
    - Notes: Filters low-impression ads to improve data quality

#### 1.3 Data Preparation

- **Overview:**  
  Processes the raw Google Ads data to group ads by category (ad group) and theme keywords, calculates CTR statistics, and formats the data into a prompt for AI analysis.

- **Nodes Involved:**  
  - Prepare Performance Data

- **Node Details:**  
  - **Prepare Performance Data**  
    - Type: Code (JavaScript)  
    - Configuration:  
      - Parses API results  
      - Groups ads by ad group name (category) aggregating impressions, clicks, and ads list  
      - Scans ad headlines for predefined themes (e.g., ‚Äúvegan,‚Äù ‚Äúorganic,‚Äù ‚Äúsale‚Äù) and aggregates metrics by theme  
      - Calculates CTR percentages for categories and themes  
      - Constructs an AI prompt summarizing top/bottom performers and requesting 3-5 actionable recommendations with estimated impact and priority  
    - Input: JSON data from "Get Performance Data"  
    - Output: JSON object including total ads analyzed, date range, top/bottom performing categories and themes, and the AI prompt string  
    - Failure Modes: Code execution errors, unexpected data shapes, empty data sets  
    - Notes: Includes threshold filtering on impressions; themes are hardcoded in script

#### 1.4 AI Analysis

- **Overview:**  
  Sends the prepared prompt to an n8n AI Agent using GPT-4o to analyze the data and generate detailed performance insights and recommendations.

- **Nodes Involved:**  
  - AI Agent - Analyze Performance  
  - OpenAI Chat Model

- **Node Details:**  
  - **AI Agent - Analyze Performance**  
    - Type: n8n AI Agent (Langchain Agent)  
    - Configuration:  
      - Input text: The prompt generated by "Prepare Performance Data"  
      - System message: Instructs AI to act as a Google Ads performance analyst, returning valid JSON with specific recommendations  
      - Prompt type: Defined prompt  
    - Input: JSON with prompt from "Prepare Performance Data"  
    - Output: AI-generated JSON with actionable recommendations  
    - Failure Modes: AI service downtime, malformed prompt, rate limits, unexpected output formats  
    - Notes: Connects downstream to "Generate Report"  
  - **OpenAI Chat Model**  
    - Type: Language Model node for OpenAI GPT-4o  
    - Configuration:  
      - Model: gpt-4o  
      - Temperature: 0.2 (low for analytical focus)  
      - Max tokens: 2000  
      - Credential: OpenAI API key via OAuth2  
    - Input: From AI Agent  
    - Output: AI textual response forwarded to agent node  
    - Failure Modes: API quota, network failures, invalid credentials

#### 1.5 Report Generation

- **Overview:**  
  Parses the AI output to extract recommendations and generates a human-readable markdown report summarizing performance insights and next steps.

- **Nodes Involved:**  
  - Generate Report

- **Node Details:**  
  - **Generate Report**  
    - Type: Code (JavaScript)  
    - Configuration:  
      - Extracts AI response string from input  
      - Attempts to parse JSON from AI output, including handling code block formatting  
      - Builds a markdown report with:  
        - Executive summary (ads analyzed, date range, report date)  
        - Top performing categories and themes with CTR and counts  
        - List of AI recommendations with priority and expected impact  
        - Suggested next steps for the team  
    - Input: AI output and performance data from earlier nodes  
    - Output: JSON with markdown report text, parsed recommendations, metadata  
    - Failure Modes: Parsing errors if AI output is malformed, missing data fields  
    - Notes: Report is formatted for Slack and archival

#### 1.6 Archiving and Notification

- **Overview:**  
  Archives the generated report in a Google Sheet and sends it to the team Slack channel via webhook.

- **Nodes Involved:**  
  - Save Report to Sheets  
  - Send Report

- **Node Details:**  
  - **Save Report to Sheets**  
    - Type: Google Sheets node  
    - Configuration:  
      - Document ID from environment variable  
      - Sheet name: "Performance Reports"  
      - Operation: Append or insert the report data (exact sheet operation details implicit)  
    - Input: Markdown report from "Generate Report"  
    - Output: Confirmation of sheet write operation  
    - Failure Modes: Google API auth errors, permission issues, invalid document ID  
  - **Send Report**  
    - Type: Slack node  
    - Configuration:  
      - Uses configured Slack webhook ID  
      - Sends markdown report as text message  
    - Input: Markdown report from "Save Report to Sheets"  
    - Output: Slack message confirmation  
    - Failure Modes: Slack webhook invalid, network issues

---

### 3. Summary Table

| Node Name                   | Node Type                         | Functional Role                         | Input Node(s)              | Output Node(s)               | Sticky Note                                                                                       |
|-----------------------------|----------------------------------|---------------------------------------|----------------------------|-----------------------------|-------------------------------------------------------------------------------------------------|
| Monthly Trigger             | Schedule Trigger                 | Starts workflow monthly on 1st        | None                       | Get Performance Data         | üïì Runs every month. Automatically starts on the 1st of each month to analyze last 30 days      |
| Get Performance Data        | HTTP Request                    | Fetches Google Ads performance data   | Monthly Trigger            | Prepare Performance Data     | üìä Fetches ad metrics. Queries Google Ads API for CTR, clicks, impressions; filters <100 impressions |
| Prepare Performance Data    | Code                           | Processes raw data, groups & formats  | Get Performance Data       | AI Agent - Analyze Performance | üßÆ Processes raw metrics. Groups ads by category and themes, calculates CTRs, builds AI prompt  |
| AI Agent - Analyze Performance | n8n AI Agent (Langchain)       | Sends data to GPT-4o for AI analysis  | Prepare Performance Data   | Generate Report              | ü§ñ AI insight generation. Sends summary data to GPT-4o; generates recommendations                 |
| OpenAI Chat Model           | Language Model (OpenAI GPT-4o) | Provides language model for AI Agent  | AI Agent - Analyze Performance | AI Agent - Analyze Performance | Lower temperature (0.2) for analytical tasks                                                     |
| Generate Report             | Code                           | Formats AI output into markdown report | AI Agent - Analyze Performance | Save Report to Sheets        | üßæ Creates readable summary. Converts AI output into formatted markdown report                   |
| Save Report to Sheets       | Google Sheets                  | Archives report in Google Sheets       | Generate Report            | Send Report                 |                                                                                                 |
| Send Report                | Slack                         | Sends report to Slack channel           | Save Report to Sheets      | None                        |                                                                                                 |

---

### 4. Reproducing the Workflow from Scratch

1. **Create "Monthly Trigger" node**  
   - Type: Schedule Trigger  
   - Set Cron expression: `0 0 1 * *` (runs at midnight on 1st of each month)  
   - No credentials needed

2. **Create "Get Performance Data" node**  
   - Type: HTTP Request  
   - Method: POST  
   - URL: `https://googleads.googleapis.com/{{$env.GOOGLE_ADS_API_VERSION}}/customers/{{$env.GOOGLE_ADS_CUSTOMER_ID}}/googleAds:search`  
   - Body Content Type: JSON  
   - Body:  
     ```json
     {
       "query": "SELECT ad_group_ad.ad.id, ad_group_ad.ad.responsive_search_ad.headlines, ad_group.name, metrics.impressions, metrics.clicks, metrics.ctr FROM ad_group_ad WHERE segments.date DURING LAST_30_DAYS AND metrics.impressions > 100 ORDER BY metrics.clicks DESC LIMIT 1000"
     }
     ```  
   - Authentication: Google Ads OAuth2 (configure credentials accordingly)  
   - Connect "Monthly Trigger" main output to this node's input

3. **Create "Prepare Performance Data" node**  
   - Type: Code (JavaScript)  
   - Paste the provided JS code that processes raw data into grouped categories and themes, calculates CTR, and generates AI prompt  
   - Input: Connect from "Get Performance Data" main output

4. **Create "AI Agent - Analyze Performance" node**  
   - Type: n8n AI Agent (Langchain Agent)  
   - Parameters:  
     - Text input: expression `={{$json.analysis_prompt}}`  
     - System message: "You are a Google Ads performance analyst. Analyze the data and provide specific, actionable recommendations. Return valid JSON only."  
     - Prompt type: Define  
   - Input: Connect from "Prepare Performance Data" main output

5. **Create "OpenAI Chat Model" node**  
   - Type: LM Chat OpenAI  
   - Model: `gpt-4o`  
   - Temperature: 0.2  
   - Max tokens: 2000  
   - Credentials: Configure with valid OpenAI API key  
   - Connect AI Agent‚Äôs `ai_languageModel` output to this node's input  
   - Connect this node‚Äôs output back to AI Agent‚Äôs language model input (as per n8n Langchain agent pattern)

6. **Create "Generate Report" node**  
   - Type: Code (JavaScript)  
   - Paste the provided code that parses AI output JSON and builds a markdown report with summary and recommendations  
   - Input: Connect from "AI Agent - Analyze Performance" main output

7. **Create "Save Report to Sheets" node**  
   - Type: Google Sheets  
   - Operation: Append or insert row (configure as needed)  
   - Document ID: Use environment variable `GOOGLE_SHEET_ID`  
   - Sheet Name: `Performance Reports`  
   - Credentials: Google Sheets OAuth2 with write access  
   - Input: Connect from "Generate Report" main output

8. **Create "Send Report" node**  
   - Type: Slack  
   - Configure Slack webhook or OAuth credentials  
   - Message Text: expression `={{$json.report_markdown}}`  
   - Input: Connect from "Save Report to Sheets" main output

9. **Verify all connections:**  
   - Monthly Trigger ‚Üí Get Performance Data  
   - Get Performance Data ‚Üí Prepare Performance Data  
   - Prepare Performance Data ‚Üí AI Agent - Analyze Performance  
   - AI Agent - Analyze Performance ‚Üí Generate Report  
   - Generate Report ‚Üí Save Report to Sheets  
   - Save Report to Sheets ‚Üí Send Report  
   - OpenAI Chat Model is connected to AI Agent‚Äôs language model input/output as required

10. **Set environment variables:**  
    - `GOOGLE_ADS_API_VERSION` (e.g., v14)  
    - `GOOGLE_ADS_CUSTOMER_ID` (Google Ads customer ID)  
    - `GOOGLE_SHEET_ID` (Google Sheets document ID)

11. **Set credentials:**  
    - Google Ads OAuth2 with necessary API scopes  
    - Google Sheets OAuth2 with write permissions  
    - OpenAI API key for GPT-4o model  
    - Slack webhook or OAuth token with chat post permissions

12. **Test the workflow manually on/off schedule to validate data flow and outputs.**

---

### 5. General Notes & Resources

| Note Content                                                                                                                                              | Context or Link                                         |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------|
| The workflow uses a custom GAQL query to filter ads with minimum 100 impressions to ensure statistical significance in CTR analysis.                      | Data quality best practice                              |
| Themes analyzed by the script are hardcoded: ‚Äúvegan,‚Äù ‚Äúorganic,‚Äù ‚Äúnatural,‚Äù ‚Äúpremium,‚Äù ‚Äúsale,‚Äù ‚Äúnew,‚Äù ‚Äúfree shipping.‚Äù Customize as needed.                | Code node "Prepare Performance Data"                    |
| AI prompt instructs GPT-4o to return only valid JSON for easier parsing downstream.                                                                        | AI Agent node parameter                                 |
| Report output is markdown formatted for Slack compatibility and archival in Google Sheets.                                                                | "Generate Report" node                                  |
| Slack messages are sent via webhook; ensure webhook URL has appropriate permissions to post in the target channel.                                         | Slack node configuration                               |
| The workflow assumes API credentials have been properly set up with required scopes and tokens securely stored in n8n credentials manager.                 | Credential management                                   |
| For more on Google Ads API and GAQL: https://developers.google.com/google-ads/api/docs/query/overview                                                        | Official documentation                                  |
| For Langchain n8n AI Agent and GPT-4o usage: https://docs.n8n.io/integrations/ai-agent/                                                                     | n8n AI documentation                                   |

---

This document provides a comprehensive technical reference to understand, reproduce, and maintain the "Automate Monthly Google Ads Performance Analysis with GPT-4o, Sheets & Slack" workflow built in n8n. It covers all nodes, their interconnections, configurations, and potential failure considerations.