ðŸŽ¨ Interactive Image Editor with FLUX.1 Fill Tool for Inpainting

https://n8nworkflows.xyz/workflows/---interactive-image-editor-with-flux-1-fill-tool-for-inpainting-2747


# ðŸŽ¨ Interactive Image Editor with FLUX.1 Fill Tool for Inpainting

### 1. Workflow Overview

This workflow implements an AI-powered interactive image editor inspired by Photoshopâ€™s Generative Fill feature, running entirely in the browser. It enables users to select image areas with a brush tool, input text prompts to guide AI inpainting, compare original and generated images side-by-side, iterate on edits, and save or reuse results.

The workflow is logically divided into three main blocks:

- **1.1 Editor Interface Delivery**: Serves a rich HTML page with embedded JavaScript and CSS that provides the interactive image editor UI, including image selection, brush controls, prompt input, and generation triggers.

- **1.2 Image Processing Pipeline**: Handles incoming requests from the editor, calls the FLUX Fill API with the original image, mask, and prompt parameters, polls for completion, and retrieves the generated image.

- **1.3 Result Delivery and Interaction**: Sends the generated image back to the userâ€™s browser for display in a comparison slider, enabling reuse or saving of the edited image.

---

### 2. Block-by-Block Analysis

#### 2.1 Editor Interface Delivery

- **Overview:**  
  This block serves the interactive HTML editor page to the user upon webhook invocation. It provides UI elements for image selection (including mock images and local upload), brush size adjustment, prompt input, and generation controls. It also loads necessary JS libraries (Konva.js for canvas manipulation, img-comparison-slider for image comparison) and custom CSS/JS for editor logic.

- **Nodes Involved:**  
  - Webhook  
  - Merge  
  - Mockups  
  - Editor page  
  - Respond to Webhook  
  - Sticky Note (general comment on editor delivery)  
  - Sticky Note3 (image array explanation)  
  - Sticky Note4 (HTML editor code explanation)

- **Node Details:**

  - **Webhook**  
    - *Type:* Webhook (HTTP endpoint)  
    - *Role:* Entry point for HTTP requests to path `/flux-fill` supporting multiple HTTP methods.  
    - *Config:* Response mode set to use Respond to Webhook node.  
    - *Connections:* Outputs to Merge and NO OP nodes.  
    - *Edge Cases:* Invalid HTTP methods, missing parameters, or malformed requests could cause failures.

  - **Mockups**  
    - *Type:* Set node  
    - *Role:* Provides an array of default image URLs and titles as mock examples for the editorâ€™s image selector.  
    - *Config:* Hardcoded array of 5 image objects with URLs and titles.  
    - *Connections:* Outputs to Merge node.  
    - *Edge Cases:* URLs must be accessible; broken links will affect UI.

  - **Merge**  
    - *Type:* Merge node  
    - *Role:* Combines the outputs from the Webhook (request data) and Mockups (image array) by position to prepare data for the editor page.  
    - *Config:* Mode set to "combine" by position.  
    - *Connections:* Outputs to Editor page node.  
    - *Edge Cases:* Mismatched input lengths or missing data could cause incomplete merges.

  - **Editor page**  
    - *Type:* HTML node  
    - *Role:* Serves the full HTML content of the interactive editor page.  
    - *Config:*  
      - Embeds Konva.js and img-comparison-slider libraries.  
      - Loads custom CSS and JS from GitHub CDN for editor styling and logic.  
      - Includes UI elements: image selector, brush size slider, prompt input, generation button, parameter sliders (steps, guidance), and modal for image comparison.  
      - Injects dynamic data: image array from Mockups and webhook URL from workflow context.  
    - *Connections:* Outputs to Respond to Webhook node.  
    - *Edge Cases:* Large HTML content could cause slow load; external CDN dependencies may fail if offline.

  - **Respond to Webhook (Editor response)**  
    - *Type:* Respond to Webhook  
    - *Role:* Sends the HTML content as the HTTP response to the initial webhook request.  
    - *Config:* Responds with text content type, body set to the HTML generated by Editor page node.  
    - *Connections:* Terminal node for this branch.  
    - *Edge Cases:* Response size limits or network issues could cause failures.

  - **Sticky Notes**  
    - Provide contextual explanations for the editor interface, image array source, and HTML code usage.

---

#### 2.2 Image Processing Pipeline

- **Overview:**  
  This block receives image editing requests from the editor, extracts the original image and mask data, sends them with prompt and parameters to the FLUX Fill API, waits for processing completion by polling the API, and retrieves the generated image.

- **Nodes Involved:**  
  - NO OP  
  - FLUX Fill  
  - Wait 3 sec  
  - Check FLUX status  
  - Is Ready?  
  - Sticky Note1 (FLUX Fill call explanation)  
  - Sticky Note5 (parameters passed to FLUX Fill)  
  - Sticky Note (Image processing part)

- **Node Details:**

  - **NO OP**  
    - *Type:* No Operation node  
    - *Role:* Acts as a pass-through placeholder to branch the workflow.  
    - *Config:* No parameters.  
    - *Connections:* Outputs to FLUX Fill node.  
    - *Edge Cases:* None.

  - **FLUX Fill**  
    - *Type:* HTTP Request  
    - *Role:* Sends a POST request to FLUX Fill API endpoint to initiate image inpainting.  
    - *Config:*  
      - URL: `https://api.bfl.ml/v1/flux-pro-1.0-fill`  
      - Method: POST  
      - Authentication: HTTP Header Auth with FLUX API key credential  
      - Body parameters:  
        - `prompt`: from incoming JSON body  
        - `steps`, `prompt_upsampling`, `guidance`: from incoming JSON body  
        - `output_format`: fixed to "png"  
        - `safety_tolerance`: fixed to 6  
        - `image`: base64 image data extracted by splitting input string at comma and taking second part  
        - `mask`: base64 mask data extracted similarly  
    - *Connections:* Outputs to Wait 3 sec node.  
    - *Edge Cases:*  
      - Authentication failure if API key invalid  
      - Malformed base64 data causing API errors  
      - API rate limits or downtime  
      - Missing parameters causing request rejection

  - **Wait 3 sec**  
    - *Type:* Wait node  
    - *Role:* Delays workflow execution for 3 seconds to allow FLUX API processing.  
    - *Config:* Fixed 3-second delay.  
    - *Connections:* Outputs to Check FLUX status node.  
    - *Edge Cases:* Delay may be insufficient if processing takes longer; could cause premature polling.

  - **Check FLUX status**  
    - *Type:* HTTP Request  
    - *Role:* Polls FLUX API to check the status of the image generation task.  
    - *Config:*  
      - URL: `https://api.bfl.ml/v1/get_result`  
      - Method: GET  
      - Authentication: HTTP Header Auth with FLUX API key  
      - Query parameter: `id` from previous FLUX Fill response JSON  
    - *Connections:* Outputs to Is Ready? node.  
    - *Edge Cases:*  
      - API errors or network issues  
      - Task ID invalid or expired  
      - Rate limiting

  - **Is Ready?**  
    - *Type:* If node  
    - *Role:* Checks if the FLUX API task status equals "Ready".  
    - *Config:* Condition: `$json.status == "Ready"`  
    - *Connections:*  
      - True branch: Get Fill Image node  
      - False branch: Wait 3 sec node (loops polling)  
    - *Edge Cases:*  
      - Status field missing or unexpected values  
      - Infinite loop if status never becomes "Ready"

  - **Sticky Notes**  
    - Explain the image processing flow and parameters passed to FLUX Fill API.

---

#### 2.3 Result Delivery and Interaction

- **Overview:**  
  Once the generated image is ready, this block fetches the image from the FLUX API result URL and sends it back to the userâ€™s browser for display in the editorâ€™s comparison slider. It supports binary response with correct MIME type.

- **Nodes Involved:**  
  - Get Fill Image  
  - Show the image to user  
  - Respond to Webhook (for image response)  
  - Sticky Note2 (result sending and saving instructions)

- **Node Details:**

  - **Get Fill Image**  
    - *Type:* HTTP Request  
    - *Role:* Downloads the generated image from the URL provided in the FLUX API result JSON (`result.sample`).  
    - *Config:*  
      - URL: dynamic from `$json.result.sample`  
      - Method: GET  
      - No authentication needed (public URL)  
    - *Connections:* Outputs to Show the image to user node.  
    - *Edge Cases:*  
      - URL invalid or expired  
      - Network errors

  - **Show the image to user**  
    - *Type:* Respond to Webhook  
    - *Role:* Sends the binary image data back to the client browser.  
    - *Config:*  
      - Responds with binary data source set from incoming HTTP Request node  
      - Sets `Content-Type` header dynamically from binary data MIME type  
    - *Connections:* Terminal node for this branch.  
    - *Edge Cases:*  
      - Large image sizes causing timeouts or slow transfers  
      - MIME type detection errors

  - **Sticky Note2**  
    - Notes on sending back the edited image and suggestions to add steps for saving images.

---

### 3. Summary Table

| Node Name          | Node Type           | Functional Role                         | Input Node(s)           | Output Node(s)          | Sticky Note                                                                                   |
|--------------------|---------------------|---------------------------------------|------------------------|-------------------------|----------------------------------------------------------------------------------------------|
| Webhook            | Webhook             | Entry point for HTTP requests          | â€”                      | Merge, Mockups, NO OP    |                                                                                              |
| Mockups            | Set                 | Provides default image URLs             | Webhook                 | Merge                   | ## Image array<br>* Load from PC<br>* Select one of the default images<br><br>### Change this node to<br>### get image URLs from your data source |
| Merge              | Merge               | Combines request data and mock images  | Webhook, Mockups        | Editor page             | # Deliver the editor with links to the images                                                |
| Editor page        | HTML                | Serves interactive editor HTML page    | Merge                   | Respond to Webhook      | ## HTML code of the editor<br>* Konva.js<br>* img-comparison-slider to compare edits vs original file<br>* Additional css + js files for the editor logic |
| Respond to Webhook  | Respond to Webhook   | Sends editor HTML response              | Editor page             | â€”                       |                                                                                              |
| NO OP              | No Operation        | Pass-through to start image processing | Webhook                 | FLUX Fill               |                                                                                              |
| FLUX Fill          | HTTP Request        | Calls FLUX Fill API for image inpainting | NO OP                   | Wait 3 sec              | ## Call FLUX-Fill Tool<br>Pass the following data:<br>* original image<br>* alpha mask from the editor<br>* text prompt<br>* additional settings |
| Wait 3 sec         | Wait                | Delays for 3 seconds before polling    | FLUX Fill, Is Ready?    | Check FLUX status       | # Image processing part                                                                      |
| Check FLUX status   | HTTP Request        | Polls FLUX API for task status          | Wait 3 sec              | Is Ready?               |                                                                                              |
| Is Ready?          | If                  | Checks if FLUX task status is "Ready"  | Check FLUX status       | Get Fill Image (true), Wait 3 sec (false) |                                                                                              |
| Get Fill Image      | HTTP Request        | Downloads generated image from FLUX    | Is Ready? (true)        | Show the image to user  | # Send back edited image<br>## Add extra steps to save an edited image                       |
| Show the image to user | Respond to Webhook | Sends generated image binary to client | Get Fill Image          | â€”                       |                                                                                              |
| Sticky Note        | Sticky Note         | Editor delivery explanation             | â€”                      | â€”                       | # Deliver the editor with links to the images                                                |
| Sticky Note1       | Sticky Note         | FLUX Fill API call explanation          | â€”                      | â€”                       | ## Call FLUX-Fill Tool<br>Pass the following data:<br>* original image<br>* alpha mask from the editor<br>* text prompt<br>* additional settings |
| Sticky Note2       | Sticky Note         | Result sending and saving instructions  | â€”                      | â€”                       | # Send back edited image<br>## Add extra steps to save an edited image                       |
| Sticky Note3       | Sticky Note         | Image array source explanation           | â€”                      | â€”                       | ## Image array<br>* Load from PC<br>* Select one of the default images<br><br>### Change this node to<br>### get image URLs from your data source |
| Sticky Note4       | Sticky Note         | HTML editor code explanation             | â€”                      | â€”                       | ## HTML code of the editor<br>* Konva.js<br>* img-comparison-slider to compare edits vs original file<br>* Additional css + js files for the editor logic |
| Sticky Note5       | Sticky Note         | FLUX Fill API parameters explanation     | â€”                      | â€”                       | ## Call FLUX-Fill Tool<br>Pass the following data:<br>* original image<br>* alpha mask from the editor<br>* text prompt<br>* additional settings |

---

### 4. Reproducing the Workflow from Scratch

1. **Create Webhook Node**  
   - Type: Webhook  
   - Path: `flux-fill`  
   - Methods: Enable multiple HTTP methods (GET, POST, etc.)  
   - Response Mode: Set to "Respond to Webhook" node  
   - Purpose: Entry point for editor requests and image processing calls.

2. **Create Mockups Node**  
   - Type: Set  
   - Add an array field named `Images` with objects containing `url` and `title` keys for default images.  
   - Example images: 5 URLs with descriptive titles.  
   - Purpose: Provide default images for the editorâ€™s image selector.

3. **Create Merge Node**  
   - Type: Merge  
   - Mode: Combine  
   - Combine By: Position  
   - Inputs: Connect Webhook output to first input, Mockups output to second input.  
   - Purpose: Combine incoming request data and mock images for editor page.

4. **Create Editor page Node**  
   - Type: HTML  
   - Paste the full HTML content of the editor page, including:  
     - `<head>` with Konva.js, img-comparison-slider, custom CSS and JS links  
     - `<body>` with controls for image selection, brush size, prompt input, sliders for steps and guidance, generate button, and modal for image comparison  
     - Inline script to initialize editor with image array and webhook URL injected dynamically from merged data  
   - Purpose: Serve the interactive editor UI.

5. **Create Respond to Webhook Node (Editor response)**  
   - Type: Respond to Webhook  
   - Respond With: Text  
   - Response Body: Set to output of Editor page node (HTML content)  
   - Connect Editor page output to this node.  
   - Purpose: Send editor HTML to client.

6. **Create NO OP Node**  
   - Type: No Operation  
   - Connect Webhook output (second output) to NO OP node.  
   - Purpose: Branch to image processing pipeline.

7. **Create FLUX Fill Node**  
   - Type: HTTP Request  
   - Method: POST  
   - URL: `https://api.bfl.ml/v1/flux-pro-1.0-fill`  
   - Authentication: HTTP Header Auth (create credential with FLUX API key)  
   - Body Parameters (JSON):  
     - `prompt`: from incoming JSON body `prompt`  
     - `steps`: from incoming JSON body `steps`  
     - `prompt_upsampling`: from incoming JSON body `prompt_upsampling`  
     - `guidance`: from incoming JSON body `guidance`  
     - `output_format`: `"png"` (fixed)  
     - `safety_tolerance`: `6` (fixed)  
     - `image`: extract base64 data by splitting input `image` string at comma and taking second part  
     - `mask`: extract base64 data similarly from `mask` field  
   - Connect NO OP output to this node.

8. **Create Wait 3 sec Node**  
   - Type: Wait  
   - Duration: 3 seconds  
   - Connect FLUX Fill output to this node.

9. **Create Check FLUX status Node**  
   - Type: HTTP Request  
   - Method: GET  
   - URL: `https://api.bfl.ml/v1/get_result`  
   - Authentication: HTTP Header Auth (same FLUX credential)  
   - Query Parameter: `id` from previous FLUX Fill response JSON field `id`  
   - Connect Wait 3 sec output to this node.

10. **Create Is Ready? Node**  
    - Type: If  
    - Condition: Check if `$json.status` equals `"Ready"`  
    - Connect Check FLUX status output to this node.

11. **Create Get Fill Image Node**  
    - Type: HTTP Request  
    - Method: GET  
    - URL: from `$json.result.sample` (the generated image URL)  
    - No authentication needed  
    - Connect Is Ready? true output to this node.

12. **Create Show the image to user Node**  
    - Type: Respond to Webhook  
    - Respond With: Binary  
    - Response Data Source: Set from incoming data  
    - Set Response Header `Content-Type` dynamically from binary data MIME type  
    - Connect Get Fill Image output to this node.

13. **Connect Is Ready? false output back to Wait 3 sec Node**  
    - This creates a polling loop until the image is ready.

14. **Credential Setup**  
    - Create HTTP Header Auth credential in n8n with your FLUX API key.  
    - Assign this credential to FLUX Fill and Check FLUX status nodes.

15. **Final Connections**  
    - Webhook node outputs to:  
      - Merge (for editor delivery)  
      - NO OP (for image processing)  
    - Merge outputs to Editor page node.  
    - Editor page outputs to Respond to Webhook node (HTML response).  
    - NO OP outputs to FLUX Fill node.  
    - FLUX Fill â†’ Wait 3 sec â†’ Check FLUX status â†’ Is Ready?  
    - Is Ready? true â†’ Get Fill Image â†’ Show the image to user  
    - Is Ready? false â†’ Wait 3 sec (loop)

---

### 5. General Notes & Resources

| Note Content                                                                                              | Context or Link                                                                                         |
|-----------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------|
| Like this template? Connect with Eduard via LinkedIn: https://www.linkedin.com/in/parsadanyan/            | Workflow description                                                                                     |
| FLUX API Access required: https://api.bfl.ai/                                                             | API credential prerequisite                                                                              |
| Configure HTTP Header Auth credential in n8n with your FLUX API key                                       | Credential setup instructions                                                                             |
| Uses Konva.js for canvas manipulation: https://konvajs.org/                                               | Editor UI library                                                                                        |
| Uses img-comparison-slider for before/after image comparison: https://www.npmjs.com/package/img-comparison-slider | Editor UI library                                                                                        |
| Custom CSS/JS for editor logic hosted on GitHub: https://github.com/ed-parsadanyan/n8n-flux-fill-demo      | Source for editor styling and scripting                                                                  |
| Perfect for product catalog management, seasonal content updates, and creative image editing tasks        | Suggested use cases                                                                                       |
| Pro Tip: Save masks for frequently edited areas to quickly generate variations with different prompts!    | Workflow usage tip                                                                                         |
| Workflow execution timeout set to 120 seconds                                                             | Workflow setting to avoid long hangs                                                                     |

---

This document provides a complete, structured reference for understanding, reproducing, and maintaining the "ðŸŽ¨ Interactive Image Editor with FLUX.1 Fill Tool for Inpainting" workflow in n8n.